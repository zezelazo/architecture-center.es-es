---
title: Lista de comprobación de resistencia para servicios de Azure
titleSuffix: Azure Design Review Framework
description: Lista de comprobación que proporciona una orientación sobre la resistencia de varios servicios de Azure.
author: petertaylor9999
ms.date: 11/26/2018
ms.custom: resiliency, checklist
ms.openlocfilehash: 55f17d3b24af4be4f313c66923f4153296041545
ms.sourcegitcommit: 4ba3304eebaa8c493c3e5307bdd9d723cd90b655
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/12/2018
ms.locfileid: "53307187"
---
# <a name="resiliency-checklist-for-specific-azure-services"></a><span data-ttu-id="8bd01-103">Lista de comprobación de resistencia para servicios de Azure específicos</span><span class="sxs-lookup"><span data-stu-id="8bd01-103">Resiliency checklist for specific Azure services</span></span>

<span data-ttu-id="8bd01-104">La resistencia es la capacidad de un sistema para recuperarse de errores y seguir en funcionamiento y es uno de los [pilares de la calidad del software](../guide/pillars.md).</span><span class="sxs-lookup"><span data-stu-id="8bd01-104">Resiliency is the ability of a system to recover from failures and continue to function, and is one of the [pillars of software quality](../guide/pillars.md).</span></span> <span data-ttu-id="8bd01-105">Todas las tecnologías tienen sus propios modos de error particulares que debe tener en cuenta al diseñar e implementar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-105">Every technology has its own particular failure modes, which you must consider when designing and implementing your application.</span></span> <span data-ttu-id="8bd01-106">Use esta lista de comprobación para revisar las consideraciones de resistencia para servicios específicos de Azure.</span><span class="sxs-lookup"><span data-stu-id="8bd01-106">Use this checklist to review the resiliency considerations for specific Azure services.</span></span> <span data-ttu-id="8bd01-107">Revise también la [lista de comprobación de resistencia general](./resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="8bd01-107">Also review the [general resiliency checklist](./resiliency.md).</span></span>

## <a name="app-service"></a><span data-ttu-id="8bd01-108">App Service</span><span class="sxs-lookup"><span data-stu-id="8bd01-108">App Service</span></span>

<span data-ttu-id="8bd01-109">**Utilice el nivel Estándar o Premium.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-109">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="8bd01-110">Estos niveles admiten espacios de ensayo y copias de seguridad automáticas.</span><span class="sxs-lookup"><span data-stu-id="8bd01-110">These tiers support staging slots and automated backups.</span></span> <span data-ttu-id="8bd01-111">Para más información, consulte [Introducción detallada sobre los planes de Azure App Service](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-111">For more information, see [Azure App Service plans in-depth overview](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)</span></span>

<span data-ttu-id="8bd01-112">**Evite el escalado o la reducción verticales.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-112">**Avoid scaling up or down.**</span></span> <span data-ttu-id="8bd01-113">En su lugar, seleccione un nivel y un tamaño de instancia que satisfagan sus requisitos de rendimiento con la carga típica y, a continuación, [escale horizontalmente](/azure/app-service-web/web-sites-scale/) las instancias para controlar los cambios en el volumen de tráfico.</span><span class="sxs-lookup"><span data-stu-id="8bd01-113">Instead, select a tier and instance size that meet your performance requirements under typical load, and then [scale out](/azure/app-service-web/web-sites-scale/) the instances to handle changes in traffic volume.</span></span> <span data-ttu-id="8bd01-114">El escalado y la reducción verticales pueden desencadenar un reinicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-114">Scaling up and down may trigger an application restart.</span></span>

<span data-ttu-id="8bd01-115">**Almacene la configuración como valores de configuración de la aplicación.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-115">**Store configuration as app settings.**</span></span> <span data-ttu-id="8bd01-116">Utilice la configuración de la aplicación para almacenar los valores de configuración como valores de configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-116">Use app settings to hold configuration settings as app settings.</span></span> <span data-ttu-id="8bd01-117">Defina la configuración en las plantillas de Resource Manager o utilice PowerShell para que pueda aplicarlas como parte de un proceso automatizado de implementación o actualización, que es más confiable.</span><span class="sxs-lookup"><span data-stu-id="8bd01-117">Define the settings in your Resource Manager templates, or using PowerShell, so that you can apply them as part of an automated deployment / update process, which is more reliable.</span></span> <span data-ttu-id="8bd01-118">Para más información, consulte [Configuración de aplicaciones web en Azure App Service](/azure/app-service-web/web-sites-configure/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-118">For more information, see [Configure web apps in Azure App Service](/azure/app-service-web/web-sites-configure/).</span></span>

<span data-ttu-id="8bd01-119">**Cree planes de App Service independientes para producción y prueba.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-119">**Create separate App Service plans for production and test.**</span></span> <span data-ttu-id="8bd01-120">No utilice ranuras en la implementación de producción para pruebas.</span><span class="sxs-lookup"><span data-stu-id="8bd01-120">Don't use slots on your production deployment for testing.</span></span>  <span data-ttu-id="8bd01-121">Todas las aplicaciones del mismo plan de App Service comparten las mismas instancias de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="8bd01-121">All apps within the same App Service plan share the same VM instances.</span></span> <span data-ttu-id="8bd01-122">Si coloca implementaciones de producción y prueba en el mismo plan, puede afectar negativamente a la implementación de producción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-122">If you put production and test deployments in the same plan, it can negatively affect the production deployment.</span></span> <span data-ttu-id="8bd01-123">Por ejemplo, las pruebas de carga pueden degradar el sitio de producción en vivo.</span><span class="sxs-lookup"><span data-stu-id="8bd01-123">For example, load tests might degrade the live production site.</span></span> <span data-ttu-id="8bd01-124">Al colocar las implementaciones de prueba en un plan independiente, se aíslan de la versión de producción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-124">By putting test deployments into a separate plan, you isolate them from the production version.</span></span>

<span data-ttu-id="8bd01-125">**Aplicaciones web independiente de las API web.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-125">**Separate web apps from web APIs.**</span></span> <span data-ttu-id="8bd01-126">Si la solución tiene un front-end web y una API web, considere descomponerlas en aplicaciones de App Service independientes.</span><span class="sxs-lookup"><span data-stu-id="8bd01-126">If your solution has both a web front-end and a web API, consider decomposing them into separate App Service apps.</span></span> <span data-ttu-id="8bd01-127">Este diseño facilita la descomposición de la solución por carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="8bd01-127">This design makes it easier to decompose the solution by workload.</span></span> <span data-ttu-id="8bd01-128">Puede ejecutar la aplicación web y la API en planes de App Service diferentes, por lo que se pueden escalar de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="8bd01-128">You can run the web app and the API in separate App Service plans, so they can be scaled independently.</span></span> <span data-ttu-id="8bd01-129">Si inicialmente no necesita ese nivel de escalabilidad, puede implementar las aplicaciones en el mismo plan y moverlas más tarde a planes diferentes si es necesario.</span><span class="sxs-lookup"><span data-stu-id="8bd01-129">If you don't need that level of scalability at first, you can deploy the apps into the same plan, and move them into separate plans later, if needed.</span></span>

<span data-ttu-id="8bd01-130">**Evite utilizar la característica de copia de seguridad de App Service para hacer copias de seguridad de las bases de datos Azure SQL Database.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-130">**Avoid using the App Service backup feature to back up Azure SQL databases.**</span></span> <span data-ttu-id="8bd01-131">En cambio, utilice las [copias de seguridad automatizadas de SQL Database][sql-backup].</span><span class="sxs-lookup"><span data-stu-id="8bd01-131">Instead, use [SQL Database automated backups][sql-backup].</span></span> <span data-ttu-id="8bd01-132">La copia de seguridad de App Service exporta la base de datos a un archivo .bacpac de SQL, que cuesta unidades de transmisión de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-132">App Service backup exports the database to a SQL .bacpac file, which costs DTUs.</span></span>

<span data-ttu-id="8bd01-133">**Realice la implementación en un espacio de ensayo.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-133">**Deploy to a staging slot.**</span></span> <span data-ttu-id="8bd01-134">Cree una ranura de implementación para el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="8bd01-134">Create a deployment slot for staging.</span></span> <span data-ttu-id="8bd01-135">Implemente las actualizaciones de la aplicación en el espacio de ensayo y compruebe la implementación antes de cambiarla a producción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-135">Deploy application updates to the staging slot, and verify the deployment before swapping it into production.</span></span> <span data-ttu-id="8bd01-136">Esto reduce la posibilidad de una mala actualización en la producción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-136">This reduces the chance of a bad update in production.</span></span> <span data-ttu-id="8bd01-137">También garantiza que todas las instancias estén preparadas antes de pasarlas a producción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-137">It also ensures that all instances are warmed up before being swapped into production.</span></span> <span data-ttu-id="8bd01-138">Muchas aplicaciones presentan tiempos de preparación y arranque en frío considerables.</span><span class="sxs-lookup"><span data-stu-id="8bd01-138">Many applications have a significant warmup and cold-start time.</span></span> <span data-ttu-id="8bd01-139">Para más información, consulte [Configuración de entornos de ensayo para aplicaciones web en Azure App Service](/azure/app-service-web/web-sites-staged-publishing/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-139">For more information, see [Set up staging environments for web apps in Azure App Service](/azure/app-service-web/web-sites-staged-publishing/).</span></span>

<span data-ttu-id="8bd01-140">**Cree una ranura de implementación para conservar la última implementación válida conocida.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-140">**Create a deployment slot to hold the last-known-good (LKG) deployment.**</span></span> <span data-ttu-id="8bd01-141">Cuando implemente una actualización en producción, traslade la implementación de producción anterior a la ranura de la última configuración válida conocida.</span><span class="sxs-lookup"><span data-stu-id="8bd01-141">When you deploy an update to production, move the previous production deployment into the LKG slot.</span></span> <span data-ttu-id="8bd01-142">Esto facilita la reversión de una implementación incorrecta.</span><span class="sxs-lookup"><span data-stu-id="8bd01-142">This makes it easier to roll back a bad deployment.</span></span> <span data-ttu-id="8bd01-143">Si detecta un problema más tarde, puede revertir rápidamente a la última versión válida conocida.</span><span class="sxs-lookup"><span data-stu-id="8bd01-143">If you discover a problem later, you can quickly revert to the LKG version.</span></span> <span data-ttu-id="8bd01-144">Para más información, consulte [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md) (Aplicación web básica).</span><span class="sxs-lookup"><span data-stu-id="8bd01-144">For more information, see [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md).</span></span>

<span data-ttu-id="8bd01-145">**Habilite el registro de diagnóstico**, incluido el registro de aplicaciones y el registro del servidor web.</span><span class="sxs-lookup"><span data-stu-id="8bd01-145">**Enable diagnostics logging**, including application logging and web server logging.</span></span> <span data-ttu-id="8bd01-146">El registro es importante para la supervisión y diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="8bd01-146">Logging is important for monitoring and diagnostics.</span></span> <span data-ttu-id="8bd01-147">Consulte [Habilitación del registro de diagnóstico para aplicaciones web en Azure App Service](/azure/app-service-web/web-sites-enable-diagnostic-log/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-147">See [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service-web/web-sites-enable-diagnostic-log/)</span></span>

<span data-ttu-id="8bd01-148">**Regístrese en Blob Storage.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-148">**Log to blob storage.**</span></span> <span data-ttu-id="8bd01-149">Esto facilita la recopilación y el análisis de los datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-149">This makes it easier to collect and analyze the data.</span></span>

<span data-ttu-id="8bd01-150">**Cree una cuenta de almacenamiento para los registros.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-150">**Create a separate storage account for logs.**</span></span> <span data-ttu-id="8bd01-151">No use la misma cuenta de almacenamiento para los registros y los datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-151">Don't use the same storage account for logs and application data.</span></span> <span data-ttu-id="8bd01-152">Esto ayuda a evitar que el registro reduzca el rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-152">This helps to prevent logging from reducing application performance.</span></span>

<span data-ttu-id="8bd01-153">**Supervise el rendimiento.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-153">**Monitor performance.**</span></span> <span data-ttu-id="8bd01-154">Use un servicio de supervisión de rendimiento, como [New Relic](https://newrelic.com/) o [Application Insights](/azure/application-insights/app-insights-overview/), para supervisar el rendimiento de la aplicación y el comportamiento sometido a carga.</span><span class="sxs-lookup"><span data-stu-id="8bd01-154">Use a performance monitoring service such as [New Relic](https://newrelic.com/) or [Application Insights](/azure/application-insights/app-insights-overview/) to monitor application performance and behavior under load.</span></span>  <span data-ttu-id="8bd01-155">La supervisión del rendimiento le ofrece una visión en tiempo real de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-155">Performance monitoring gives you real-time insight into the application.</span></span> <span data-ttu-id="8bd01-156">Le permite diagnosticar problemas y realizar análisis de causa raíz de errores.</span><span class="sxs-lookup"><span data-stu-id="8bd01-156">It enables you to diagnose issues and perform root-cause analysis of failures.</span></span>

## <a name="application-gateway"></a><span data-ttu-id="8bd01-157">Application Gateway</span><span class="sxs-lookup"><span data-stu-id="8bd01-157">Application Gateway</span></span>

<span data-ttu-id="8bd01-158">**Aprovisione al menos dos instancias.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-158">**Provision at least two instances.**</span></span> <span data-ttu-id="8bd01-159">Implemente Application Gateway con al menos dos instancias.</span><span class="sxs-lookup"><span data-stu-id="8bd01-159">Deploy Application Gateway with at least two instances.</span></span> <span data-ttu-id="8bd01-160">Una única instancia es un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="8bd01-160">A single instance is a single point of failure.</span></span> <span data-ttu-id="8bd01-161">Utilice dos o más instancias para redundancia y escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="8bd01-161">Use two or more instances for redundancy and scalability.</span></span> <span data-ttu-id="8bd01-162">Para calificar para el [Acuerdo de Nivel de Servicio](https://azure.microsoft.com/support/legal/sla/application-gateway), debe proporcionar dos o más instancias medianas o más grandes.</span><span class="sxs-lookup"><span data-stu-id="8bd01-162">In order to qualify for the [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway), you must provision two or more medium or larger instances.</span></span>

## <a name="cosmos-db"></a><span data-ttu-id="8bd01-163">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="8bd01-163">Cosmos DB</span></span>

<span data-ttu-id="8bd01-164">**Replique la base de datos en todas las regiones.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-164">**Replicate the database across regions.**</span></span> <span data-ttu-id="8bd01-165">Cosmos DB permite asociar cualquier número de regiones de Azure con una cuenta de base de datos de Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="8bd01-165">Cosmos DB allows you to associate any number of Azure regions with a Cosmos DB database account.</span></span> <span data-ttu-id="8bd01-166">Una base de datos Cosmos DB puede tener una región de escritura y varias regiones de lectura.</span><span class="sxs-lookup"><span data-stu-id="8bd01-166">A Cosmos DB database can have one write region and multiple read regions.</span></span> <span data-ttu-id="8bd01-167">Si se produce un error en la región de escritura, puede leer desde otra réplica.</span><span class="sxs-lookup"><span data-stu-id="8bd01-167">If there is a failure in the write region, you can read from another replica.</span></span> <span data-ttu-id="8bd01-168">El SDK de cliente lo trata automáticamente.</span><span class="sxs-lookup"><span data-stu-id="8bd01-168">The Client SDK handles this automatically.</span></span> <span data-ttu-id="8bd01-169">También puede conmutar por error la región de escritura a otra región.</span><span class="sxs-lookup"><span data-stu-id="8bd01-169">You can also fail over the write region to another region.</span></span> <span data-ttu-id="8bd01-170">Para más información, consulte [Cómo se distribuyen datos globalmente con Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).</span><span class="sxs-lookup"><span data-stu-id="8bd01-170">For more information, see [How to distribute data globally with Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).</span></span>

## <a name="event-hubs"></a><span data-ttu-id="8bd01-171">Event Hubs</span><span class="sxs-lookup"><span data-stu-id="8bd01-171">Event Hubs</span></span>

<span data-ttu-id="8bd01-172">**Use puntos de control**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-172">**Use checkpoints**.</span></span>  <span data-ttu-id="8bd01-173">Un consumidor de eventos debe escribir su posición actual en el almacenamiento persistente según un intervalo predefinido.</span><span class="sxs-lookup"><span data-stu-id="8bd01-173">An event consumer should write its current position to persistent storage at some predefined interval.</span></span> <span data-ttu-id="8bd01-174">De este modo, si el consumidor experimenta un error (por ejemplo, el consumidor se bloquea o se produce un error en el host), una nueva instancia puede reanudar la lectura de la secuencia desde la última posición registrada.</span><span class="sxs-lookup"><span data-stu-id="8bd01-174">That way, if the consumer experiences a fault (for example, the consumer crashes, or the host fails), then a new instance can resume reading the stream from the last recorded position.</span></span> <span data-ttu-id="8bd01-175">Para más información, consulte [Consumidores de eventos](/azure/event-hubs/event-hubs-features#event-consumers).</span><span class="sxs-lookup"><span data-stu-id="8bd01-175">For more information, see [Event consumers](/azure/event-hubs/event-hubs-features#event-consumers).</span></span>

<span data-ttu-id="8bd01-176">**Controle los mensajes duplicados.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-176">**Handle duplicate messages.**</span></span> <span data-ttu-id="8bd01-177">Si se produce un error en un consumidor de eventos, el procesamiento de mensajes se reanudará desde el último punto de comprobación registrado.</span><span class="sxs-lookup"><span data-stu-id="8bd01-177">If an event consumer fails, message processing is resumed from the last recorded checkpoint.</span></span> <span data-ttu-id="8bd01-178">Todos los mensajes que ya se procesaron después del último punto de comprobación se procesarán de nuevo.</span><span class="sxs-lookup"><span data-stu-id="8bd01-178">Any messages that were already processed after the last checkpoint will be processed again.</span></span> <span data-ttu-id="8bd01-179">Por tanto, su lógica de procesamiento de mensajes debe ser idempotente, o la aplicación debe poder desduplicar los mensajes.</span><span class="sxs-lookup"><span data-stu-id="8bd01-179">Therefore, your message processing logic must be idempotent, or the application must be able to deduplicate messages.</span></span>

<span data-ttu-id="8bd01-180">**Controle las excepciones**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-180">**Handle exceptions.**.</span></span> <span data-ttu-id="8bd01-181">Normalmente, un consumidor de eventos procesa un lote de mensajes en un bucle.</span><span class="sxs-lookup"><span data-stu-id="8bd01-181">An event consumer typically processes a batch of messages in a loop.</span></span> <span data-ttu-id="8bd01-182">Debe controlar las excepciones dentro de este bucle de procesamiento para evitar la pérdida de un lote completo de mensajes si un solo mensaje provoca una excepción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-182">You should handle exceptions within this processing loop to avoid losing an entire batch of messages if a single message causes an exception.</span></span>

<span data-ttu-id="8bd01-183">**Use una cola de mensajes con problemas de entrega**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-183">**Use a dead-letter queue.**</span></span> <span data-ttu-id="8bd01-184">Si al procesar un mensaje se produce un error no transitorio, coloque el mensaje en una cola de mensajes con problemas de entrega para que pueda hacer un seguimiento del estado.</span><span class="sxs-lookup"><span data-stu-id="8bd01-184">If processing a message results in a non-transient failure, put the message onto a dead-letter queue, so that you can track the status.</span></span> <span data-ttu-id="8bd01-185">Según el escenario, puede volver a intentar enviar el mensaje más tarde, aplicar una transacción de compensación o realizar alguna otra acción.</span><span class="sxs-lookup"><span data-stu-id="8bd01-185">Depending on the scenario, you might retry the message later, apply a compensating transaction, or take some other action.</span></span> <span data-ttu-id="8bd01-186">Tenga en cuenta que Event Hubs no tiene ninguna funcionalidad integrada de cola de mensajes con problemas de entrega.</span><span class="sxs-lookup"><span data-stu-id="8bd01-186">Note that Event Hubs does not have any built-in dead-letter queue functionality.</span></span> <span data-ttu-id="8bd01-187">Puede usar Azure Queue Storage o Service Bus para implementar una cola de mensajes con problemas de entrega o emplear Azure Functions, o algún otro mecanismo de eventos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-187">You can use Azure Queue Storage or Service Bus to implement a dead-letter queue, or use Azure Functions or some other eventing mechanism.</span></span>

<span data-ttu-id="8bd01-188">**Implemente la recuperación ante desastres mediante la conmutación por error en un espacio de nombres secundario de Event Hubs.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-188">**Implement disaster recovery by failing over to a secondary Event Hubs namespace.**</span></span> <span data-ttu-id="8bd01-189">Para más información, consulte [Recuperación ante desastres con localización geográfica de Azure Event Hubs](/azure/event-hubs/event-hubs-geo-dr).</span><span class="sxs-lookup"><span data-stu-id="8bd01-189">For more information, see [Azure Event Hubs Geo-disaster recovery](/azure/event-hubs/event-hubs-geo-dr).</span></span>

## <a name="redis-cache"></a><span data-ttu-id="8bd01-190">Redis Cache</span><span class="sxs-lookup"><span data-stu-id="8bd01-190">Redis Cache</span></span>

<span data-ttu-id="8bd01-191">**Configurar la replicación geográfica**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-191">**Configure Geo-replication**.</span></span> <span data-ttu-id="8bd01-192">La replicación geográfica proporciona un mecanismo para vincular dos instancias de Azure Redis Cache de nivel Premium.</span><span class="sxs-lookup"><span data-stu-id="8bd01-192">Geo-replication provides a mechanism for linking two Premium tier Azure Redis Cache instances.</span></span> <span data-ttu-id="8bd01-193">Los datos escritos en la caché principal se replican en una caché secundaria de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="8bd01-193">Data written to the primary cache is replicated to a secondary read-only cache.</span></span> <span data-ttu-id="8bd01-194">Para más información, consulte [Configuración de replicación geográfica para Azure Redis Cache](/azure/redis-cache/cache-how-to-geo-replication).</span><span class="sxs-lookup"><span data-stu-id="8bd01-194">For more information, see [How to configure Geo-replication for Azure Redis Cache](/azure/redis-cache/cache-how-to-geo-replication)</span></span>

<span data-ttu-id="8bd01-195">**Configurar la persistencia de los datos.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-195">**Configure data persistence.**</span></span> <span data-ttu-id="8bd01-196">La persistencia de Redis le permite conservar los datos almacenados en Redis.</span><span class="sxs-lookup"><span data-stu-id="8bd01-196">Redis persistence allows you to persist data stored in Redis.</span></span> <span data-ttu-id="8bd01-197">También puede tomar instantáneas y realizar copias de seguridad de los datos que puede cargar en el caso de un error de hardware.</span><span class="sxs-lookup"><span data-stu-id="8bd01-197">You can also take snapshots and back up the data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="8bd01-198">Para más información, consulte [Cómo configurar la persistencia de datos para una instancia premium de Azure Redis Cache](/azure/redis-cache/cache-how-to-premium-persistence).</span><span class="sxs-lookup"><span data-stu-id="8bd01-198">For more information, see [How to configure data persistence for a Premium Azure Redis Cache](/azure/redis-cache/cache-how-to-premium-persistence)</span></span>

<span data-ttu-id="8bd01-199">Si usa Redis Cache como caché de datos temporal y no como almacén persistente, puede que estas recomendaciones no se apliquen.</span><span class="sxs-lookup"><span data-stu-id="8bd01-199">If you are using Redis Cache as a temporary data cache and not as a persistent store, these recommendations may not apply.</span></span>

## <a name="search"></a><span data-ttu-id="8bd01-200">Search</span><span class="sxs-lookup"><span data-stu-id="8bd01-200">Search</span></span>

<span data-ttu-id="8bd01-201">**Aprovisione más de una réplica.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-201">**Provision more than one replica.**</span></span> <span data-ttu-id="8bd01-202">Utilice al menos dos réplicas para alta disponibilidad de lectura, o tres para alta disponibilidad de lectura-escritura.</span><span class="sxs-lookup"><span data-stu-id="8bd01-202">Use at least two replicas for read high-availability, or three for read-write high-availability.</span></span>

<span data-ttu-id="8bd01-203">**Configure los indexadores para implementaciones en varias regiones**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-203">**Configure indexers for multi-region deployments.**</span></span> <span data-ttu-id="8bd01-204">Si tiene una implementación de varias regiones, tenga en cuenta las opciones para la continuidad en la indexación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-204">If you have a multi-region deployment, consider your options for continuity in indexing.</span></span>

- <span data-ttu-id="8bd01-205">Si el origen de datos está replicado geográficamente, por lo general debe dirigir cada indexador de cada servicio regional de Azure Search a su réplica local del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-205">If the data source is geo-replicated, you should generally point each indexer of each regional Azure Search service to its local data source replica.</span></span> <span data-ttu-id="8bd01-206">Sin embargo, este enfoque no se recomienda para grandes conjuntos de datos almacenados en Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="8bd01-206">However, that approach is not recommended for large datasets stored in Azure SQL Database.</span></span> <span data-ttu-id="8bd01-207">La razón es que Azure Search no puede realizar la indexación incremental desde réplicas secundarias de SQL Database, solo desde réplicas principales.</span><span class="sxs-lookup"><span data-stu-id="8bd01-207">The reason is that Azure Search cannot perform incremental indexing from secondary SQL Database replicas, only from primary replicas.</span></span> <span data-ttu-id="8bd01-208">En su lugar, seleccione todos los indexadores a la réplica principal.</span><span class="sxs-lookup"><span data-stu-id="8bd01-208">Instead, point all indexers to the primary replica.</span></span> <span data-ttu-id="8bd01-209">Después de una conmutación por error, elija los indexadores de Azure Search a la nueva réplica principal.</span><span class="sxs-lookup"><span data-stu-id="8bd01-209">After a failover, point the Azure Search indexers at the new primary replica.</span></span>

- <span data-ttu-id="8bd01-210">Si el origen de datos no está replicado geográficamente, seleccione varios indexadores en el mismo origen de datos, de modo que los servicios de Azure Search en múltiples regiones se indexen continua e independientemente en el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-210">If the data source is not geo-replicated, point multiple indexers at the same data source, so that Azure Search services in multiple regions continuously and independently index from the data source.</span></span> <span data-ttu-id="8bd01-211">Para más información, consulte [Consideraciones sobre el rendimiento y la optimización de Azure Search][search-optimization].</span><span class="sxs-lookup"><span data-stu-id="8bd01-211">For more information, see [Azure Search performance and optimization considerations][search-optimization].</span></span>

## <a name="service-bus"></a><span data-ttu-id="8bd01-212">Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="8bd01-212">Service Bus</span></span>

<span data-ttu-id="8bd01-213">**Utilice el nivel Premium para cargas de trabajo de producción**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-213">**Use Premium tier for production workloads**.</span></span> <span data-ttu-id="8bd01-214">La [mensajería Premium de Service Bus](/azure/service-bus-messaging/service-bus-premium-messaging) proporciona recursos de procesamiento dedicados y reservados y capacidad de memoria para permitir un rendimiento predecible.</span><span class="sxs-lookup"><span data-stu-id="8bd01-214">[Service Bus Premium Messaging](/azure/service-bus-messaging/service-bus-premium-messaging) provides dedicated and reserved processing resources, and memory capacity to support predictable performance and throughput.</span></span> <span data-ttu-id="8bd01-215">El nivel de mensajería Premium también ofrece acceso a nuevas características que solo están disponibles para los clientes Premium en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="8bd01-215">Premium Messaging tier also gives you access to new features that are available only to premium customers at first.</span></span> <span data-ttu-id="8bd01-216">Puede decidir el número de unidades de mensajería en función de las cargas de trabajo esperadas.</span><span class="sxs-lookup"><span data-stu-id="8bd01-216">You can decide the number of messaging units based on expected workloads.</span></span>

<span data-ttu-id="8bd01-217">**Controle los mensajes duplicados**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-217">**Handle duplicate messages**.</span></span> <span data-ttu-id="8bd01-218">Si se produce un error en un publicador inmediatamente después de enviar un mensaje o experimenta problemas de red o del sistema, es posible que por error no se registre que se entregó el mensaje y se podría enviar el mismo mensaje al sistema dos veces.</span><span class="sxs-lookup"><span data-stu-id="8bd01-218">If a publisher fails immediately after sending a message, or experiences network or system issues, it may erroneously fail to record that the message was delivered, and may send the same message to the system twice.</span></span> <span data-ttu-id="8bd01-219">Service Bus puede controlar este problema habilitando la detección de duplicados.</span><span class="sxs-lookup"><span data-stu-id="8bd01-219">Service Bus can handle this issue by enabling duplicate detection.</span></span> <span data-ttu-id="8bd01-220">Para más información, consulte [Detección de duplicados](/azure/service-bus-messaging/duplicate-detection).</span><span class="sxs-lookup"><span data-stu-id="8bd01-220">For more information, see [Duplicate detection](/azure/service-bus-messaging/duplicate-detection).</span></span>

<span data-ttu-id="8bd01-221">**Controle las excepciones**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-221">**Handle exceptions**.</span></span> <span data-ttu-id="8bd01-222">Las API de mensajería generan excepciones cuando se produce un error de usuario, un error de configuración u otro error.</span><span class="sxs-lookup"><span data-stu-id="8bd01-222">Messaging APIs generate exceptions when a user error, configuration error, or other error occurs.</span></span> <span data-ttu-id="8bd01-223">El cliente (remitentes y receptores) debe controlar estas excepciones en su código.</span><span class="sxs-lookup"><span data-stu-id="8bd01-223">The client code (senders and receivers) should handle these exceptions in their code.</span></span> <span data-ttu-id="8bd01-224">Esto es especialmente importante en el procesamiento por lotes, donde se puede usar el control de excepciones para evitar la pérdida de un lote completo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="8bd01-224">This is especially important in batch processing, where exception handling can be used to avoid losing an entire batch of messages.</span></span> <span data-ttu-id="8bd01-225">Para más información, consulte [Excepciones de mensajería de Service Bus](/azure/service-bus-messaging/service-bus-messaging-exceptions).</span><span class="sxs-lookup"><span data-stu-id="8bd01-225">For more information, see [Service Bus messaging exceptions](/azure/service-bus-messaging/service-bus-messaging-exceptions).</span></span>

<span data-ttu-id="8bd01-226">**Directiva de reintentos**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-226">**Retry policy**.</span></span> <span data-ttu-id="8bd01-227">Service Bus permite elegir la mejor directiva de reintentos para las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="8bd01-227">Service Bus allows you to pick the best retry policy for your applications.</span></span> <span data-ttu-id="8bd01-228">La directiva predeterminada es permitir un máximo de 9 intentos de reintento y esperar 30 segundos, pero esto se puede ajustar aún más.</span><span class="sxs-lookup"><span data-stu-id="8bd01-228">The default policy is to allow 9 maximum retry attempts, and wait for 30 seconds but this can be further adjusted.</span></span> <span data-ttu-id="8bd01-229">Para más información, consulte [Directiva de reintentos: Service Bus](/azure/architecture/best-practices/retry-service-specific#service-bus).</span><span class="sxs-lookup"><span data-stu-id="8bd01-229">For more information, see [Retry policy – Service Bus](/azure/architecture/best-practices/retry-service-specific#service-bus).</span></span>

<span data-ttu-id="8bd01-230">**Use una cola de mensajes fallidos**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-230">**Use a dead-letter queue**.</span></span> <span data-ttu-id="8bd01-231">Si un mensaje no se puede procesar o entregar a algún receptor después de varios reintentos, se mueve a una cola de mensajes fallidos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-231">If a message cannot be processed or delivered to any receiver after multiple retries, it is moved to a dead letter queue.</span></span> <span data-ttu-id="8bd01-232">Implemente un proceso para leer los mensajes de la cola de mensajes fallidos, inspeccionarlos y corregir el problema.</span><span class="sxs-lookup"><span data-stu-id="8bd01-232">Implement a process to read messages from the dead letter queue, inspect them, and remediate the problem.</span></span> <span data-ttu-id="8bd01-233">Según el escenario, puede reintentar el envío del mensaje tal cual es, realizar cambios y volver a intentarlo o descartar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="8bd01-233">Depending on the scenario, you might retry the message as-is, make changes and retry, or discard the message.</span></span> <span data-ttu-id="8bd01-234">Para más información, consulte [Introducción a las colas de mensajes fallidos de Service Bus](/azure/service-bus-messaging/service-bus-dead-letter-queues).</span><span class="sxs-lookup"><span data-stu-id="8bd01-234">For more information, see [Overview of Service Bus dead-letter queues](/azure/service-bus-messaging/service-bus-dead-letter-queues).</span></span>

<span data-ttu-id="8bd01-235">**Utilice la recuperación ante desastres geográfica**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-235">**Use Geo-Disaster Recovery**.</span></span> <span data-ttu-id="8bd01-236">La recuperación ante desastres geográfica garantiza que el procesamiento de datos siga funcionando en otra región o centro de datos si una región de Azure completa o el centro de datos dejan de estar disponibles debido a un desastre.</span><span class="sxs-lookup"><span data-stu-id="8bd01-236">Geo-disaster recovery ensures that data processing continues to operate in a different region or datacenter if an entire Azure region or datacenter becomes unavailable due to a disaster.</span></span> <span data-ttu-id="8bd01-237">Para obtener más información, consulte [Recuperación ante desastres con localización geográfica de Azure Service Bus](/azure/service-bus-messaging/service-bus-geo-dr).</span><span class="sxs-lookup"><span data-stu-id="8bd01-237">For more information, see [Azure Service Bus Geo-disaster recovery](/azure/service-bus-messaging/service-bus-geo-dr).</span></span>

## <a name="storage"></a><span data-ttu-id="8bd01-238">Storage</span><span class="sxs-lookup"><span data-stu-id="8bd01-238">Storage</span></span>

<span data-ttu-id="8bd01-239">**Para los datos de aplicación, use almacenamiento con redundancia geográfica con acceso de lectura (RA-GRS).**</span><span class="sxs-lookup"><span data-stu-id="8bd01-239">**For application data, use read-access geo-redundant storage (RA-GRS).**</span></span> <span data-ttu-id="8bd01-240">El almacenamiento con redundancia geográfica con acceso de lectura replica los datos en una región secundaria y proporciona acceso de solo lectura desde la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="8bd01-240">RA-GRS storage replicates the data to a secondary region, and provides read-only access from the secondary region.</span></span> <span data-ttu-id="8bd01-241">Si hay una interrupción de almacenamiento en la región primaria, la aplicación puede leer los datos de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="8bd01-241">If there is a storage outage in the primary region, the application can read the data from the secondary region.</span></span> <span data-ttu-id="8bd01-242">Para más información, consulte [Replicación de Azure Storage](/azure/storage/storage-redundancy/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-242">For more information, see [Azure Storage replication](/azure/storage/storage-redundancy/).</span></span>

<span data-ttu-id="8bd01-243">**Para los discos de máquinas virtuales, use Managed Disks.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-243">**For VM disks, use Managed Disks.**</span></span> <span data-ttu-id="8bd01-244">[Managed Disks][managed-disks] proporciona una mayor confiabilidad para las máquinas virtuales en los conjuntos de disponibilidad, porque los discos están suficientemente aislados entre sí para evitar únicos puntos de error.</span><span class="sxs-lookup"><span data-stu-id="8bd01-244">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="8bd01-245">Además, Managed Disks no está sujeto a los límites de IOPS de los discos duros virtuales creados en una cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8bd01-245">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="8bd01-246">Para más información, consulte [Administración de la disponibilidad de las máquinas virtuales Windows en Azure][vm-manage-availability].</span><span class="sxs-lookup"><span data-stu-id="8bd01-246">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>

<span data-ttu-id="8bd01-247">**Para Queue Storage, cree una cola de copia de seguridad en otra región.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-247">**For Queue storage, create a backup queue in another region.**</span></span> <span data-ttu-id="8bd01-248">Para Queue Storage, las réplicas de solo lectura tienen un uso limitado, ya que no se puede poner elementos en cola o quitarlos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-248">For Queue storage, a read-only replica has limited use, because you can't queue or dequeue items.</span></span> <span data-ttu-id="8bd01-249">En su lugar, cree una cola de copia de seguridad en una cuenta de almacenamiento en otra región.</span><span class="sxs-lookup"><span data-stu-id="8bd01-249">Instead, create a backup queue in a storage account in another region.</span></span> <span data-ttu-id="8bd01-250">Si se produce una interrupción de almacenamiento, la aplicación puede usar la cola de copia de seguridad hasta que la región primaria vuelva a estar disponible.</span><span class="sxs-lookup"><span data-stu-id="8bd01-250">If there is a storage outage, the application can use the backup queue, until the primary region becomes available again.</span></span> <span data-ttu-id="8bd01-251">De este modo, la aplicación puede seguir procesando nuevas solicitudes.</span><span class="sxs-lookup"><span data-stu-id="8bd01-251">That way, the application can still process new requests.</span></span>

## <a name="sql-database"></a><span data-ttu-id="8bd01-252">SQL Database</span><span class="sxs-lookup"><span data-stu-id="8bd01-252">SQL Database</span></span>

<span data-ttu-id="8bd01-253">**Utilice el nivel Estándar o Premium.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-253">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="8bd01-254">Estos niveles ofrecen un período de restauración a un momento dado más prolongado (35 días).</span><span class="sxs-lookup"><span data-stu-id="8bd01-254">These tiers provide a longer point-in-time restore period (35 days).</span></span> <span data-ttu-id="8bd01-255">Para más información, consulte [Opciones y rendimiento de SQL Database](/azure/sql-database/sql-database-service-tiers/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-255">For more information, see [SQL Database options and performance](/azure/sql-database/sql-database-service-tiers/).</span></span>

<span data-ttu-id="8bd01-256">**Habilite la auditoría de SQL Database.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-256">**Enable SQL Database auditing.**</span></span> <span data-ttu-id="8bd01-257">La auditoría se puede utilizar para diagnosticar ataques maliciosos o errores humanos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-257">Auditing can be used to diagnose malicious attacks or human error.</span></span> <span data-ttu-id="8bd01-258">Para obtener más información, consulte [Introducción a la auditoría de la Base de datos SQL](/azure/sql-database/sql-database-auditing-get-started/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-258">For more information, see [Get started with SQL database auditing](/azure/sql-database/sql-database-auditing-get-started/).</span></span>

<span data-ttu-id="8bd01-259">**Use la replicación geográfica activa** Utilice esta replicación para crear una réplica secundaria legible en una región distinta.</span><span class="sxs-lookup"><span data-stu-id="8bd01-259">**Use Active Geo-Replication** Use Active Geo-Replication to create a readable secondary in a different region.</span></span>  <span data-ttu-id="8bd01-260">Si se produce un error en la base de datos principal o, simplemente, debe estar sin conexión, realice una conmutación por error manual a la base de datos secundaria.</span><span class="sxs-lookup"><span data-stu-id="8bd01-260">If your primary database fails, or simply needs to be taken offline, perform a manual failover to the secondary database.</span></span>  <span data-ttu-id="8bd01-261">Hasta que se realiza la conmutación por error, la base de datos secundaria sigue siendo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="8bd01-261">Until you fail over, the secondary database remains read-only.</span></span>  <span data-ttu-id="8bd01-262">Para más información, consulte [Replicación geográfica activa para Azure SQL Database](/azure/sql-database/sql-database-geo-replication-overview/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-262">For more information, see [SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/).</span></span>

<span data-ttu-id="8bd01-263">**Utilice el particionamiento.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-263">**Use sharding.**</span></span> <span data-ttu-id="8bd01-264">Considere el uso del particionamiento para realizar una partición horizontal de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-264">Consider using sharding to partition the database horizontally.</span></span> <span data-ttu-id="8bd01-265">El particionamiento puede proporcionar aislamiento de errores.</span><span class="sxs-lookup"><span data-stu-id="8bd01-265">Sharding can provide fault isolation.</span></span> <span data-ttu-id="8bd01-266">Para más información, consulte [Escalado horizontal con Azure SQL Database](/azure/sql-database/sql-database-elastic-scale-introduction/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-266">For more information, see [Scaling out with Azure SQL Database](/azure/sql-database/sql-database-elastic-scale-introduction/).</span></span>

<span data-ttu-id="8bd01-267">**Utilice la restauración a un momento dado para realizar la recuperación en caso de errores humanos.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-267">**Use point-in-time restore to recover from human error.**</span></span>  <span data-ttu-id="8bd01-268">La restauración a un momento dado devuelve la base de datos a un momento anterior en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="8bd01-268">Point-in-time restore returns your database to an earlier point in time.</span></span> <span data-ttu-id="8bd01-269">Para más información, consulte [Recuperación de una instancia de Azure SQL Database mediante copias de seguridad de datos automatizadas][sql-restore].</span><span class="sxs-lookup"><span data-stu-id="8bd01-269">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

<span data-ttu-id="8bd01-270">**Use la restauración geográfica para recuperarse de una interrupción del servicio.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-270">**Use geo-restore to recover from a service outage.**</span></span> <span data-ttu-id="8bd01-271">La restauración geográfica restaura una base de datos a partir de una copia de seguridad con redundancia geográfica.</span><span class="sxs-lookup"><span data-stu-id="8bd01-271">Geo-restore restores a database from a geo-redundant backup.</span></span>  <span data-ttu-id="8bd01-272">Para más información, consulte [Recuperación de una instancia de Azure SQL Database mediante copias de seguridad de datos automatizadas][sql-restore].</span><span class="sxs-lookup"><span data-stu-id="8bd01-272">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

## <a name="sql-data-warehouse"></a><span data-ttu-id="8bd01-273">SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8bd01-273">SQL Data Warehouse</span></span>

<span data-ttu-id="8bd01-274">**No deshabilite la copia de seguridad con redundancia geográfica.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-274">**Do not disable geo-backup.**</span></span> <span data-ttu-id="8bd01-275">De forma predeterminada, SQL Data Warehouse realiza una copia de seguridad completa de los datos cada 24 horas por si es preciso realizar una recuperación ante un desastre.</span><span class="sxs-lookup"><span data-stu-id="8bd01-275">By default, SQL Data Warehouse takes a full backup of your data every 24 hours for disaster recovery.</span></span> <span data-ttu-id="8bd01-276">No se recomienda desactivar esta característica.</span><span class="sxs-lookup"><span data-stu-id="8bd01-276">It is not recommended to turn this feature off.</span></span> <span data-ttu-id="8bd01-277">Para más información, consulte [Copias de seguridad geográficas](/azure/sql-data-warehouse/backup-and-restore#geo-backups).</span><span class="sxs-lookup"><span data-stu-id="8bd01-277">For more information, see [Geo-backups](/azure/sql-data-warehouse/backup-and-restore#geo-backups).</span></span>

## <a name="sql-server-running-in-a-vm"></a><span data-ttu-id="8bd01-278">SQL Server que se ejecuta en una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="8bd01-278">SQL Server running in a VM</span></span>

<span data-ttu-id="8bd01-279">**Replique la base de datos.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-279">**Replicate the database.**</span></span> <span data-ttu-id="8bd01-280">Use los Grupos de disponibilidad Always On de SQL Server para replicar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-280">Use SQL Server Always On Availability Groups to replicate the database.</span></span> <span data-ttu-id="8bd01-281">Proporciona alta disponibilidad si se produce un error en una instancia de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8bd01-281">Provides high availability if one SQL Server instance fails.</span></span> <span data-ttu-id="8bd01-282">Para más información, consulte [Ejecución de máquinas virtuales Windows para una arquitectura de n niveles](../reference-architectures/virtual-machines-windows/n-tier.md).</span><span class="sxs-lookup"><span data-stu-id="8bd01-282">For more information, see [Run Windows VMs for an N-tier application](../reference-architectures/virtual-machines-windows/n-tier.md)</span></span>

<span data-ttu-id="8bd01-283">**Realice una copia de seguridad de la base de datos**.</span><span class="sxs-lookup"><span data-stu-id="8bd01-283">**Back up the database**.</span></span> <span data-ttu-id="8bd01-284">Si ya utiliza [Azure Backup](https://azure.microsoft.com/documentation/services/backup/) para realizar copias de seguridad de sus máquinas virtuales, considere la posibilidad de usar [Azure Backup para cargas de trabajo de SQL Server con DPM](/azure/backup/backup-azure-backup-sql/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-284">If you are already using [Azure Backup](https://azure.microsoft.com/documentation/services/backup/) to back up your VMs, consider using [Azure Backup for SQL Server workloads using DPM](/azure/backup/backup-azure-backup-sql/).</span></span> <span data-ttu-id="8bd01-285">Con este enfoque, hay un rol de administrador de copias de seguridad para la organización y un procedimiento unificado de recuperación para máquinas virtuales y SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8bd01-285">With this approach, there is one backup administrator role for the organization and a unified recovery procedure for VMs and SQL Server.</span></span> <span data-ttu-id="8bd01-286">En caso contrario, consulte [Copia de seguridad administrada de SQL Server en Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span><span class="sxs-lookup"><span data-stu-id="8bd01-286">Otherwise, use [SQL Server Managed Backup to Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span></span>

## <a name="traffic-manager"></a><span data-ttu-id="8bd01-287">Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="8bd01-287">Traffic Manager</span></span>

<span data-ttu-id="8bd01-288">**Realice la conmutación por recuperación manual.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-288">**Perform manual failback.**</span></span> <span data-ttu-id="8bd01-289">Después de una conmutación por error de Traffic Manager, realice la conmutación por recuperación manual, en lugar de la automática.</span><span class="sxs-lookup"><span data-stu-id="8bd01-289">After a Traffic Manager failover, perform manual failback, rather than automatically failing back.</span></span> <span data-ttu-id="8bd01-290">Antes de la conmutación por recuperación, compruebe que todos los subsistemas de aplicación tengan un estado correcto.</span><span class="sxs-lookup"><span data-stu-id="8bd01-290">Before failing back, verify that all application subsystems are healthy.</span></span>  <span data-ttu-id="8bd01-291">En caso contrario, puede crear una situación donde la aplicación va y viene incesantemente entre centros de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-291">Otherwise, you can create a situation where the application flips back and forth between data centers.</span></span> <span data-ttu-id="8bd01-292">Para más información, consulte [Ejecución de máquinas virtuales Windows en varias regiones para lograr alta disponibilidad](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span><span class="sxs-lookup"><span data-stu-id="8bd01-292">For more information, see [Run VMs in multiple regions for high availability](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span></span>

<span data-ttu-id="8bd01-293">**Cree un punto de conexión del sondeo de estado.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-293">**Create a health probe endpoint.**</span></span> <span data-ttu-id="8bd01-294">Crear un punto de conexión personalizado que informe sobre el estado general de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-294">Create a custom endpoint that reports on the overall health of the application.</span></span> <span data-ttu-id="8bd01-295">Esto permite que Traffic Manager conmute por error si se produce un error en cualquier ruta de acceso crítica, no solo el front-end.</span><span class="sxs-lookup"><span data-stu-id="8bd01-295">This enables Traffic Manager to fail over if any critical path fails, not just the front end.</span></span> <span data-ttu-id="8bd01-296">El punto de conexión debe devolver un código de error HTTP si cualquier dependencia crítica es incorrecta o inaccesible.</span><span class="sxs-lookup"><span data-stu-id="8bd01-296">The endpoint should return an HTTP error code if any critical dependency is unhealthy or unreachable.</span></span> <span data-ttu-id="8bd01-297">Sin embargo, no informe de errores para servicios no críticos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-297">Don't report errors for non-critical services, however.</span></span> <span data-ttu-id="8bd01-298">De lo contrario, el sondeo de estado podría desencadenar una conmutación por error cuando no sea necesario, con lo que se crean falsos positivos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-298">Otherwise, the health probe might trigger failover when it's not needed, creating false positives.</span></span> <span data-ttu-id="8bd01-299">Para más información, consulte [Supervisión de puntos de conexión de Traffic Manager](/azure/traffic-manager/traffic-manager-monitoring/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-299">For more information, see [Traffic Manager endpoint monitoring and failover](/azure/traffic-manager/traffic-manager-monitoring/).</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="8bd01-300">Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="8bd01-300">Virtual Machines</span></span>

<span data-ttu-id="8bd01-301">**Evite ejecutar una carga de trabajo de producción en una única máquina virtual.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-301">**Avoid running a production workload on a single VM.**</span></span> <span data-ttu-id="8bd01-302">Una única implementación de máquina virtual no es resistente al mantenimiento planeado o no planeado.</span><span class="sxs-lookup"><span data-stu-id="8bd01-302">A single VM deployment is not resilient to planned or unplanned maintenance.</span></span> <span data-ttu-id="8bd01-303">En su lugar, coloque varias máquinas virtuales en un conjunto de disponibilidad o [conjunto de escalado de máquina virtual](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), con un equilibrador de carga delante.</span><span class="sxs-lookup"><span data-stu-id="8bd01-303">Instead, put multiple VMs in an availability set or [VM scale set](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), with a load balancer in front.</span></span>

<span data-ttu-id="8bd01-304">**Especifique un conjunto de disponibilidad cuando aprovisione la máquina virtual.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-304">**Specify an availability set when you provision the VM.**</span></span> <span data-ttu-id="8bd01-305">Actualmente, no hay ninguna manera de agregar una máquina virtual a un conjunto de disponibilidad después de aprovisionar la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="8bd01-305">Currently, there is no way to add a VM to an availability set after the VM is provisioned.</span></span> <span data-ttu-id="8bd01-306">Cuando se agrega una nueva máquina virtual a un grupo de disponibilidad existente, asegúrese de crear una NIC para la máquina virtual y agregue la NIC al grupo de direcciones back-end en el equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="8bd01-306">When you add a new VM to an existing availability set, make sure to create a NIC for the VM, and add the NIC to the back-end address pool on the load balancer.</span></span> <span data-ttu-id="8bd01-307">De lo contrario, el equilibrador de carga no enrutará el tráfico de la red a esa máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="8bd01-307">Otherwise, the load balancer won't route network traffic to that VM.</span></span>

<span data-ttu-id="8bd01-308">**Ponga cada capa de aplicación en un conjunto de disponibilidad independiente.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-308">**Put each application tier into a separate Availability Set.**</span></span> <span data-ttu-id="8bd01-309">En una aplicación de n niveles, no coloque máquinas virtuales de diferentes niveles en el mismo conjunto de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="8bd01-309">In an N-tier application, don't put VMs from different tiers into the same availability set.</span></span> <span data-ttu-id="8bd01-310">Las máquinas virtuales de un conjunto de disponibilidad se colocan en dominios de error y en dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="8bd01-310">VMs in an availability set are placed across fault domains (FDs) and update domains (UD).</span></span> <span data-ttu-id="8bd01-311">Sin embargo, para obtener el beneficio de redundancia de los dominios de error y de los dominios de disponibilidad, cada máquina virtual en el conjunto de disponibilidad debe ser capaz de tratar las mismas solicitudes del cliente.</span><span class="sxs-lookup"><span data-stu-id="8bd01-311">However, to get the redundancy benefit of FDs and UDs, every VM in the availability set must be able to handle the same client requests.</span></span>

<span data-ttu-id="8bd01-312">**Replicación de máquinas virtuales con Azure Site Recovery**</span><span class="sxs-lookup"><span data-stu-id="8bd01-312">**Replicate VMs using Azure Site Recovery.**</span></span> <span data-ttu-id="8bd01-313">Al replicar máquinas virtuales de Azure con [Site Recovery][site-recovery], todos los discos de máquina virtual se replican continuamente de forma asincrónica en la región de destino.</span><span class="sxs-lookup"><span data-stu-id="8bd01-313">When you replicate Azure VMs using [Site Recovery][site-recovery], all the VM disks are continuously replicated to the target region asynchronously.</span></span> <span data-ttu-id="8bd01-314">Los puntos de recuperación se crean cada pocos minutos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-314">The recovery points are created every few minutes.</span></span> <span data-ttu-id="8bd01-315">Esto le ofrece un objetivo de punto de recuperación (RPO) en el orden de minutos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-315">This gives you a Recovery Point Objective (RPO) in the order of minutes.</span></span> <span data-ttu-id="8bd01-316">Puede realizar tantos simulacros de recuperación ante desastres como desee, sin que afecte a la aplicación de producción ni la replicación en curso.</span><span class="sxs-lookup"><span data-stu-id="8bd01-316">You can conduct disaster recovery drills as many times as you want, without impacting the production application or the ongoing replication.</span></span> <span data-ttu-id="8bd01-317">Para más información, consulte [Ejecución de un simulacro de recuperación ante desastres en Azure][site-recovery-test].</span><span class="sxs-lookup"><span data-stu-id="8bd01-317">For more information, see [Run a disaster recovery drill to Azure][site-recovery-test].</span></span>

<span data-ttu-id="8bd01-318">**Elija el tamaño de la máquina virtual adecuado según los requisitos de rendimiento.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-318">**Choose the right VM size based on performance requirements.**</span></span> <span data-ttu-id="8bd01-319">Al mover una carga de trabajo existente a Azure, comience con el tamaño de máquina virtual que más se acerque a los servidores locales.</span><span class="sxs-lookup"><span data-stu-id="8bd01-319">When moving an existing workload to Azure, start with the VM size that's the closest match to your on-premises servers.</span></span> <span data-ttu-id="8bd01-320">Luego, mida el rendimiento de la carga de trabajo real con respecto a la CPU, la memoria y la IOPS de disco, y ajuste el tamaño, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="8bd01-320">Then measure the performance of your actual workload with respect to CPU, memory, and disk IOPS, and adjust the size if needed.</span></span> <span data-ttu-id="8bd01-321">Esto ayuda a asegurar que la aplicación se comporte según lo previsto en un entorno de nube.</span><span class="sxs-lookup"><span data-stu-id="8bd01-321">This helps to ensure the application behaves as expected in a cloud environment.</span></span> <span data-ttu-id="8bd01-322">Además, si tiene varias tarjetas NIC, tenga en cuenta el límite de NIC para cada tamaño.</span><span class="sxs-lookup"><span data-stu-id="8bd01-322">Also, if you need multiple NICs, be aware of the NIC limit for each size.</span></span>

<span data-ttu-id="8bd01-323">**Use Managed Disks en discos duros virtuales.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-323">**Use Managed Disks for VHDs.**</span></span> <span data-ttu-id="8bd01-324">[Managed Disks][managed-disks] proporciona una mayor confiabilidad para las máquinas virtuales en los conjuntos de disponibilidad, porque los discos están suficientemente aislados entre sí para evitar únicos puntos de error.</span><span class="sxs-lookup"><span data-stu-id="8bd01-324">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="8bd01-325">Además, Managed Disks no está sujeto a los límites de IOPS de los discos duros virtuales creados en una cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8bd01-325">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="8bd01-326">Para más información, consulte [Administración de la disponibilidad de las máquinas virtuales Windows en Azure][vm-manage-availability].</span><span class="sxs-lookup"><span data-stu-id="8bd01-326">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>

<span data-ttu-id="8bd01-327">**Instale las aplicaciones en un disco de datos, no en el disco del sistema operativo.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-327">**Install applications on a data disk, not the OS disk.**</span></span> <span data-ttu-id="8bd01-328">De lo contrario, puede alcanzar el límite de tamaño de disco.</span><span class="sxs-lookup"><span data-stu-id="8bd01-328">Otherwise, you may reach the disk size limit.</span></span>

<span data-ttu-id="8bd01-329">**Use Azure Backup para hacer copia de seguridad de las máquinas virtuales.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-329">**Use Azure Backup to back up VMs.**</span></span> <span data-ttu-id="8bd01-330">Las copias de seguridad protegen contra la pérdida accidental de datos.</span><span class="sxs-lookup"><span data-stu-id="8bd01-330">Backups protect against accidental data loss.</span></span> <span data-ttu-id="8bd01-331">Para más información, consulte [Protección de máquinas virtuales de Azure con un almacén de Recovery Services](/azure/backup/backup-azure-vms-first-look-arm/)</span><span class="sxs-lookup"><span data-stu-id="8bd01-331">For more information, see [Protect Azure VMs with a recovery services vault](/azure/backup/backup-azure-vms-first-look-arm/).</span></span>

<span data-ttu-id="8bd01-332">**Habilite registros de diagnóstico**, incluidas las métricas de mantenimiento básicas, los registros de infraestructura y los [diagnósticos de arranque][boot-diagnostics].</span><span class="sxs-lookup"><span data-stu-id="8bd01-332">**Enable diagnostic logs**, including basic health metrics, infrastructure logs, and [boot diagnostics][boot-diagnostics].</span></span> <span data-ttu-id="8bd01-333">Los diagnósticos de arranque pueden ayudarle a diagnosticar un error de arranque si la VM entra en un estado de imposibilidad de arranque.</span><span class="sxs-lookup"><span data-stu-id="8bd01-333">Boot diagnostics can help you diagnose a boot failure if your VM gets into a non-bootable state.</span></span> <span data-ttu-id="8bd01-334">Para más información, consulte [Información general sobre los registros de diagnóstico de Azure][diagnostics-logs].</span><span class="sxs-lookup"><span data-stu-id="8bd01-334">For more information, see [Overview of Azure Diagnostic Logs][diagnostics-logs].</span></span>

<span data-ttu-id="8bd01-335">**Use la extensión AzureLogCollector.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-335">**Use the AzureLogCollector extension.**</span></span> <span data-ttu-id="8bd01-336">(Solo máquinas virtuales Windows). Esta extensión agrega los registros de la plataforma Azure y los carga en el almacenamiento de Azure, sin que el operador acceda de forma remota a la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="8bd01-336">(Windows VMs only.) This extension aggregates Azure platform logs and uploads them to Azure storage, without the operator remotely logging into the VM.</span></span> <span data-ttu-id="8bd01-337">Para más información, consulte la [extensión AzureLogCollector](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="8bd01-337">For more information, see [AzureLogCollector Extension](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

## <a name="virtual-network"></a><span data-ttu-id="8bd01-338">Virtual Network</span><span class="sxs-lookup"><span data-stu-id="8bd01-338">Virtual Network</span></span>

<span data-ttu-id="8bd01-339">**Para permitir o bloquear direcciones IP públicas, agregue un grupo de seguridad de red a la subred.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-339">**To whitelist or block public IP addresses, add an NSG to the subnet.**</span></span> <span data-ttu-id="8bd01-340">Bloquee el acceso de usuarios malintencionados o permita el acceso solo a los usuarios que tienen privilegios para acceder a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-340">Block access from malicious users, or allow access only from users who have privilege to access the application.</span></span>

<span data-ttu-id="8bd01-341">**Cree un sondeo de estado personalizado.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-341">**Create a custom health probe.**</span></span> <span data-ttu-id="8bd01-342">Los sondeos de estado de Load Balancer pueden probar los protocolos HTTP o TCP.</span><span class="sxs-lookup"><span data-stu-id="8bd01-342">Load Balancer Health Probes can test either HTTP or TCP.</span></span> <span data-ttu-id="8bd01-343">Si una máquina virtual ejecuta un servidor HTTP, el sondeo de HTTP es un indicador del estado de mantenimiento mejor que un sondeo de TCP.</span><span class="sxs-lookup"><span data-stu-id="8bd01-343">If a VM runs an HTTP server, the HTTP probe is a better indicator of health status than a TCP probe.</span></span> <span data-ttu-id="8bd01-344">Para un sondeo de HTTP, utilice un punto de conexión personalizado que informa del estado general de la aplicación, incluidas todas las dependencias críticas.</span><span class="sxs-lookup"><span data-stu-id="8bd01-344">For an HTTP probe, use a custom endpoint that reports the overall health of the application, including all critical dependencies.</span></span> <span data-ttu-id="8bd01-345">Para más información, consulte [Información general sobre Azure Load Balancer](/azure/load-balancer/load-balancer-overview/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-345">For more information, see [Azure Load Balancer overview](/azure/load-balancer/load-balancer-overview/).</span></span>

<span data-ttu-id="8bd01-346">**No bloquee el sondeo de estado.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-346">**Don't block the health probe.**</span></span> <span data-ttu-id="8bd01-347">El sondeo de estado de Load Balancer se envía desde una dirección IP conocida, 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="8bd01-347">The Load Balancer Health probe is sent from a known IP address, 168.63.129.16.</span></span> <span data-ttu-id="8bd01-348">No bloquee el tráfico hacia o desde esta dirección IP en las directivas de firewall o en las reglas de grupo de seguridad de red (NSG).</span><span class="sxs-lookup"><span data-stu-id="8bd01-348">Don't block traffic to or from this IP in any firewall policies or network security group (NSG) rules.</span></span> <span data-ttu-id="8bd01-349">El bloqueo del sondeo de estado podría causar que el equilibrador de carga quite la máquina virtual de la rotación.</span><span class="sxs-lookup"><span data-stu-id="8bd01-349">Blocking the health probe would cause the load balancer to remove the VM from rotation.</span></span>

<span data-ttu-id="8bd01-350">**Habilite el registro de Load Balancer.**</span><span class="sxs-lookup"><span data-stu-id="8bd01-350">**Enable Load Balancer logging.**</span></span> <span data-ttu-id="8bd01-351">Los registros muestran cuántas máquinas virtuales del back-end no reciben tráfico de red debido a las respuestas de sondeo con error.</span><span class="sxs-lookup"><span data-stu-id="8bd01-351">The logs show how many VMs on the back-end are not receiving network traffic due to failed probe responses.</span></span> <span data-ttu-id="8bd01-352">Para más información, consulte [Log Analytics para Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span><span class="sxs-lookup"><span data-stu-id="8bd01-352">For more information, see [Log analytics for Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span></span>

<!-- links -->
[boot-diagnostics]: https://azure.microsoft.com/blog/boot-diagnostics-for-virtual-machines-v2/
[diagnostics-logs]: /azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs/
[managed-disks]: /azure/storage/storage-managed-disks-overview
[search-optimization]: /azure/search/search-performance-optimization/
[site-recovery]: /azure/site-recovery/
[site-recovery-test]: /azure/site-recovery/site-recovery-test-failover-to-azure
[sql-backup]: /azure/sql-database/sql-database-automated-backups/
[sql-restore]: /azure/sql-database/sql-database-recovery-using-backups/
[vm-manage-availability]: /azure/virtual-machines/windows/manage-availability#use-managed-disks-for-vms-in-an-availability-set
