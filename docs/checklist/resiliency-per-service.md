---
title: "Lista de comprobación de resistencia para servicios de Azure"
description: "Lista de comprobación que proporciona una orientación sobre la resistencia de varios servicios de Azure."
author: petertaylor9999
ms.date: 03/02/2018
ms.custom: resiliency, checklist
ms.openlocfilehash: 25d961d6bb753b1f515fc073e51bbb912cc59db7
ms.sourcegitcommit: 2123c25b1a0b5501ff1887f98030787191cf6994
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/08/2018
---
# <a name="resiliency-checklist-for-specific-azure-services"></a><span data-ttu-id="ad08f-103">Lista de comprobación de resistencia para servicios de Azure específicos</span><span class="sxs-lookup"><span data-stu-id="ad08f-103">Resiliency checklist for specific Azure services</span></span>

<span data-ttu-id="ad08f-104">La resistencia es la capacidad de un sistema para recuperarse de errores y seguir en funcionamiento y es uno de los [pilares de la calidad del software](../guide/pillars.md).</span><span class="sxs-lookup"><span data-stu-id="ad08f-104">Resiliency is the ability of a system to recover from failures and continue to function, and is one of the [pillars of software quality](../guide/pillars.md).</span></span> <span data-ttu-id="ad08f-105">Todas las tecnologías tienen sus propios modos de error particulares que debe tener en cuenta al diseñar e implementar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-105">Every technology has its own particular failure modes, which you must consider when designing and implementing your application.</span></span> <span data-ttu-id="ad08f-106">Use esta lista de comprobación para revisar las consideraciones de resistencia para servicios específicos de Azure.</span><span class="sxs-lookup"><span data-stu-id="ad08f-106">Use this checklist to review the resiliency considerations for specific Azure services.</span></span> <span data-ttu-id="ad08f-107">Revise también la [lista de comprobación de resistencia general](./resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="ad08f-107">Also review the [general resiliency checklist](./resiliency.md).</span></span>

## <a name="app-service"></a><span data-ttu-id="ad08f-108">App Service</span><span class="sxs-lookup"><span data-stu-id="ad08f-108">App Service</span></span>

<span data-ttu-id="ad08f-109">**Utilice el nivel Estándar o Premium.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-109">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="ad08f-110">Estos niveles admiten espacios de ensayo y copias de seguridad automáticas.</span><span class="sxs-lookup"><span data-stu-id="ad08f-110">These tiers support staging slots and automated backups.</span></span> <span data-ttu-id="ad08f-111">Para más información, consulte [Introducción detallada sobre los planes de Azure App Service](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-111">For more information, see [Azure App Service plans in-depth overview](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)</span></span>

<span data-ttu-id="ad08f-112">**Evite el escalado o la reducción verticales.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-112">**Avoid scaling up or down.**</span></span> <span data-ttu-id="ad08f-113">En su lugar, seleccione un nivel y un tamaño de instancia que satisfagan sus requisitos de rendimiento con la carga típica y, a continuación, [escale horizontalmente](/azure/app-service-web/web-sites-scale/) las instancias para controlar los cambios en el volumen de tráfico.</span><span class="sxs-lookup"><span data-stu-id="ad08f-113">Instead, select a tier and instance size that meet your performance requirements under typical load, and then [scale out](/azure/app-service-web/web-sites-scale/) the instances to handle changes in traffic volume.</span></span> <span data-ttu-id="ad08f-114">El escalado y la reducción verticales pueden desencadenar un reinicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-114">Scaling up and down may trigger an application restart.</span></span>  

<span data-ttu-id="ad08f-115">**Almacene la configuración como valores de configuración de la aplicación.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-115">**Store configuration as app settings.**</span></span> <span data-ttu-id="ad08f-116">Utilice la configuración de la aplicación para almacenar los valores de configuración como valores de configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-116">Use app settings to hold configuration settings as app settings.</span></span> <span data-ttu-id="ad08f-117">Defina la configuración en las plantillas de Resource Manager o utilice PowerShell para que pueda aplicarlas como parte de un proceso automatizado de implementación o actualización, que es más confiable.</span><span class="sxs-lookup"><span data-stu-id="ad08f-117">Define the settings in your Resource Manager templates, or using PowerShell, so that you can apply them as part of an automated deployment / update process, which is more reliable.</span></span> <span data-ttu-id="ad08f-118">Para más información, consulte [Configuración de aplicaciones web en Azure App Service](/azure/app-service-web/web-sites-configure/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-118">For more information, see [Configure web apps in Azure App Service](/azure/app-service-web/web-sites-configure/).</span></span>

<span data-ttu-id="ad08f-119">**Cree planes de App Service independientes para producción y prueba.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-119">**Create separate App Service plans for production and test.**</span></span> <span data-ttu-id="ad08f-120">No utilice ranuras en la implementación de producción para pruebas.</span><span class="sxs-lookup"><span data-stu-id="ad08f-120">Don't use slots on your production deployment for testing.</span></span>  <span data-ttu-id="ad08f-121">Todas las aplicaciones del mismo plan de App Service comparten las mismas instancias de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="ad08f-121">All apps within the same App Service plan share the same VM instances.</span></span> <span data-ttu-id="ad08f-122">Si coloca implementaciones de producción y prueba en el mismo plan, puede afectar negativamente a la implementación de producción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-122">If you put production and test deployments in the same plan, it can negatively affect the production deployment.</span></span> <span data-ttu-id="ad08f-123">Por ejemplo, las pruebas de carga pueden degradar el sitio de producción en vivo.</span><span class="sxs-lookup"><span data-stu-id="ad08f-123">For example, load tests might degrade the live production site.</span></span> <span data-ttu-id="ad08f-124">Al colocar las implementaciones de prueba en un plan independiente, se aíslan de la versión de producción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-124">By putting test deployments into a separate plan, you isolate them from the production version.</span></span>  

<span data-ttu-id="ad08f-125">**Aplicaciones web independiente de las API web.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-125">**Separate web apps from web APIs.**</span></span> <span data-ttu-id="ad08f-126">Si la solución tiene un front-end web y una API web, considere descomponerlas en aplicaciones de App Service independientes.</span><span class="sxs-lookup"><span data-stu-id="ad08f-126">If your solution has both a web front-end and a web API, consider decomposing them into separate App Service apps.</span></span> <span data-ttu-id="ad08f-127">Este diseño facilita la descomposición de la solución por carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="ad08f-127">This design makes it easier to decompose the solution by workload.</span></span> <span data-ttu-id="ad08f-128">Puede ejecutar la aplicación web y la API en planes de App Service diferentes, por lo que se pueden escalar de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="ad08f-128">You can run the web app and the API in separate App Service plans, so they can be scaled independently.</span></span> <span data-ttu-id="ad08f-129">Si inicialmente no necesita ese nivel de escalabilidad, puede implementar las aplicaciones en el mismo plan y moverlas más tarde a planes diferentes si es necesario.</span><span class="sxs-lookup"><span data-stu-id="ad08f-129">If you don't need that level of scalability at first, you can deploy the apps into the same plan, and move them into separate plans later, if needed.</span></span>

<span data-ttu-id="ad08f-130">**Evite utilizar la característica de copia de seguridad de App Service para hacer copias de seguridad de las bases de datos Azure SQL Database.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-130">**Avoid using the App Service backup feature to back up Azure SQL databases.**</span></span> <span data-ttu-id="ad08f-131">En cambio, utilice las [copias de seguridad automatizadas de SQL Database][sql-backup].</span><span class="sxs-lookup"><span data-stu-id="ad08f-131">Instead, use [SQL Database automated backups][sql-backup].</span></span> <span data-ttu-id="ad08f-132">La copia de seguridad de App Service exporta la base de datos a un archivo .bacpac de SQL, que cuesta unidades de transmisión de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-132">App Service backup exports the database to a SQL .bacpac file, which costs DTUs.</span></span>  

<span data-ttu-id="ad08f-133">**Realice la implementación en un espacio de ensayo.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-133">**Deploy to a staging slot.**</span></span> <span data-ttu-id="ad08f-134">Cree una ranura de implementación para el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="ad08f-134">Create a deployment slot for staging.</span></span> <span data-ttu-id="ad08f-135">Implemente las actualizaciones de la aplicación en el espacio de ensayo y compruebe la implementación antes de cambiarla a producción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-135">Deploy application updates to the staging slot, and verify the deployment before swapping it into production.</span></span> <span data-ttu-id="ad08f-136">Esto reduce la posibilidad de una mala actualización en la producción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-136">This reduces the chance of a bad update in production.</span></span> <span data-ttu-id="ad08f-137">También garantiza que todas las instancias estén preparadas antes de pasarlas a producción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-137">It also ensures that all instances are warmed up before being swapped into production.</span></span> <span data-ttu-id="ad08f-138">Muchas aplicaciones presentan tiempos de preparación y arranque en frío considerables.</span><span class="sxs-lookup"><span data-stu-id="ad08f-138">Many applications have a significant warmup and cold-start time.</span></span> <span data-ttu-id="ad08f-139">Para más información, consulte [Configuración de entornos de ensayo para aplicaciones web en Azure App Service](/azure/app-service-web/web-sites-staged-publishing/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-139">For more information, see [Set up staging environments for web apps in Azure App Service](/azure/app-service-web/web-sites-staged-publishing/).</span></span>

<span data-ttu-id="ad08f-140">**Cree una ranura de implementación para conservar la última implementación válida conocida.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-140">**Create a deployment slot to hold the last-known-good (LKG) deployment.**</span></span> <span data-ttu-id="ad08f-141">Cuando implemente una actualización en producción, traslade la implementación de producción anterior a la ranura de la última configuración válida conocida.</span><span class="sxs-lookup"><span data-stu-id="ad08f-141">When you deploy an update to production, move the previous production deployment into the LKG slot.</span></span> <span data-ttu-id="ad08f-142">Esto facilita la reversión de una implementación incorrecta.</span><span class="sxs-lookup"><span data-stu-id="ad08f-142">This makes it easier to roll back a bad deployment.</span></span> <span data-ttu-id="ad08f-143">Si detecta un problema más tarde, puede revertir rápidamente a la última versión válida conocida.</span><span class="sxs-lookup"><span data-stu-id="ad08f-143">If you discover a problem later, you can quickly revert to the LKG version.</span></span> <span data-ttu-id="ad08f-144">Para más información, consulte [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md) (Aplicación web básica).</span><span class="sxs-lookup"><span data-stu-id="ad08f-144">For more information, see [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md).</span></span>

<span data-ttu-id="ad08f-145">**Habilite el registro de diagnóstico**, incluido el registro de aplicaciones y el registro del servidor web.</span><span class="sxs-lookup"><span data-stu-id="ad08f-145">**Enable diagnostics logging**, including application logging and web server logging.</span></span> <span data-ttu-id="ad08f-146">El registro es importante para la supervisión y diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="ad08f-146">Logging is important for monitoring and diagnostics.</span></span> <span data-ttu-id="ad08f-147">Consulte [Habilitación del registro de diagnóstico para aplicaciones web en Azure App Service](/azure/app-service-web/web-sites-enable-diagnostic-log/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-147">See [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service-web/web-sites-enable-diagnostic-log/)</span></span>

<span data-ttu-id="ad08f-148">**Regístrese en Blob Storage.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-148">**Log to blob storage.**</span></span> <span data-ttu-id="ad08f-149">Esto facilita la recopilación y el análisis de los datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-149">This makes it easier to collect and analyze the data.</span></span>

<span data-ttu-id="ad08f-150">**Cree una cuenta de almacenamiento para los registros.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-150">**Create a separate storage account for logs.**</span></span> <span data-ttu-id="ad08f-151">No use la misma cuenta de almacenamiento para los registros y los datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-151">Don't use the same storage account for logs and application data.</span></span> <span data-ttu-id="ad08f-152">Esto ayuda a evitar que el registro reduzca el rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-152">This helps to prevent logging from reducing application performance.</span></span>

<span data-ttu-id="ad08f-153">**Supervise el rendimiento.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-153">**Monitor performance.**</span></span> <span data-ttu-id="ad08f-154">Use un servicio de supervisión de rendimiento, como [New Relic](http://newrelic.com/) o [Application Insights](/azure/application-insights/app-insights-overview/), para supervisar el rendimiento de la aplicación y el comportamiento sometido a carga.</span><span class="sxs-lookup"><span data-stu-id="ad08f-154">Use a performance monitoring service such as [New Relic](http://newrelic.com/) or [Application Insights](/azure/application-insights/app-insights-overview/) to monitor application performance and behavior under load.</span></span>  <span data-ttu-id="ad08f-155">La supervisión del rendimiento le ofrece una visión en tiempo real de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-155">Performance monitoring gives you real-time insight into the application.</span></span> <span data-ttu-id="ad08f-156">Le permite diagnosticar problemas y realizar análisis de causa raíz de errores.</span><span class="sxs-lookup"><span data-stu-id="ad08f-156">It enables you to diagnose issues and perform root-cause analysis of failures.</span></span>

## <a name="application-gateway"></a><span data-ttu-id="ad08f-157">Application Gateway</span><span class="sxs-lookup"><span data-stu-id="ad08f-157">Application Gateway</span></span>

<span data-ttu-id="ad08f-158">**Aprovisione al menos dos instancias.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-158">**Provision at least two instances.**</span></span> <span data-ttu-id="ad08f-159">Implemente Application Gateway con al menos dos instancias.</span><span class="sxs-lookup"><span data-stu-id="ad08f-159">Deploy Application Gateway with at least two instances.</span></span> <span data-ttu-id="ad08f-160">Una única instancia es un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="ad08f-160">A single instance is a single point of failure.</span></span> <span data-ttu-id="ad08f-161">Utilice dos o más instancias para redundancia y escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="ad08f-161">Use two or more instances for redundancy and scalability.</span></span> <span data-ttu-id="ad08f-162">Para calificar para el [Acuerdo de Nivel de Servicio](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/), debe proporcionar dos o más instancias medianas o más grandes.</span><span class="sxs-lookup"><span data-stu-id="ad08f-162">In order to qualify for the [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/), you must provision two or more medium or larger instances.</span></span>

## <a name="cosmos-db"></a><span data-ttu-id="ad08f-163">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="ad08f-163">Cosmos DB</span></span>

<span data-ttu-id="ad08f-164">**Replique la base de datos en todas las regiones.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-164">**Replicate the database across regions.**</span></span> <span data-ttu-id="ad08f-165">Cosmos DB permite asociar cualquier número de regiones de Azure con una cuenta de base de datos de Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="ad08f-165">Cosmos DB allows you to associate any number of Azure regions with a Cosmos DB database account.</span></span> <span data-ttu-id="ad08f-166">Una base de datos Cosmos DB puede tener una región de escritura y varias regiones de lectura.</span><span class="sxs-lookup"><span data-stu-id="ad08f-166">A Cosmos DB database can have one write region and multiple read regions.</span></span> <span data-ttu-id="ad08f-167">Si se produce un error en la región de escritura, puede leer desde otra réplica.</span><span class="sxs-lookup"><span data-stu-id="ad08f-167">If there is a failure in the write region, you can read from another replica.</span></span> <span data-ttu-id="ad08f-168">El SDK de cliente lo trata automáticamente.</span><span class="sxs-lookup"><span data-stu-id="ad08f-168">The Client SDK handles this automatically.</span></span> <span data-ttu-id="ad08f-169">También puede conmutar por error la región de escritura a otra región.</span><span class="sxs-lookup"><span data-stu-id="ad08f-169">You can also fail over the write region to another region.</span></span> <span data-ttu-id="ad08f-170">Para más información, consulte [Cómo se distribuyen datos globalmente con Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).</span><span class="sxs-lookup"><span data-stu-id="ad08f-170">For more information, see [How to distribute data globally with Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).</span></span>

## <a name="event-hubs"></a><span data-ttu-id="ad08f-171">Event Hubs</span><span class="sxs-lookup"><span data-stu-id="ad08f-171">Event Hubs</span></span>

<span data-ttu-id="ad08f-172">**Use puntos de control**.</span><span class="sxs-lookup"><span data-stu-id="ad08f-172">**Use checkpoints**.</span></span>  <span data-ttu-id="ad08f-173">Un consumidor de eventos debe escribir su posición actual en el almacenamiento persistente según un intervalo predefinido.</span><span class="sxs-lookup"><span data-stu-id="ad08f-173">An event consumer should write its current position to persistent storage at some predefined interval.</span></span> <span data-ttu-id="ad08f-174">De este modo, si el consumidor experimenta un error (por ejemplo, el consumidor se bloquea o se produce un error en el host), una nueva instancia puede reanudar la lectura de la secuencia desde la última posición registrada.</span><span class="sxs-lookup"><span data-stu-id="ad08f-174">That way, if the consumer experiences a fault (for example, the consumer crashes, or the host fails), then a new instance can resume reading the stream from the last recorded position.</span></span> <span data-ttu-id="ad08f-175">Para más información, consulte [Consumidores de eventos](/azure/event-hubs/event-hubs-features#event-consumers).</span><span class="sxs-lookup"><span data-stu-id="ad08f-175">For more information, see [Event consumers](/azure/event-hubs/event-hubs-features#event-consumers).</span></span>

<span data-ttu-id="ad08f-176">**Controle los mensajes duplicados.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-176">**Handle duplicate messages.**</span></span> <span data-ttu-id="ad08f-177">Si se produce un error en un consumidor de eventos, el procesamiento de mensajes se reanudará desde el último punto de comprobación registrado.</span><span class="sxs-lookup"><span data-stu-id="ad08f-177">If an event consumer fails, message processing is resumed from the last recorded checkpoint.</span></span> <span data-ttu-id="ad08f-178">Todos los mensajes que ya se procesaron después del último punto de comprobación se procesarán de nuevo.</span><span class="sxs-lookup"><span data-stu-id="ad08f-178">Any messages that were already processed after the last checkpoint will be processed again.</span></span> <span data-ttu-id="ad08f-179">Por tanto, su lógica de procesamiento de mensajes debe ser idempotente, o la aplicación debe poder desduplicar los mensajes.</span><span class="sxs-lookup"><span data-stu-id="ad08f-179">Therefore, your message processing logic must be idempotent, or the application must be able to deduplicate messages.</span></span>

<span data-ttu-id="ad08f-180">**Controle las excepciones**.</span><span class="sxs-lookup"><span data-stu-id="ad08f-180">**Handle exceptions.**.</span></span> <span data-ttu-id="ad08f-181">Normalmente, un consumidor de eventos procesa un lote de mensajes en un bucle.</span><span class="sxs-lookup"><span data-stu-id="ad08f-181">An event consumer typically processes a batch of messages in a loop.</span></span> <span data-ttu-id="ad08f-182">Debe controlar las excepciones dentro de este bucle de procesamiento para evitar la pérdida de un lote completo de mensajes si un solo mensaje provoca una excepción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-182">You should handle exceptions within this processing loop to avoid losing an entire batch of messages if a single message causes an exception.</span></span>

<span data-ttu-id="ad08f-183">**Use una cola de mensajes con problemas de entrega**.</span><span class="sxs-lookup"><span data-stu-id="ad08f-183">**Use a dead-letter queue.**</span></span> <span data-ttu-id="ad08f-184">Si al procesar un mensaje se produce un error no transitorio, coloque el mensaje en una cola de mensajes con problemas de entrega para que pueda hacer un seguimiento del estado.</span><span class="sxs-lookup"><span data-stu-id="ad08f-184">If processing a message results in a non-transient failure, put the message onto a dead-letter queue, so that you can track the status.</span></span> <span data-ttu-id="ad08f-185">Según el escenario, puede volver a intentar enviar el mensaje más tarde, aplicar una transacción de compensación o realizar alguna otra acción.</span><span class="sxs-lookup"><span data-stu-id="ad08f-185">Depending on the scenario, you might retry the message later, apply a compensating transaction, or take some other action.</span></span> <span data-ttu-id="ad08f-186">Tenga en cuenta que Event Hubs no tiene ninguna funcionalidad integrada de cola de mensajes con problemas de entrega.</span><span class="sxs-lookup"><span data-stu-id="ad08f-186">Note that Event Hubs does not have any built-in dead-letter queue functionality.</span></span> <span data-ttu-id="ad08f-187">Puede usar Azure Queue Storage o Service Bus para implementar una cola de mensajes con problemas de entrega o emplear Azure Functions, o algún otro mecanismo de eventos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-187">You can use Azure Queue Storage or Service Bus to implement a dead-letter queue, or use Azure Functions or some other eventing mechanism.</span></span>  

<span data-ttu-id="ad08f-188">**Implemente la recuperación ante desastres mediante la conmutación por error en un espacio de nombres secundario de Event Hubs.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-188">**Implement disaster recovery by failing over to a secondary Event Hubs namespace.**</span></span> <span data-ttu-id="ad08f-189">Para más información, consulte [Recuperación ante desastres con localización geográfica de Azure Event Hubs](/azure/event-hubs/event-hubs-geo-dr).</span><span class="sxs-lookup"><span data-stu-id="ad08f-189">For more information, see [Azure Event Hubs Geo-disaster recovery](/azure/event-hubs/event-hubs-geo-dr).</span></span>

## <a name="redis-cache"></a><span data-ttu-id="ad08f-190">Caché en Redis</span><span class="sxs-lookup"><span data-stu-id="ad08f-190">Redis Cache</span></span>

<span data-ttu-id="ad08f-191">**Configurar la replicación geográfica**.</span><span class="sxs-lookup"><span data-stu-id="ad08f-191">**Configure Geo-replication**.</span></span> <span data-ttu-id="ad08f-192">La replicación geográfica proporciona un mecanismo para vincular dos instancias de Azure Redis Cache de nivel Premium.</span><span class="sxs-lookup"><span data-stu-id="ad08f-192">Geo-replication provides a mechanism for linking two Premium tier Azure Redis Cache instances.</span></span> <span data-ttu-id="ad08f-193">Los datos escritos en la caché principal se replican en una caché secundaria de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="ad08f-193">Data written to the primary cache is replicated to a secondary read-only cache.</span></span> <span data-ttu-id="ad08f-194">Para más información, consulte [Configuración de replicación geográfica para Azure Redis Cache](/azure/redis-cache/cache-how-to-geo-replication).</span><span class="sxs-lookup"><span data-stu-id="ad08f-194">For more information, see [How to configure Geo-replication for Azure Redis Cache](/azure/redis-cache/cache-how-to-geo-replication)</span></span>

<span data-ttu-id="ad08f-195">**Configurar la persistencia de los datos.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-195">**Configure data persistence.**</span></span> <span data-ttu-id="ad08f-196">La persistencia de Redis le permite conservar los datos almacenados en Redis.</span><span class="sxs-lookup"><span data-stu-id="ad08f-196">Redis persistence allows you to persist data stored in Redis.</span></span> <span data-ttu-id="ad08f-197">También puede tomar instantáneas y realizar copias de seguridad de los datos que puede cargar en el caso de un error de hardware.</span><span class="sxs-lookup"><span data-stu-id="ad08f-197">You can also take snapshots and back up the data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="ad08f-198">Para más información, consulte [Cómo configurar la persistencia de datos para una instancia premium de Azure Redis Cache](/azure/redis-cache/cache-how-to-premium-persistence).</span><span class="sxs-lookup"><span data-stu-id="ad08f-198">For more information, see [How to configure data persistence for a Premium Azure Redis Cache](/azure/redis-cache/cache-how-to-premium-persistence)</span></span>

<span data-ttu-id="ad08f-199">Si usa Redis Cache como caché de datos temporal y no como almacén persistente, puede que estas recomendaciones no se apliquen.</span><span class="sxs-lookup"><span data-stu-id="ad08f-199">If you are using Redis Cache as a temporary data cache and not as a persistent store, these recommendations may not apply.</span></span> 

## <a name="search"></a><span data-ttu-id="ad08f-200">Search</span><span class="sxs-lookup"><span data-stu-id="ad08f-200">Search</span></span>

<span data-ttu-id="ad08f-201">**Aprovisione más de una réplica.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-201">**Provision more than one replica.**</span></span> <span data-ttu-id="ad08f-202">Utilice al menos dos réplicas para alta disponibilidad de lectura, o tres para alta disponibilidad de lectura-escritura.</span><span class="sxs-lookup"><span data-stu-id="ad08f-202">Use at least two replicas for read high-availability, or three for read-write high-availability.</span></span>

<span data-ttu-id="ad08f-203">**Configure los indexadores para implementaciones en varias regiones**.</span><span class="sxs-lookup"><span data-stu-id="ad08f-203">**Configure indexers for multi-region deployments.**</span></span> <span data-ttu-id="ad08f-204">Si tiene una implementación de varias regiones, tenga en cuenta las opciones para la continuidad en la indexación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-204">If you have a multi-region deployment, consider your options for continuity in indexing.</span></span>

  * <span data-ttu-id="ad08f-205">Si el origen de datos está replicado geográficamente, por lo general debe dirigir cada indexador de cada servicio regional de Azure Search a su réplica local del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-205">If the data source is geo-replicated, you should generally point each indexer of each regional Azure Search service to its local data source replica.</span></span> <span data-ttu-id="ad08f-206">Sin embargo, este enfoque no se recomienda para grandes conjuntos de datos almacenados en Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="ad08f-206">However, that approach is not recommended for large datasets stored in Azure SQL Database.</span></span> <span data-ttu-id="ad08f-207">La razón es que Azure Search no puede realizar la indexación incremental desde réplicas secundarias de SQL Database, solo desde réplicas principales.</span><span class="sxs-lookup"><span data-stu-id="ad08f-207">The reason is that Azure Search cannot perform incremental indexing from secondary SQL Database replicas, only from primary replicas.</span></span> <span data-ttu-id="ad08f-208">En su lugar, seleccione todos los indexadores a la réplica principal.</span><span class="sxs-lookup"><span data-stu-id="ad08f-208">Instead, point all indexers to the primary replica.</span></span> <span data-ttu-id="ad08f-209">Después de una conmutación por error, elija los indexadores de Azure Search a la nueva réplica principal.</span><span class="sxs-lookup"><span data-stu-id="ad08f-209">After a failover, point the Azure Search indexers at the new primary replica.</span></span>  
  * <span data-ttu-id="ad08f-210">Si el origen de datos no está replicado geográficamente, seleccione varios indexadores en el mismo origen de datos, de modo que los servicios de Azure Search en múltiples regiones se indexen continua e independientemente en el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-210">If the data source is not geo-replicated, point multiple indexers at the same data source, so that Azure Search services in multiple regions continuously and independently index from the data source.</span></span> <span data-ttu-id="ad08f-211">Para más información, consulte [Consideraciones sobre el rendimiento y la optimización de Azure Search][search-optimization].</span><span class="sxs-lookup"><span data-stu-id="ad08f-211">For more information, see [Azure Search performance and optimization considerations][search-optimization].</span></span>

## <a name="storage"></a><span data-ttu-id="ad08f-212">Storage</span><span class="sxs-lookup"><span data-stu-id="ad08f-212">Storage</span></span>

<span data-ttu-id="ad08f-213">**Para los datos de aplicación, use almacenamiento con redundancia geográfica con acceso de lectura (RA-GRS).**</span><span class="sxs-lookup"><span data-stu-id="ad08f-213">**For application data, use read-access geo-redundant storage (RA-GRS).**</span></span> <span data-ttu-id="ad08f-214">El almacenamiento con redundancia geográfica con acceso de lectura replica los datos en una región secundaria y proporciona acceso de solo lectura desde la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="ad08f-214">RA-GRS storage replicates the data to a secondary region, and provides read-only access from the secondary region.</span></span> <span data-ttu-id="ad08f-215">Si hay una interrupción de almacenamiento en la región primaria, la aplicación puede leer los datos de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="ad08f-215">If there is a storage outage in the primary region, the application can read the data from the secondary region.</span></span> <span data-ttu-id="ad08f-216">Para más información, consulte [Replicación de Azure Storage](/azure/storage/storage-redundancy/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-216">For more information, see [Azure Storage replication](/azure/storage/storage-redundancy/).</span></span>

<span data-ttu-id="ad08f-217">**Para los discos de máquinas virtuales, use Managed Disks.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-217">**For VM disks, use Managed Disks.**</span></span> <span data-ttu-id="ad08f-218">[Managed Disks][managed-disks] proporciona una mayor confiabilidad para las máquinas virtuales en los conjuntos de disponibilidad, porque los discos están suficientemente aislados entre sí para evitar únicos puntos de error.</span><span class="sxs-lookup"><span data-stu-id="ad08f-218">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="ad08f-219">Además, Managed Disks no está sujeto a los límites de IOPS de los discos duros virtuales creados en una cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="ad08f-219">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="ad08f-220">Para más información, consulte [Administración de la disponibilidad de las máquinas virtuales Windows en Azure][vm-manage-availability].</span><span class="sxs-lookup"><span data-stu-id="ad08f-220">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>

<span data-ttu-id="ad08f-221">**Para Queue Storage, cree una cola de copia de seguridad en otra región.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-221">**For Queue storage, create a backup queue in another region.**</span></span> <span data-ttu-id="ad08f-222">Para Queue Storage, las réplicas de solo lectura tienen un uso limitado, ya que no se puede poner elementos en cola o quitarlos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-222">For Queue storage, a read-only replica has limited use, because you can't queue or dequeue items.</span></span> <span data-ttu-id="ad08f-223">En su lugar, cree una cola de copia de seguridad en una cuenta de almacenamiento en otra región.</span><span class="sxs-lookup"><span data-stu-id="ad08f-223">Instead, create a backup queue in a storage account in another region.</span></span> <span data-ttu-id="ad08f-224">Si se produce una interrupción de almacenamiento, la aplicación puede usar la cola de copia de seguridad hasta que la región primaria vuelva a estar disponible.</span><span class="sxs-lookup"><span data-stu-id="ad08f-224">If there is a storage outage, the application can use the backup queue, until the primary region becomes available again.</span></span> <span data-ttu-id="ad08f-225">De este modo, la aplicación puede seguir procesando nuevas solicitudes.</span><span class="sxs-lookup"><span data-stu-id="ad08f-225">That way, the application can still process new requests.</span></span>  

## <a name="sql-database"></a><span data-ttu-id="ad08f-226">SQL Database</span><span class="sxs-lookup"><span data-stu-id="ad08f-226">SQL Database</span></span>

<span data-ttu-id="ad08f-227">**Utilice el nivel Estándar o Premium.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-227">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="ad08f-228">Estos niveles ofrecen un período de restauración a un momento dado más prolongado (35 días).</span><span class="sxs-lookup"><span data-stu-id="ad08f-228">These tiers provide a longer point-in-time restore period (35 days).</span></span> <span data-ttu-id="ad08f-229">Para más información, consulte [Opciones y rendimiento de SQL Database](/azure/sql-database/sql-database-service-tiers/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-229">For more information, see [SQL Database options and performance](/azure/sql-database/sql-database-service-tiers/).</span></span>

<span data-ttu-id="ad08f-230">**Habilite la auditoría de SQL Database.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-230">**Enable SQL Database auditing.**</span></span> <span data-ttu-id="ad08f-231">La auditoría se puede utilizar para diagnosticar ataques maliciosos o errores humanos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-231">Auditing can be used to diagnose malicious attacks or human error.</span></span> <span data-ttu-id="ad08f-232">Para obtener más información, consulte [Introducción a la auditoría de la Base de datos SQL](/azure/sql-database/sql-database-auditing-get-started/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-232">For more information, see [Get started with SQL database auditing](/azure/sql-database/sql-database-auditing-get-started/).</span></span>

<span data-ttu-id="ad08f-233">**Use la replicación geográfica activa** Utilice esta replicación para crear una réplica secundaria legible en una región distinta.</span><span class="sxs-lookup"><span data-stu-id="ad08f-233">**Use Active Geo-Replication** Use Active Geo-Replication to create a readable secondary in a different region.</span></span>  <span data-ttu-id="ad08f-234">Si se produce un error en la base de datos principal o, simplemente, debe estar sin conexión, realice una conmutación por error manual a la base de datos secundaria.</span><span class="sxs-lookup"><span data-stu-id="ad08f-234">If your primary database fails, or simply needs to be taken offline, perform a manual failover to the secondary database.</span></span>  <span data-ttu-id="ad08f-235">Hasta que se realiza la conmutación por error, la base de datos secundaria sigue siendo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="ad08f-235">Until you fail over, the secondary database remains read-only.</span></span>  <span data-ttu-id="ad08f-236">Para más información, consulte [Replicación geográfica activa para Azure SQL Database](/azure/sql-database/sql-database-geo-replication-overview/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-236">For more information, see [SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/).</span></span>

<span data-ttu-id="ad08f-237">**Utilice el particionamiento.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-237">**Use sharding.**</span></span> <span data-ttu-id="ad08f-238">Considere el uso del particionamiento para realizar una partición horizontal de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-238">Consider using sharding to partition the database horizontally.</span></span> <span data-ttu-id="ad08f-239">El particionamiento puede proporcionar aislamiento de errores.</span><span class="sxs-lookup"><span data-stu-id="ad08f-239">Sharding can provide fault isolation.</span></span> <span data-ttu-id="ad08f-240">Para más información, consulte [Escalado horizontal con Azure SQL Database](/azure/sql-database/sql-database-elastic-scale-introduction/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-240">For more information, see [Scaling out with Azure SQL Database](/azure/sql-database/sql-database-elastic-scale-introduction/).</span></span>

<span data-ttu-id="ad08f-241">**Utilice la restauración a un momento dado para realizar la recuperación en caso de errores humanos.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-241">**Use point-in-time restore to recover from human error.**</span></span>  <span data-ttu-id="ad08f-242">La restauración a un momento dado devuelve la base de datos a un momento anterior en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="ad08f-242">Point-in-time restore returns your database to an earlier point in time.</span></span> <span data-ttu-id="ad08f-243">Para más información, consulte [Recuperación de una instancia de Azure SQL Database mediante copias de seguridad de datos automatizadas][sql-restore].</span><span class="sxs-lookup"><span data-stu-id="ad08f-243">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

<span data-ttu-id="ad08f-244">**Use la restauración geográfica para recuperarse de una interrupción del servicio.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-244">**Use geo-restore to recover from a service outage.**</span></span> <span data-ttu-id="ad08f-245">La restauración geográfica restaura una base de datos a partir de una copia de seguridad con redundancia geográfica.</span><span class="sxs-lookup"><span data-stu-id="ad08f-245">Geo-restore restores a database from a geo-redundant backup.</span></span>  <span data-ttu-id="ad08f-246">Para más información, consulte [Recuperación de una instancia de Azure SQL Database mediante copias de seguridad de datos automatizadas][sql-restore].</span><span class="sxs-lookup"><span data-stu-id="ad08f-246">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

## <a name="sql-server-running-in-a-vm"></a><span data-ttu-id="ad08f-247">SQL Server que se ejecuta en una máquina virtual</span><span class="sxs-lookup"><span data-stu-id="ad08f-247">SQL Server running in a VM</span></span>

<span data-ttu-id="ad08f-248">**Replique la base de datos.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-248">**Replicate the database.**</span></span> <span data-ttu-id="ad08f-249">Use los Grupos de disponibilidad Always On de SQL Server para replicar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-249">Use SQL Server Always On Availability Groups to replicate the database.</span></span> <span data-ttu-id="ad08f-250">Proporciona alta disponibilidad si se produce un error en una instancia de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad08f-250">Provides high availability if one SQL Server instance fails.</span></span> <span data-ttu-id="ad08f-251">Para más información, consulte [Ejecución de máquinas virtuales Windows para una arquitectura de n niveles](../reference-architectures/virtual-machines-windows/n-tier.md).</span><span class="sxs-lookup"><span data-stu-id="ad08f-251">For more information, see [Run Windows VMs for an N-tier application](../reference-architectures/virtual-machines-windows/n-tier.md)</span></span>

<span data-ttu-id="ad08f-252">**Realice una copia de seguridad de la base de datos**.</span><span class="sxs-lookup"><span data-stu-id="ad08f-252">**Back up the database**.</span></span> <span data-ttu-id="ad08f-253">Si ya utiliza [Azure Backup](https://azure.microsoft.com/documentation/services/backup/) para realizar copias de seguridad de sus máquinas virtuales, considere la posibilidad de usar [Azure Backup para cargas de trabajo de SQL Server con DPM](/azure/backup/backup-azure-backup-sql/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-253">If you are already using [Azure Backup](https://azure.microsoft.com/documentation/services/backup/) to back up your VMs, consider using [Azure Backup for SQL Server workloads using DPM](/azure/backup/backup-azure-backup-sql/).</span></span> <span data-ttu-id="ad08f-254">Con este enfoque, hay un rol de administrador de copias de seguridad para la organización y un procedimiento unificado de recuperación para máquinas virtuales y SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad08f-254">With this approach, there is one backup administrator role for the organization and a unified recovery procedure for VMs and SQL Server.</span></span> <span data-ttu-id="ad08f-255">En caso contrario, consulte [Copia de seguridad administrada de SQL Server en Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span><span class="sxs-lookup"><span data-stu-id="ad08f-255">Otherwise, use [SQL Server Managed Backup to Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span></span>

## <a name="traffic-manager"></a><span data-ttu-id="ad08f-256">Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="ad08f-256">Traffic Manager</span></span>

<span data-ttu-id="ad08f-257">**Realice la conmutación por recuperación manual.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-257">**Perform manual failback.**</span></span> <span data-ttu-id="ad08f-258">Después de una conmutación por error de Traffic Manager, realice la conmutación por recuperación manual, en lugar de la automática.</span><span class="sxs-lookup"><span data-stu-id="ad08f-258">After a Traffic Manager failover, perform manual failback, rather than automatically failing back.</span></span> <span data-ttu-id="ad08f-259">Antes de la conmutación por recuperación, compruebe que todos los subsistemas de aplicación tengan un estado correcto.</span><span class="sxs-lookup"><span data-stu-id="ad08f-259">Before failing back, verify that all application subsystems are healthy.</span></span>  <span data-ttu-id="ad08f-260">En caso contrario, puede crear una situación donde la aplicación va y viene incesantemente entre centros de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-260">Otherwise, you can create a situation where the application flips back and forth between data centers.</span></span> <span data-ttu-id="ad08f-261">Para más información, consulte [Ejecución de máquinas virtuales Windows en varias regiones para lograr alta disponibilidad](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span><span class="sxs-lookup"><span data-stu-id="ad08f-261">For more information, see [Run VMs in multiple regions for high availability](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span></span>

<span data-ttu-id="ad08f-262">**Cree un punto de conexión del sondeo de estado.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-262">**Create a health probe endpoint.**</span></span> <span data-ttu-id="ad08f-263">Crear un punto de conexión personalizado que informe sobre el estado general de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-263">Create a custom endpoint that reports on the overall health of the application.</span></span> <span data-ttu-id="ad08f-264">Esto permite que Traffic Manager conmute por error si se produce un error en cualquier ruta de acceso crítica, no solo el front-end.</span><span class="sxs-lookup"><span data-stu-id="ad08f-264">This enables Traffic Manager to fail over if any critical path fails, not just the front end.</span></span> <span data-ttu-id="ad08f-265">El punto de conexión debe devolver un código de error HTTP si cualquier dependencia crítica es incorrecta o inaccesible.</span><span class="sxs-lookup"><span data-stu-id="ad08f-265">The endpoint should return an HTTP error code if any critical dependency is unhealthy or unreachable.</span></span> <span data-ttu-id="ad08f-266">Sin embargo, no informe de errores para servicios no críticos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-266">Don't report errors for non-critical services, however.</span></span> <span data-ttu-id="ad08f-267">De lo contrario, el sondeo de estado podría desencadenar una conmutación por error cuando no sea necesario, con lo que se crean falsos positivos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-267">Otherwise, the health probe might trigger failover when it's not needed, creating false positives.</span></span> <span data-ttu-id="ad08f-268">Para más información, consulte [Supervisión de puntos de conexión de Traffic Manager](/azure/traffic-manager/traffic-manager-monitoring/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-268">For more information, see [Traffic Manager endpoint monitoring and failover](/azure/traffic-manager/traffic-manager-monitoring/).</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="ad08f-269">Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="ad08f-269">Virtual Machines</span></span>

<span data-ttu-id="ad08f-270">**Evite ejecutar una carga de trabajo de producción en una única máquina virtual.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-270">**Avoid running a production workload on a single VM.**</span></span> <span data-ttu-id="ad08f-271">Una única implementación de máquina virtual no es resistente al mantenimiento planeado o no planeado.</span><span class="sxs-lookup"><span data-stu-id="ad08f-271">A single VM deployment is not resilient to planned or unplanned maintenance.</span></span> <span data-ttu-id="ad08f-272">En su lugar, coloque varias máquinas virtuales en un conjunto de disponibilidad o [conjunto de escalado de máquina virtual](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), con un equilibrador de carga delante.</span><span class="sxs-lookup"><span data-stu-id="ad08f-272">Instead, put multiple VMs in an availability set or [VM scale set](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), with a load balancer in front.</span></span>

<span data-ttu-id="ad08f-273">**Especifique un conjunto de disponibilidad cuando aprovisione la máquina virtual.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-273">**Specify an availability set when you provision the VM.**</span></span> <span data-ttu-id="ad08f-274">Actualmente, no hay ninguna manera de agregar una máquina virtual a un conjunto de disponibilidad después de aprovisionar la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="ad08f-274">Currently, there is no way to add a VM to an availability set after the VM is provisioned.</span></span> <span data-ttu-id="ad08f-275">Cuando se agrega una nueva máquina virtual a un grupo de disponibilidad existente, asegúrese de crear una NIC para la máquina virtual y agregue la NIC al grupo de direcciones back-end en el equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="ad08f-275">When you add a new VM to an existing availability set, make sure to create a NIC for the VM, and add the NIC to the back-end address pool on the load balancer.</span></span> <span data-ttu-id="ad08f-276">De lo contrario, el equilibrador de carga no enrutará el tráfico de la red a esa máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="ad08f-276">Otherwise, the load balancer won't route network traffic to that VM.</span></span>

<span data-ttu-id="ad08f-277">**Ponga cada capa de aplicación en un conjunto de disponibilidad independiente.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-277">**Put each application tier into a separate Availability Set.**</span></span> <span data-ttu-id="ad08f-278">En una aplicación de n niveles, no coloque máquinas virtuales de diferentes niveles en el mismo conjunto de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="ad08f-278">In an N-tier application, don't put VMs from different tiers into the same availability set.</span></span> <span data-ttu-id="ad08f-279">Las máquinas virtuales de un conjunto de disponibilidad se colocan en dominios de error y en dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="ad08f-279">VMs in an availability set are placed across fault domains (FDs) and update domains (UD).</span></span> <span data-ttu-id="ad08f-280">Sin embargo, para obtener el beneficio de redundancia de los dominios de error y de los dominios de disponibilidad, cada máquina virtual en el conjunto de disponibilidad debe ser capaz de tratar las mismas solicitudes del cliente.</span><span class="sxs-lookup"><span data-stu-id="ad08f-280">However, to get the redundancy benefit of FDs and UDs, every VM in the availability set must be able to handle the same client requests.</span></span>

<span data-ttu-id="ad08f-281">**Elija el tamaño de la máquina virtual adecuado según los requisitos de rendimiento.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-281">**Choose the right VM size based on performance requirements.**</span></span> <span data-ttu-id="ad08f-282">Al mover una carga de trabajo existente a Azure, comience con el tamaño de máquina virtual que más se acerque a los servidores locales.</span><span class="sxs-lookup"><span data-stu-id="ad08f-282">When moving an existing workload to Azure, start with the VM size that's the closest match to your on-premises servers.</span></span> <span data-ttu-id="ad08f-283">Luego, mida el rendimiento de la carga de trabajo real con respecto a la CPU, la memoria y la IOPS de disco, y ajuste el tamaño, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="ad08f-283">Then measure the performance of your actual workload with respect to CPU, memory, and disk IOPS, and adjust the size if needed.</span></span> <span data-ttu-id="ad08f-284">Esto ayuda a asegurar que la aplicación se comporte según lo previsto en un entorno de nube.</span><span class="sxs-lookup"><span data-stu-id="ad08f-284">This helps to ensure the application behaves as expected in a cloud environment.</span></span> <span data-ttu-id="ad08f-285">Además, si tiene varias tarjetas NIC, tenga en cuenta el límite de NIC para cada tamaño.</span><span class="sxs-lookup"><span data-stu-id="ad08f-285">Also, if you need multiple NICs, be aware of the NIC limit for each size.</span></span>

<span data-ttu-id="ad08f-286">**Use Managed Disks en discos duros virtuales.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-286">**Use Managed Disks for VHDs.**</span></span> <span data-ttu-id="ad08f-287">[Managed Disks][managed-disks] proporciona una mayor confiabilidad para las máquinas virtuales en los conjuntos de disponibilidad, porque los discos están suficientemente aislados entre sí para evitar únicos puntos de error.</span><span class="sxs-lookup"><span data-stu-id="ad08f-287">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="ad08f-288">Además, Managed Disks no está sujeto a los límites de IOPS de los discos duros virtuales creados en una cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="ad08f-288">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="ad08f-289">Para más información, consulte [Administración de la disponibilidad de las máquinas virtuales Windows en Azure][vm-manage-availability].</span><span class="sxs-lookup"><span data-stu-id="ad08f-289">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>

<span data-ttu-id="ad08f-290">**Instale las aplicaciones en un disco de datos, no en el disco del sistema operativo.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-290">**Install applications on a data disk, not the OS disk.**</span></span> <span data-ttu-id="ad08f-291">De lo contrario, puede alcanzar el límite de tamaño de disco.</span><span class="sxs-lookup"><span data-stu-id="ad08f-291">Otherwise, you may reach the disk size limit.</span></span>

<span data-ttu-id="ad08f-292">**Use Azure Backup para hacer copia de seguridad de las máquinas virtuales.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-292">**Use Azure Backup to back up VMs.**</span></span> <span data-ttu-id="ad08f-293">Las copias de seguridad protegen contra la pérdida accidental de datos.</span><span class="sxs-lookup"><span data-stu-id="ad08f-293">Backups protect against accidental data loss.</span></span> <span data-ttu-id="ad08f-294">Para más información, consulte [Protección de máquinas virtuales de Azure con un almacén de Recovery Services](/azure/backup/backup-azure-vms-first-look-arm/)</span><span class="sxs-lookup"><span data-stu-id="ad08f-294">For more information, see [Protect Azure VMs with a recovery services vault](/azure/backup/backup-azure-vms-first-look-arm/).</span></span>

<span data-ttu-id="ad08f-295">**Habilite registros de diagnóstico**, incluidas las métricas de mantenimiento básicas, los registros de infraestructura y los [diagnósticos de arranque][boot-diagnostics].</span><span class="sxs-lookup"><span data-stu-id="ad08f-295">**Enable diagnostic logs**, including basic health metrics, infrastructure logs, and [boot diagnostics][boot-diagnostics].</span></span> <span data-ttu-id="ad08f-296">Los diagnósticos de arranque pueden ayudarle a diagnosticar un error de arranque si la VM entra en un estado de imposibilidad de arranque.</span><span class="sxs-lookup"><span data-stu-id="ad08f-296">Boot diagnostics can help you diagnose a boot failure if your VM gets into a non-bootable state.</span></span> <span data-ttu-id="ad08f-297">Para más información, consulte [Información general sobre los registros de diagnóstico de Azure][diagnostics-logs].</span><span class="sxs-lookup"><span data-stu-id="ad08f-297">For more information, see [Overview of Azure Diagnostic Logs][diagnostics-logs].</span></span>

<span data-ttu-id="ad08f-298">**Use la extensión AzureLogCollector.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-298">**Use the AzureLogCollector extension.**</span></span> <span data-ttu-id="ad08f-299">(Solo máquinas virtuales Windows). Esta extensión agrega los registros de la plataforma Azure y los carga en el almacenamiento de Azure, sin que el operador acceda de forma remota a la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="ad08f-299">(Windows VMs only.) This extension aggregates Azure platform logs and uploads them to Azure storage, without the operator remotely logging into the VM.</span></span> <span data-ttu-id="ad08f-300">Para más información, consulte la [extensión AzureLogCollector](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="ad08f-300">For more information, see [AzureLogCollector Extension](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

## <a name="virtual-network"></a><span data-ttu-id="ad08f-301">Virtual Network</span><span class="sxs-lookup"><span data-stu-id="ad08f-301">Virtual Network</span></span>

<span data-ttu-id="ad08f-302">**Para permitir o bloquear direcciones IP públicas, agregue un grupo de seguridad de red a la subred.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-302">**To whitelist or block public IP addresses, add an NSG to the subnet.**</span></span> <span data-ttu-id="ad08f-303">Bloquee el acceso de usuarios malintencionados o permita el acceso solo a los usuarios que tienen privilegios para acceder a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-303">Block access from malicious users, or allow access only from users who have privilege to access the application.</span></span>  

<span data-ttu-id="ad08f-304">**Cree un sondeo de estado personalizado.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-304">**Create a custom health probe.**</span></span> <span data-ttu-id="ad08f-305">Los sondeos de estado de Load Balancer pueden probar los protocolos HTTP o TCP.</span><span class="sxs-lookup"><span data-stu-id="ad08f-305">Load Balancer Health Probes can test either HTTP or TCP.</span></span> <span data-ttu-id="ad08f-306">Si una máquina virtual ejecuta un servidor HTTP, el sondeo de HTTP es un indicador del estado de mantenimiento mejor que un sondeo de TCP.</span><span class="sxs-lookup"><span data-stu-id="ad08f-306">If a VM runs an HTTP server, the HTTP probe is a better indicator of health status than a TCP probe.</span></span> <span data-ttu-id="ad08f-307">Para un sondeo de HTTP, utilice un punto de conexión personalizado que informa del estado general de la aplicación, incluidas todas las dependencias críticas.</span><span class="sxs-lookup"><span data-stu-id="ad08f-307">For an HTTP probe, use a custom endpoint that reports the overall health of the application, including all critical dependencies.</span></span> <span data-ttu-id="ad08f-308">Para más información, consulte [Información general sobre Azure Load Balancer](/azure/load-balancer/load-balancer-overview/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-308">For more information, see [Azure Load Balancer overview](/azure/load-balancer/load-balancer-overview/).</span></span>

<span data-ttu-id="ad08f-309">**No bloquee el sondeo de estado.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-309">**Don't block the health probe.**</span></span> <span data-ttu-id="ad08f-310">El sondeo de estado de Load Balancer se envía desde una dirección IP conocida, 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="ad08f-310">The Load Balancer Health probe is sent from a known IP address, 168.63.129.16.</span></span> <span data-ttu-id="ad08f-311">No bloquee el tráfico hacia o desde esta dirección IP en las directivas de firewall o en las reglas de grupo de seguridad de red (NSG).</span><span class="sxs-lookup"><span data-stu-id="ad08f-311">Don't block traffic to or from this IP in any firewall policies or network security group (NSG) rules.</span></span> <span data-ttu-id="ad08f-312">El bloqueo del sondeo de estado podría causar que el equilibrador de carga quite la máquina virtual de la rotación.</span><span class="sxs-lookup"><span data-stu-id="ad08f-312">Blocking the health probe would cause the load balancer to remove the VM from rotation.</span></span>

<span data-ttu-id="ad08f-313">**Habilite el registro de Load Balancer.**</span><span class="sxs-lookup"><span data-stu-id="ad08f-313">**Enable Load Balancer logging.**</span></span> <span data-ttu-id="ad08f-314">Los registros muestran cuántas máquinas virtuales del back-end no reciben tráfico de red debido a las respuestas de sondeo con error.</span><span class="sxs-lookup"><span data-stu-id="ad08f-314">The logs show how many VMs on the back-end are not receiving network traffic due to failed probe responses.</span></span> <span data-ttu-id="ad08f-315">Para más información, consulte [Log Analytics para Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span><span class="sxs-lookup"><span data-stu-id="ad08f-315">For more information, see [Log analytics for Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span></span>

<!-- links -->
[boot-diagnostics]: https://azure.microsoft.com/blog/boot-diagnostics-for-virtual-machines-v2/
[diagnostics-logs]: /azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs/
[managed-disks]: /azure/storage/storage-managed-disks-overview
[search-optimization]: /azure/search/search-performance-optimization/
[sql-backup]: /azure/sql-database/sql-database-automated-backups/
[sql-restore]: /azure/sql-database/sql-database-recovery-using-backups/
[vm-manage-availability]: /azure/virtual-machines/windows/manage-availability#use-managed-disks-for-vms-in-an-availability-set
