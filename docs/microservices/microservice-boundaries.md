---
title: Identificación de los límites de los microservicios
description: Identificación de los límites de los microservicios
author: MikeWasson
ms.date: 12/08/2017
ms.openlocfilehash: d35b92ffd97c4fda5d6599340925ce3dfea7f15b
ms.sourcegitcommit: a5e549c15a948f6fb5cec786dbddc8578af3be66
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2018
ms.locfileid: "33673409"
---
# <a name="designing-microservices-identifying-microservice-boundaries"></a><span data-ttu-id="b6fbf-103">Diseño de microservicios: identificación de los límites de los microservicios</span><span class="sxs-lookup"><span data-stu-id="b6fbf-103">Designing microservices: Identifying microservice boundaries</span></span>

<span data-ttu-id="b6fbf-104">¿Cuál es el tamaño correcto para un microservicio?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-104">What is the right size for a microservice?</span></span> <span data-ttu-id="b6fbf-105">Seguramente oirá afirmaciones del tipo "ni demasiado grande ni demasiado pequeño", y aunque esto es ciertamente correcto, no resulta muy útil en la práctica.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-105">You often hear something to the effect of, "not too big and not too small" &mdash; and while that's certainly correct, it's not very helpful in practice.</span></span> <span data-ttu-id="b6fbf-106">Pero si se empieza desde un modelo de dominio cuidadosamente diseñado, es mucho más fácil razonar acerca de los microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-106">But if you start from a carefully designed domain model, it's much easier to reason about microservices.</span></span>

![](./images/bounded-contexts.png)

## <a name="from-domain-model-to-microservices"></a><span data-ttu-id="b6fbf-107">Desde un modelo de dominio a los microservicios</span><span class="sxs-lookup"><span data-stu-id="b6fbf-107">From domain model to microservices</span></span>

<span data-ttu-id="b6fbf-108">En el [capítulo anterior](./domain-analysis.md), definimos un conjunto de contextos delimitados para la aplicación Drone Delivery.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-108">In the [previous chapter](./domain-analysis.md), we defined a set of bounded contexts for the Drone Delivery application.</span></span> <span data-ttu-id="b6fbf-109">Luego observamos más de cerca uno de estos contextos delimitados, el contexto delimitado Shipping, e identificamos un conjunto de entidades, agregados, y servicios de dominio para ese contexto delimitado.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-109">Then we looked more closely at one of these bounded contexts, the Shipping bounded context, and identified a set of entities, aggregates, and domain services for that bounded context.</span></span>

<span data-ttu-id="b6fbf-110">Ahora estamos preparados para pasar del modelo de dominio al diseño de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-110">Now we're ready to go from domain model to application design.</span></span> <span data-ttu-id="b6fbf-111">Este es un enfoque que puede usar para derivar microservicios desde el modelo de dominio.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-111">Here's an approach that you can use to derive microservices from the domain model.</span></span>

1. <span data-ttu-id="b6fbf-112">Comience con un contexto delimitado.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-112">Start with a bounded context.</span></span> <span data-ttu-id="b6fbf-113">En general, la funcionalidad en un microservicio no debe abarcar más de un contexto delimitado.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-113">In general, the functionality in a microservice should not span more than one bounded context.</span></span> <span data-ttu-id="b6fbf-114">Por definición, un contexto delimitado marca el límite de un modelo de dominio en particular.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-114">By definition, a bounded context marks the boundary of a particular domain model.</span></span> <span data-ttu-id="b6fbf-115">Si encuentra que un microservicio mezcla modelos de dominio diferentes, es un signo de que puede que tenga que volver atrás para refinar el análisis de dominio.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-115">If you find that a microservice mixes different domain models together, that's a sign that you may need to go back and refine your domain analysis.</span></span>

2. <span data-ttu-id="b6fbf-116">A continuación, mire los agregados en el modelo de dominio.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-116">Next, look at the aggregates in your domain model.</span></span> <span data-ttu-id="b6fbf-117">Los agregados suelen ser buenos candidatos para microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-117">Aggregates are often good candidates for microservices.</span></span> <span data-ttu-id="b6fbf-118">Un agregado bien diseñado tiene muchas de las características de un microservicio bien diseñado, como:</span><span class="sxs-lookup"><span data-stu-id="b6fbf-118">A well-designed aggregate exhibits many of the characteristics of a well-designed microservice, such as:</span></span>

    - <span data-ttu-id="b6fbf-119">Un agregado se deriva de los requisitos empresariales más que de las preocupaciones técnicas, como el acceso a datos o la mensajería.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-119">An aggregate is derived from business requirements, rather than technical concerns such as data access or messaging.</span></span>  
    - <span data-ttu-id="b6fbf-120">Un agregado debe tener alta cohesión funcional.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-120">An aggregate should have high functional cohesion.</span></span>
    - <span data-ttu-id="b6fbf-121">Un agregado es un límite de persistencia.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-121">An aggregate is a boundary of persistence.</span></span>
    - <span data-ttu-id="b6fbf-122">Los agregados deben tener un acoplamiento flexible.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-122">Aggregates should be loosely coupled.</span></span> 
    
3. <span data-ttu-id="b6fbf-123">Los servicios de dominio también son buenos candidatos para microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-123">Domain services are also good candidates for microservices.</span></span> <span data-ttu-id="b6fbf-124">Los servicios de dominio son operaciones sin estado a través de varios agregados.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-124">Domain services are stateless operations across multiple aggregates.</span></span> <span data-ttu-id="b6fbf-125">Un ejemplo típico es un flujo de trabajo que implica varios microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-125">A typical example is a workflow that involves several microservices.</span></span> <span data-ttu-id="b6fbf-126">Veremos un ejemplo de esto en la aplicación Drone Delivery.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-126">We'll see an example of this in the Drone Delivery application.</span></span>

4. <span data-ttu-id="b6fbf-127">Por último, tenga en cuenta los requisitos no funcionales.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-127">Finally, consider non-functional requirements.</span></span> <span data-ttu-id="b6fbf-128">Observe factores como el tamaño del equipo, los tipos de datos, tecnologías, requisitos de escalabilidad, requisitos de disponibilidad y requisitos de seguridad.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-128">Look at factors such as team size, data types, technologies, scalability requirements, availability requirements, and security requirements.</span></span> <span data-ttu-id="b6fbf-129">Estos factores pueden llevarle a volver a dividir un microservicio en dos o más servicios más pequeños, o a hacer lo contrario combinando varios microservicios en uno.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-129">These factors may lead you to further decompose a microservice into two or more smaller services, or do the opposite and combine several microservices into one.</span></span> 

<span data-ttu-id="b6fbf-130">Después de identificar los microservicios en su aplicación, valide el diseño con los siguientes criterios:</span><span class="sxs-lookup"><span data-stu-id="b6fbf-130">After you identify the microservices in your application, validate your design against the following criteria:</span></span>

- <span data-ttu-id="b6fbf-131">Cada servicio tiene una única responsabilidad.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-131">Each service has a single responsibility.</span></span>
- <span data-ttu-id="b6fbf-132">No hay llamadas que generen mucha conversación entre servicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-132">There are no chatty calls between services.</span></span> <span data-ttu-id="b6fbf-133">Si dividir la funcionalidad en dos servicios hace que estos generen demasiada conversación, esto puede ser una indicación de que estas funciones deben estar en el mismo servicio.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-133">If splitting functionality into two services causes them to be overly chatty, it may be a symptom that these functions belong in the same service.</span></span>
- <span data-ttu-id="b6fbf-134">Cada servicio es lo suficientemente pequeño como para que un equipo pequeño lo pueda generar trabajando de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-134">Each service is small enough that it can be built by a small team working independently.</span></span>
- <span data-ttu-id="b6fbf-135">No hay interdependencias que requieran la implementación de dos o más servicios en sincronía.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-135">There are no inter-dependencies that will require two or more services to be deployed in lock-step.</span></span> <span data-ttu-id="b6fbf-136">Siempre debe ser posible implementar un servicio sin tener que volver a implementar ninguno de los demás servicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-136">It should always be possible to deploy a service without redeploying any other services.</span></span>
- <span data-ttu-id="b6fbf-137">Los servicios no están estrechamente acoplados y pueden evolucionar independientemente.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-137">Services are not tightly coupled, and can evolve independently.</span></span>
- <span data-ttu-id="b6fbf-138">Los límites de servicio no causarán problemas con la coherencia de datos o la integridad.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-138">Your service boundaries will not create problems with data consistency or integrity.</span></span> <span data-ttu-id="b6fbf-139">A veces es importante mantener la coherencia de datos colocando la funcionalidad en un único microservicio.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-139">Sometimes it's important to maintain data consistency by putting functionality into a single microservice.</span></span> <span data-ttu-id="b6fbf-140">Dicho esto, considere si realmente necesita una fuerte coherencia.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-140">That said, consider whether you really need strong consistency.</span></span> <span data-ttu-id="b6fbf-141">Hay estrategias para resolver la coherencia final en un sistema distribuido, y las ventajas de descomponer servicios generalmente superan los desafíos que supone administrar la coherencia final.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-141">There are strategies for addressing eventual consistency in a distributed system, and the benefits of decomposing services often outweigh the challenges of managing eventual consistency.</span></span>

<span data-ttu-id="b6fbf-142">Sobre todo, es importante ser práctico y recordar que el diseño basado en dominio es un proceso iterativo.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-142">Above all, it's important to be pragmatic, and remember that domain-driven design is an iterative process.</span></span> <span data-ttu-id="b6fbf-143">En caso de duda, empiece con microservicios más generales.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-143">When in doubt, start with more coarse-grained microservices.</span></span> <span data-ttu-id="b6fbf-144">Dividir un microservicio en dos servicios más pequeños es más sencillo que la refactorización de funcionalidad entre varios microservicios existentes.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-144">Splitting a microservice into two smaller services is easier than refactoring functionality across several existing microservices.</span></span>
  
## <a name="drone-delivery-defining-the-microservices"></a><span data-ttu-id="b6fbf-145">Drone Delivery: definición de los microservicios</span><span class="sxs-lookup"><span data-stu-id="b6fbf-145">Drone Delivery: Defining the microservices</span></span>

<span data-ttu-id="b6fbf-146">Recuerde que el equipo de desarrollo había identificado los cuatro agregados &mdash;Delivery, Package, Drone, y Account&mdash; y dos servicios de dominio, Scheduler y Supervisor.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-146">Recall that the development team had identified the four aggregates &mdash; Delivery, Package, Drone, and Account &mdash; and two domain services, Scheduler and Supervisor.</span></span> 

<span data-ttu-id="b6fbf-147">Delivery y Package son candidatos obvios para los microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-147">Delivery and Package are obvious candidates for microservices.</span></span> <span data-ttu-id="b6fbf-148">Scheduler y Supervisor coordinan las actividades realizadas por otros microservicios, por lo que tiene sentido implementar estos servicios de dominio como microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-148">The Scheduler and Supervisor coordinate the activities performed by other microservices, so it makes sense to implement these domain services as microservices.</span></span>  

<span data-ttu-id="b6fbf-149">Drone y Account son interesantes porque pertenecen a otros contextos delimitados.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-149">Drone and Account are interesting because they belong to other bounded contexts.</span></span> <span data-ttu-id="b6fbf-150">Una opción es que Scheduler llame a los contextos delimitados Drone y Account directamente.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-150">One option is for the Scheduler to call the Drone and Account bounded contexts directly.</span></span> <span data-ttu-id="b6fbf-151">Otra opción es crear microservicios Drone y Account dentro del contexto delimitado Shipping.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-151">Another option is to create Drone and Account microservices inside the Shipping bounded context.</span></span> <span data-ttu-id="b6fbf-152">Estos microservicios mediarán entre los contextos delimitados a través de la exposición de las API o los esquemas de datos que son más adecuados para el contexto Shipping.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-152">These microservices would mediate between the bounded contexts, by exposing APIs or data schemas that are more suited to the Shipping context.</span></span>

<span data-ttu-id="b6fbf-153">Los detalles de los contextos delimitados Drone y Account quedan fuera del ámbito de esta guía, por lo que hemos creado servicios ficticios para ellos en nuestra implementación de referencia.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-153">The details of the Drone and Account bounded contexts are beyond the scope of this guidance, so we created mock services for them in our reference implementation.</span></span> <span data-ttu-id="b6fbf-154">Pero hay algunos factores a tener en cuenta en esta situación:</span><span class="sxs-lookup"><span data-stu-id="b6fbf-154">But here are some factors to consider in this situation:</span></span>

- <span data-ttu-id="b6fbf-155">¿Cuál es la sobrecarga de la red al llamar directamente al otro contexto delimitado?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-155">What is the network overhead of calling directly into the other bounded context?</span></span> 

- <span data-ttu-id="b6fbf-156">¿Es el esquema de datos para el otro contexto delimitado adecuado para este contexto, o es mejor tener un esquema que se adapte a este contexto delimitado?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-156">Is the data schema for the other bounded context suitable for this context, or is it better to have a schema that's tailored to this bounded context?</span></span> 

- <span data-ttu-id="b6fbf-157">¿Es el otro contexto delimitado un sistema heredado?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-157">Is the other bounded context a legacy system?</span></span> <span data-ttu-id="b6fbf-158">Si es así, podría crear un servicio que actúe como una [capa para evitar daños](../patterns/anti-corruption-layer.md) para traducir entre el sistema heredado y la aplicación moderna.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-158">If so, you might create a service that acts as an [anti-corruption layer](../patterns/anti-corruption-layer.md) to translate between the legacy system and the modern application.</span></span> 

- <span data-ttu-id="b6fbf-159">¿Cuál es la estructura del equipo?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-159">What is the team structure?</span></span> <span data-ttu-id="b6fbf-160">¿Es fácil comunicarse con el equipo que se encarga del otro contexto delimitado?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-160">Is it easy to communicate with the team that's responsible for the other bounded context?</span></span> <span data-ttu-id="b6fbf-161">De lo contrario, la creación de un servicio que medie entre los dos contextos puede ayudar a mitigar el costo de la comunicación entre equipos.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-161">If not, creating a service that mediates between the two contexts can help to mitigate the cost of cross-team communication.</span></span>

<span data-ttu-id="b6fbf-162">Hasta ahora, no hemos considerado ningún requisito no funcional.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-162">So far, we haven't considered any non-functional requirements.</span></span> <span data-ttu-id="b6fbf-163">Pensando en los requisitos de rendimiento de la aplicación, el equipo de desarrollo decidió crear un microservicio Ingestion independiente, que se encarga de la ingesta de las solicitudes de cliente.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-163">Thinking about the application's throughput requirements, the development team decided to create a separate Ingestion microservice that is responsible for ingesting client requests.</span></span> <span data-ttu-id="b6fbf-164">Este microservicio implementará la [redistribución de la carga](../patterns/queue-based-load-leveling.md) colocando las solicitudes entrantes en un búfer para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-164">This microservice will implement [load leveling](../patterns/queue-based-load-leveling.md) by putting incoming requests into a buffer for processing.</span></span> <span data-ttu-id="b6fbf-165">Scheduler leerá las solicitudes desde el búfer y ejecutará el flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-165">The Scheduler will read the requests from the buffer and execute the workflow.</span></span> 

<span data-ttu-id="b6fbf-166">Los requisitos no funcionales llevaron al equipo a crear un servicio adicional.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-166">Non-functional requirements led the team to create one additional service.</span></span> <span data-ttu-id="b6fbf-167">Todos los servicios hasta ahora se han dedicado al proceso de programación y entrega de paquetes en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-167">All of the services so far have been about the process of scheduling and delivering packages in real time.</span></span> <span data-ttu-id="b6fbf-168">Pero el sistema también necesita almacenar el historial de cada entrega en un almacenamiento a largo plazo para el análisis de datos.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-168">But the system also needs to store the history of every delivery in long-term storage for data analysis.</span></span> <span data-ttu-id="b6fbf-169">El equipo consideró hacer que esto fuera responsabilidad del servicio Delivery.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-169">The team considered making this the responsibility of the Delivery service.</span></span> <span data-ttu-id="b6fbf-170">Sin embargo, los requisitos de almacenamiento de datos para el análisis histórico son muy distintos a los de las operaciones en vuelo (consulte [Consideraciones de datos](./data-considerations.md)).</span><span class="sxs-lookup"><span data-stu-id="b6fbf-170">However, the data storage requirements are quite different for historical analysis versus in-flight operations (see [Data considerations](./data-considerations.md)).</span></span> <span data-ttu-id="b6fbf-171">Por lo tanto, el equipo decidió crear un servicio Delivery History independiente que realizará escuchas de eventos DeliveryTracking del servicio Delivery, y escribirá los eventos en un almacenamiento a largo plazo.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-171">Therefore, the team decided to create a separate Delivery History service, which will listen for DeliveryTracking events from the Delivery service and write the events into long-term storage.</span></span>

<span data-ttu-id="b6fbf-172">En el siguiente diagrama se muestra el proceso en este punto:</span><span class="sxs-lookup"><span data-stu-id="b6fbf-172">The following diagram shows the design at this point:</span></span>
 
![](./images/microservices.png)

## <a name="choosing-a-compute-option"></a><span data-ttu-id="b6fbf-173">Selección de una opción de proceso</span><span class="sxs-lookup"><span data-stu-id="b6fbf-173">Choosing a compute option</span></span>

<span data-ttu-id="b6fbf-174">El término *proceso* hace referencia al modelo de hospedaje para los recursos informáticos donde se ejecutan las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-174">The term *compute* refers to the hosting model for the computing resources that your application runs on.</span></span> <span data-ttu-id="b6fbf-175">Para una arquitectura de microservicios, hay dos enfoques especialmente populares:</span><span class="sxs-lookup"><span data-stu-id="b6fbf-175">For a microservices architecture, two approaches are especially popular:</span></span>

- <span data-ttu-id="b6fbf-176">Un orquestador de servicios que administra los servicios que se ejecutan en nodos dedicados (máquinas virtuales).</span><span class="sxs-lookup"><span data-stu-id="b6fbf-176">A service orchestrator that manages services running on dedicated nodes (VMs).</span></span>
- <span data-ttu-id="b6fbf-177">Una arquitectura sin servidor mediante funciones como un servicio (FaaS).</span><span class="sxs-lookup"><span data-stu-id="b6fbf-177">A serverless architecture using functions as a service (FaaS).</span></span> 

<span data-ttu-id="b6fbf-178">Aunque estas no son las únicas opciones, ambas son métodos probados para generar microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-178">While these aren't the only options, they are both proven approaches to building microservices.</span></span> <span data-ttu-id="b6fbf-179">Una aplicación puede incluir ambos enfoques.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-179">An application might include both approaches.</span></span>

### <a name="service-orchestrators"></a><span data-ttu-id="b6fbf-180">Orquestadores de servicios</span><span class="sxs-lookup"><span data-stu-id="b6fbf-180">Service orchestrators</span></span>

<span data-ttu-id="b6fbf-181">Un orquestador controla las tareas relacionadas con la implementación y administración de un conjunto de servicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-181">An orchestrator handles tasks related to deploying and managing a set of services.</span></span> <span data-ttu-id="b6fbf-182">Estas tareas incluyen colocar servicios en los nodos, supervisar el estado de los servicios, reiniciar los servicios en mal estado, equilibrar la carga del tráfico de red en todas las instancias de servicio, detectar servicios, escalar el número de instancias de un servicio y aplicar actualizaciones de configuración.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-182">These tasks include placing services on nodes, monitoring the health of services, restarting unhealthy services, load balancing network traffic across service instances, service discovery, scaling the number of instances of a service, and applying configuration updates.</span></span> <span data-ttu-id="b6fbf-183">Entre los orquestadores más populares se encuentran Kubernetes, DC/OS, Docker Swarm y Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-183">Popular orchestrators include Kubernetes, DC/OS, Docker Swarm, and Service Fabric.</span></span> 

- <span data-ttu-id="b6fbf-184">[Azure Container Service](/azure/container-service/) (ACS) es un servicio de Azure que le permite implementar un clúster de Kubernetes, DC/OS o Docker Swarm listo para producción.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-184">[Azure Container Service](/azure/container-service/) (ACS) is an Azure service that lets you deploy a production-ready Kubernetes, DC/OS, or Docker Swarm cluster.</span></span>

- <span data-ttu-id="b6fbf-185">[AKS (Azure Container Service)](/azure/aks/) es un servicio administrado de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-185">[AKS (Azure Container Service)](/azure/aks/) is a managed Kubernetes service.</span></span> <span data-ttu-id="b6fbf-186">AKS aprovisiona Kubernetes y expone los puntos de conexión de la API de Kubernetes, pero hospeda y administra el plano de control de Kubernetes, realizando actualizaciones automatizadas, correcciones automatizadas, autoescala y otras tareas de administración.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-186">AKS provisions Kubernetes and exposes the Kubernetes API endpoints, but hosts and manages the Kubernetes control plane, performing automated upgrades, automated patching, autoscaling, and other management tasks.</span></span> <span data-ttu-id="b6fbf-187">Se puede considerar AKS como "API de Kubernetes como servicio".</span><span class="sxs-lookup"><span data-stu-id="b6fbf-187">You can think of AKS as being "Kubernetes APIs as a service."</span></span> <span data-ttu-id="b6fbf-188">En el momento de redactar este texto, AKS sigue aún en versión preliminar.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-188">At the time of writing, AKS is still in preview.</span></span> <span data-ttu-id="b6fbf-189">De todas formas, se espera que AKS se convertirá en la mejor manera de ejecutar Kubernetes en Azure.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-189">However, it's expected that AKS will become the preferred way to run Kubernetes in Azure.</span></span> 

- <span data-ttu-id="b6fbf-190">[Service Fabric](/azure/service-fabric/) es una plataforma de sistemas distribuidos para empaquetar, implementar y administrar microservicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-190">[Service Fabric](/azure/service-fabric/) is a distributed systems platform for packaging, deploying, and managing microservices.</span></span> <span data-ttu-id="b6fbf-191">Los microservicios pueden implementarse en Service Fabric como contenedores, como archivos ejecutables binarios o como [Reliable Services](/azure/service-fabric/service-fabric-reliable-services-introduction).</span><span class="sxs-lookup"><span data-stu-id="b6fbf-191">Microservices can be deployed to Service Fabric as containers, as binary executables, or as [Reliable Services](/azure/service-fabric/service-fabric-reliable-services-introduction).</span></span> <span data-ttu-id="b6fbf-192">Usando el modelo de programación de Reliable Services, los servicios pueden utilizar directamente las API de programación de Service Fabric para consultar el sistema, informar del estado, recibir notificaciones acerca de la configuración y los cambios de código y detectar otros servicios.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-192">Using the Reliable Services programming model, services can directly use Service Fabric programming APIs to query the system, report health, receive notifications about configuration and code changes, and discover other services.</span></span> <span data-ttu-id="b6fbf-193">Una diferencia clave con Service Fabric es el enfoque prioritario dado a la creación de servicios con estado mediante [Reliable Collections](/azure/service-fabric/service-fabric-reliable-services-reliable-collections).</span><span class="sxs-lookup"><span data-stu-id="b6fbf-193">A key differentiation with Service Fabric is its strong focus on building stateful services using [Reliable Collections](/azure/service-fabric/service-fabric-reliable-services-reliable-collections).</span></span>

### <a name="containers"></a><span data-ttu-id="b6fbf-194">Contenedores</span><span class="sxs-lookup"><span data-stu-id="b6fbf-194">Containers</span></span>

<span data-ttu-id="b6fbf-195">A veces se habla de contenedores y microservicios como si fueran lo mismo.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-195">Sometimes people talk about containers and microservices as if they were the same thing.</span></span> <span data-ttu-id="b6fbf-196">Aunque esto no es cierto (los contenedores no son necesarios para generar microservicios), los contenedores tienen algunas de las ventajas que son especialmente apropiadas para los microservicios, como:</span><span class="sxs-lookup"><span data-stu-id="b6fbf-196">While that's not true &mdash; you don't need containers to build microservices &mdash; containers do have some benefits that are particularly relevant to microservices, such as:</span></span>

- <span data-ttu-id="b6fbf-197">**Portabilidad**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-197">**Portability**.</span></span> <span data-ttu-id="b6fbf-198">Una imagen de contenedor es un paquete independiente que se ejecuta sin necesidad de instalar las bibliotecas u otras dependencias.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-198">A container image is a standalone package that runs without needing to install libraries or other dependencies.</span></span> <span data-ttu-id="b6fbf-199">Esto hace que sean fáciles de implementar.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-199">That makes them easy to deploy.</span></span> <span data-ttu-id="b6fbf-200">Los contenedores pueden iniciarse y detenerse rápidamente, por lo que puede poner en marcha nuevas instancias para controlar más carga o para recuperarse de errores de nodo.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-200">Containers can be started and stopped quickly, so you can spin up new instances to handle more load or to recover from node failures.</span></span> 

- <span data-ttu-id="b6fbf-201">**Densidad**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-201">**Density**.</span></span> <span data-ttu-id="b6fbf-202">Los contenedores son ligeros en comparación con la ejecución de una máquina virtual, ya que comparten recursos de sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-202">Containers are lightweight compared with running a virtual machine, because they share OS resources.</span></span> <span data-ttu-id="b6fbf-203">Esto permite empaquetar varios contenedores en un nodo único, lo que es especialmente útil cuando la aplicación consta de muchos servicios pequeños.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-203">That makes it possible to pack multiple containers onto a single node, which is especially useful when the application consists of many small services.</span></span>

- <span data-ttu-id="b6fbf-204">**Aislamiento de recursos**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-204">**Resource isolation**.</span></span> <span data-ttu-id="b6fbf-205">Puede limitar la cantidad de memoria y CPU que están disponibles para un contenedor, lo que puede ayudar a garantizar que un proceso descontrolado no agotará los recursos del host.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-205">You can limit the amount of memory and CPU that is available to a container, which can help to ensure that a runaway process doesn't exhaust the host resources.</span></span> <span data-ttu-id="b6fbf-206">Consulte el [patrón Bulkhead](../patterns/bulkhead.md) para más información.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-206">See the [Bulkhead Pattern](../patterns/bulkhead.md) for more information.</span></span>

### <a name="serverless-functions-as-a-service"></a><span data-ttu-id="b6fbf-207">Arquitectura sin servidor (funciones como un servicio)</span><span class="sxs-lookup"><span data-stu-id="b6fbf-207">Serverless (Functions as a Service)</span></span>

<span data-ttu-id="b6fbf-208">Con una arquitectura sin servidor, no se administran las máquinas virtuales ni la infraestructura de red virtual.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-208">With a serverless architecture, you don't manage the VMs or the virtual network infrastructure.</span></span> <span data-ttu-id="b6fbf-209">En su lugar, se implementa código y el servicio de hospedaje controla la colocación de ese código en una máquina virtual y lo ejecuta.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-209">Instead, you deploy code and the hosting service handles putting that code onto a VM and executing it.</span></span> <span data-ttu-id="b6fbf-210">Este enfoque tiende a favorecer a las pequeñas funciones pormenorizadas que se coordinan mediante el uso de los desencadenadores basados en eventos.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-210">This approach tends to favor small granular functions that are coordinated using event-based triggers.</span></span> <span data-ttu-id="b6fbf-211">Por ejemplo, un mensaje que se colocan en una cola puede desencadenar una función que lee de la cola y procesa el mensaje.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-211">For example, a message being placed onto a queue might trigger a function that reads from the queue and processes the message.</span></span>

<span data-ttu-id="b6fbf-212">[Azure Functions][functions] es un servicio de proceso sin servidor que admite varios desencadenadores de función, incluidas las solicitudes HTTP, las colas de Service Bus y los eventos de Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-212">[Azure Functions][functions] is a serverless compute service that supports various function triggers, including HTTP requests, Service Bus queues, and Event Hubs events.</span></span> <span data-ttu-id="b6fbf-213">Si desea una lista completa consulte [Conceptos básicos sobre los enlaces y desencadenadores de Azure Functions][functions-triggers].</span><span class="sxs-lookup"><span data-stu-id="b6fbf-213">For a complete list, see [Azure Functions triggers and bindings concepts][functions-triggers].</span></span> <span data-ttu-id="b6fbf-214">Tenga en cuenta también a [Azure Event Grid][event-grid], que es un servicio de enrutamiento de evento administrado de Azure.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-214">Also consider [Azure Event Grid][event-grid], which is a managed event routing service in Azure.</span></span>

### <a name="orchestrator-or-serverless"></a><span data-ttu-id="b6fbf-215">¿Orquestador o sin servidor?</span><span class="sxs-lookup"><span data-stu-id="b6fbf-215">Orchestrator or serverless?</span></span>

<span data-ttu-id="b6fbf-216">Estos son algunos de los factores a considerar a la hora de elegir entre un enfoque con orquestador y un enfoque sin servidor.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-216">Here are some factors to consider when choosing between an orchestrator approach and a serverless approach.</span></span>

<span data-ttu-id="b6fbf-217">**Capacidad de administración** una aplicación sin servidor es fácil de administrar, porque la plataforma administra todos los recursos de proceso.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-217">**Manageability** A serverless application is easy to manage, because the platform manages all the of compute resources for you.</span></span> <span data-ttu-id="b6fbf-218">Un orquestador aunque abstrae algunos aspectos de la administración y la configuración de un clúster, no oculta por completo las máquinas virtuales subyacentes.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-218">While an orchestrator abstracts some aspects of managing and configuring a cluster, it does not completely hide the underlying VMs.</span></span> <span data-ttu-id="b6fbf-219">Con un orquestador, tendrá que pensar en problemas, como el equilibrio de carga, uso de CPU y memoria y funciones de red.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-219">With an orchestrator, you will need to think about issues such as load balancing, CPU and memory usage, and networking.</span></span>

<span data-ttu-id="b6fbf-220">**Flexibilidad y control**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-220">**Flexibility and control**.</span></span> <span data-ttu-id="b6fbf-221">Un orquestador le ofrece un gran control sobre la configuración y administración de los servicios y del clúster.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-221">An orchestrator gives you a great deal of control over configuring and managing your services and the cluster.</span></span> <span data-ttu-id="b6fbf-222">Como contrapartida tiene una complejidad adicional.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-222">The tradeoff is additional complexity.</span></span> <span data-ttu-id="b6fbf-223">Con una arquitectura sin servidor, se renuncia a un cierto grado de control porque se extraen estos detalles.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-223">With a serverless architecture, you give up some degree of control because these details are abstracted.</span></span>

<span data-ttu-id="b6fbf-224">**Portabilidad**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-224">**Portability**.</span></span> <span data-ttu-id="b6fbf-225">Todos los orquestadores enumerados aquí (Kubernetes, DC/OS, Docker Swarm y Service Fabric) se pueden ejecutar de forma local o en varias nubes públicas.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-225">All of the orchestrators listed here (Kubernetes, DC/OS, Docker Swarm, and Service Fabric) can run on-premises or in multiple public clouds.</span></span> 

<span data-ttu-id="b6fbf-226">**Integración de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-226">**Application integration**.</span></span> <span data-ttu-id="b6fbf-227">Puede resultar complicado crear una aplicación compleja con una arquitectura sin servidor.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-227">It can be challenging to build a complex application using a serverless architecture.</span></span> <span data-ttu-id="b6fbf-228">Una opción en Azure consiste en usar [Azure Logic Apps](/azure/logic-apps/) para coordinar un conjunto de Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-228">One option in Azure is to use [Azure Logic Apps](/azure/logic-apps/) to coordinate a set of Azure Functions.</span></span> <span data-ttu-id="b6fbf-229">Para encontrar un ejemplo de este enfoque, consulte [Creación de una función que se integre con Azure Logic Apps](/azure/azure-functions/functions-twitter-email).</span><span class="sxs-lookup"><span data-stu-id="b6fbf-229">For an example of this approach, see [Create a function that integrates with Azure Logic Apps](/azure/azure-functions/functions-twitter-email).</span></span>

<span data-ttu-id="b6fbf-230">**Costo**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-230">**Cost**.</span></span> <span data-ttu-id="b6fbf-231">Con un orquestador, se paga por las máquinas virtuales que se ejecutan en el clúster.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-231">With an orchestrator, you pay for the VMs that are running in the cluster.</span></span> <span data-ttu-id="b6fbf-232">Con una aplicación sin servidor, solo se paga por el consumo real de los recursos de proceso.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-232">With a serverless application, you pay only for the actual compute resources consumed.</span></span> <span data-ttu-id="b6fbf-233">En ambos casos, debe tener en cuenta el costo de los servicios adicionales, como almacenamiento, bases de datos y servicios de mensajería.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-233">In both cases, you need to factor in the cost of any additional services, such as storage, databases, and messaging services.</span></span>

<span data-ttu-id="b6fbf-234">**Escalabilidad**.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-234">**Scalability**.</span></span> <span data-ttu-id="b6fbf-235">Azure Functions se escala automáticamente para satisfacer la demanda en función del número de eventos de entrada.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-235">Azure Functions scales automatically to meet demand, based on the number of incoming events.</span></span> <span data-ttu-id="b6fbf-236">Con un orquestador, puede escalar horizontalmente aumentando el número de instancias de servicio que se ejecutan en el clúster.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-236">With an orchestrator, you can scale out by increasing the number of service instances running in the cluster.</span></span> <span data-ttu-id="b6fbf-237">También puede escalar agregando máquinas virtuales adicionales al clúster.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-237">You can also scale by adding additional VMs to the cluster.</span></span>

<span data-ttu-id="b6fbf-238">Nuestra implementación de referencia, usa principalmente Kubernetes, pero hemos usado Azure Functions para un servicio: el servicio Delivery History.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-238">Our reference implementation primarily uses Kubernetes, but we did use Azure Functions for one service, namely the Delivery History service.</span></span> <span data-ttu-id="b6fbf-239">Azure Functions era una buena opción para este servicio en concreto porque es una carga de trabajo basada en eventos.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-239">Azure Functions was a good fit for this particular service, because it's is an event-driven workload.</span></span> <span data-ttu-id="b6fbf-240">Mediante el uso de un desencadenador de Event Hubs para invocar la función, el servicio necesitó una cantidad mínima de código.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-240">By using an Event Hubs trigger to invoke the function, the service needed a minimal amount of code.</span></span> <span data-ttu-id="b6fbf-241">Además, el servicio Delivery History no forma parte del flujo de trabajo principal, por lo que ejecutarlo fuera del clúster Kubernetes no afecta a la latencia de un extremo a otro de las operaciones iniciadas por el usuario.</span><span class="sxs-lookup"><span data-stu-id="b6fbf-241">Also, the Delivery History service is not part of the main workflow, so running it outside of the Kubernetes cluster doesn't affect the end-to-end latency of user-initiated operations.</span></span> 

> [!div class="nextstepaction"]
> [<span data-ttu-id="b6fbf-242">Consideraciones sobre los datos</span><span class="sxs-lookup"><span data-stu-id="b6fbf-242">Data considerations</span></span>](./data-considerations.md)

<!-- links -->

[acs-engine]: https://github.com/Azure/acs-engine
[acs-faq]: /azure/container-service/dcos-swarm/container-service-faq
[event-grid]: /azure/event-grid/
[functions]: /azure/azure-functions/functions-overview
[functions-triggers]: /azure/azure-functions/functions-triggers-bindings
