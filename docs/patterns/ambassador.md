---
title: "Patrón Ambassador"
description: "Crea servicios de aplicaciones auxiliares que envíen solicitudes de red en nombre de una aplicación o servicio de consumidor."
author: dragon119
ms.date: 06/23/2017
ms.openlocfilehash: 6c545619aab6a5817e55854350e3769834df27cd
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/14/2017
---
# <a name="ambassador-pattern"></a><span data-ttu-id="62f82-103">Patrón Ambassador</span><span class="sxs-lookup"><span data-stu-id="62f82-103">Ambassador pattern</span></span>

<span data-ttu-id="62f82-104">Crea servicios de aplicaciones auxiliares que envíen solicitudes de red en nombre de una aplicación o servicio de consumidor.</span><span class="sxs-lookup"><span data-stu-id="62f82-104">Create helper services that send network requests on behalf of a consumer service or application.</span></span> <span data-ttu-id="62f82-105">Un servicio de Ambassador puede considerarse como un proxy fuera de proceso que coexiste con el cliente.</span><span class="sxs-lookup"><span data-stu-id="62f82-105">An ambassador service can be thought of as an out-of-process proxy that is co-located with the client.</span></span>

<span data-ttu-id="62f82-106">Este patrón puede ser útil para la descarga de tareas comunes de conectividad de cliente, como la supervisión, el registro, el enrutamiento, la seguridad (por ejemplo, TLS) y los [patrones de resistencia][resiliency-patterns] de una manera independiente del lenguaje.</span><span class="sxs-lookup"><span data-stu-id="62f82-106">This pattern can be useful for offloading common client connectivity tasks such as monitoring, logging, routing, security (such as TLS), and [resiliency patterns][resiliency-patterns] in a language agnostic way.</span></span> <span data-ttu-id="62f82-107">A menudo se utiliza con aplicaciones heredadas, u otras aplicaciones que son difíciles de modificar, con el fin de ampliar sus capacidades de red.</span><span class="sxs-lookup"><span data-stu-id="62f82-107">It is often used with legacy applications, or other applications that are difficult to modify, in order to extend their networking capabilities.</span></span> <span data-ttu-id="62f82-108">También puede habilitar un equipo especializado para implementar esas características.</span><span class="sxs-lookup"><span data-stu-id="62f82-108">It can also enable a specialized team to implement those features.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="62f82-109">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="62f82-109">Context and problem</span></span>

<span data-ttu-id="62f82-110">Las aplicaciones resistentes basadas en la nube requieren características como [la aplicación de Circuit Breaker][circuit-breaker], el enrutamiento, la medición y la supervisión, así como la capacidad de aplicar actualizaciones de configuración relacionadas con la red.</span><span class="sxs-lookup"><span data-stu-id="62f82-110">Resilient cloud-based applications require features such as [circuit breaking][circuit-breaker], routing, metering and monitoring, and the ability to make network-related configuration updates.</span></span> <span data-ttu-id="62f82-111">Puede resultar difícil o imposible actualizar aplicaciones heredadas o bibliotecas de código existente para agregar estas características, porque el código ya no se mantiene o no se puede modificar con facilidad por el equipo de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="62f82-111">It may be difficult or impossible to update legacy applications or existing code libraries to add these features, because the code is no longer maintained or can't be easily modified by the development team.</span></span>

<span data-ttu-id="62f82-112">Las llamadas de red también pueden requerir una configuración considerable para la conexión, la autenticación y la autorización.</span><span class="sxs-lookup"><span data-stu-id="62f82-112">Network calls may also require substantial configuration for connection, authentication, and authorization.</span></span> <span data-ttu-id="62f82-113">Si estas llamadas se usan en varias aplicaciones, compiladas con varios lenguajes y marcos de trabajo, deben configurarse para cada una de estas instancias.</span><span class="sxs-lookup"><span data-stu-id="62f82-113">If these calls are used across multiple applications, built using multiple languages and frameworks, the calls must be configured for each of these instances.</span></span> <span data-ttu-id="62f82-114">Además, es posible que la funcionalidad de red y seguridad tenga que administrarse por un equipo central dentro de su organización.</span><span class="sxs-lookup"><span data-stu-id="62f82-114">In addition, network and security functionality may need to be managed by a central team within your organization.</span></span> <span data-ttu-id="62f82-115">Con una base de código de gran tamaño, puede ser peligroso para ese equipo actualizar el código de la aplicación con el que no esté familiarizado.</span><span class="sxs-lookup"><span data-stu-id="62f82-115">With a large code base, it can be risky for that team to update application code they aren't familiar with.</span></span>

## <a name="solution"></a><span data-ttu-id="62f82-116">Solución</span><span class="sxs-lookup"><span data-stu-id="62f82-116">Solution</span></span>

<span data-ttu-id="62f82-117">Coloque marcos y bibliotecas de cliente en un proceso externo que actúe como un proxy entre la aplicación y los servicios externos.</span><span class="sxs-lookup"><span data-stu-id="62f82-117">Put client frameworks and libraries into an external process that acts as a proxy between your application and external services.</span></span> <span data-ttu-id="62f82-118">Implemente el proxy en el mismo entorno de host que la aplicación para permitir el control sobre el enrutamiento, la resistencia y las características de seguridad y para evitar las restricciones de acceso relacionadas con el host.</span><span class="sxs-lookup"><span data-stu-id="62f82-118">Deploy the proxy on the same host environment as your application to allow control over routing, resiliency, security features, and to avoid any host-related access restrictions.</span></span> <span data-ttu-id="62f82-119">También puede usar el patrón Ambassador para normalizar y ampliar la instrumentación.</span><span class="sxs-lookup"><span data-stu-id="62f82-119">You can also use the ambassador pattern to standardize and extend instrumentation.</span></span> <span data-ttu-id="62f82-120">El proxy puede supervisar las métricas de rendimiento como la latencia o el uso de recursos, y esta supervisión se produce en el mismo entorno de host que la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62f82-120">The proxy can monitor performance metrics such as latency or resource usage, and this monitoring happens in the same host environment as the application.</span></span>

![](./_images/ambassador.png)

<span data-ttu-id="62f82-121">Las características que se descargan en Ambassador pueden administrarse independientemente de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62f82-121">Features that are offloaded to the ambassador can be managed independently of the application.</span></span> <span data-ttu-id="62f82-122">Puede actualizar y modificar Ambassador sin tener que tocar la funcionalidad heredada de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62f82-122">You can update and modify the ambassador without disturbing the application's legacy functionality.</span></span> <span data-ttu-id="62f82-123">También permite que los equipos independientes y especializados implementen y mantengan las características de seguridad, redes o autenticación que se han movido a Ambassador.</span><span class="sxs-lookup"><span data-stu-id="62f82-123">It also allows for separate, specialized teams to implement and maintain security, networking, or authentication features that have been moved to the ambassador.</span></span>

<span data-ttu-id="62f82-124">Los servicios de Ambassador pueden implementarse como [Sidecar][sidecar] para acompañar el ciclo de vida de una aplicación o servicio que lo utiliza.</span><span class="sxs-lookup"><span data-stu-id="62f82-124">Ambassador services can be deployed as a [sidecar][sidecar] to accompany the lifecycle of a consuming application or service.</span></span> <span data-ttu-id="62f82-125">O bien, si se comparte un Ambassador mediante varios procesos independientes en un host común, puede implementarse como un demonio o un servicio de Windows.</span><span class="sxs-lookup"><span data-stu-id="62f82-125">Alternatively, if an ambassador is shared by multiple separate processes on a common host, it can be deployed as a daemon or Windows service.</span></span> <span data-ttu-id="62f82-126">Si el servicio que lo utiliza está en contenedores, el Ambassador debe crearse como un contenedor independiente en el mismo host, con los vínculos correspondientes configurados para la comunicación.</span><span class="sxs-lookup"><span data-stu-id="62f82-126">If the consuming service is containerized, the ambassador should be created as a separate container on the same host, with the appropriate links configured for communication.</span></span>

## <a name="issues-and-considerations"></a><span data-ttu-id="62f82-127">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="62f82-127">Issues and considerations</span></span>

- <span data-ttu-id="62f82-128">El proxy agrega cierta sobrecarga de latencia.</span><span class="sxs-lookup"><span data-stu-id="62f82-128">The proxy adds some latency overhead.</span></span> <span data-ttu-id="62f82-129">Considere si una biblioteca de cliente, que se invoca directamente por la aplicación, es un enfoque más adecuado.</span><span class="sxs-lookup"><span data-stu-id="62f82-129">Consider whether a client library, invoked directly by the application, is a better approach.</span></span>
- <span data-ttu-id="62f82-130">Tenga en cuenta los posibles efectos de incluir características generalizadas en el proxy.</span><span class="sxs-lookup"><span data-stu-id="62f82-130">Consider the possible impact of including generalized features in the proxy.</span></span> <span data-ttu-id="62f82-131">Por ejemplo, Ambassador podría controlar los reintentos, pero esto podría no ser seguro (a menos que todas las operaciones sean idempotentes).</span><span class="sxs-lookup"><span data-stu-id="62f82-131">For example, the ambassador could handle retries, but that might not be safe unless all operations are idempotent.</span></span>
- <span data-ttu-id="62f82-132">Considere la posibilidad de usar un mecanismo para permitir que el cliente pase algún contexto al proxy, y también que lo devuelva al cliente.</span><span class="sxs-lookup"><span data-stu-id="62f82-132">Consider a mechanism to allow the client to pass some context to the proxy, as well as back to the client.</span></span> <span data-ttu-id="62f82-133">Por ejemplo, incluya encabezados de solicitud HTTP para no participar en el reintento o especificar el número máximo de reintentos.</span><span class="sxs-lookup"><span data-stu-id="62f82-133">For example, include HTTP request headers to opt out of retry or specify the maximum number of times to retry.</span></span>
- <span data-ttu-id="62f82-134">Piense en cómo empaquetará e implementará el proxy.</span><span class="sxs-lookup"><span data-stu-id="62f82-134">Consider how you will package and deploy the proxy.</span></span>
- <span data-ttu-id="62f82-135">Piense si va a utilizar una sola instancia compartida para todos los clientes o bien una instancia para cada cliente.</span><span class="sxs-lookup"><span data-stu-id="62f82-135">Consider whether to use a single shared instance for all clients or an instance for each client.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="62f82-136">Cuándo usar este patrón</span><span class="sxs-lookup"><span data-stu-id="62f82-136">When to use this pattern</span></span>

<span data-ttu-id="62f82-137">Use este patrón cuando:</span><span class="sxs-lookup"><span data-stu-id="62f82-137">Use this pattern when you:</span></span>

- <span data-ttu-id="62f82-138">Tenga que crear un conjunto común de características de conectividad de cliente en varios lenguajes o marcos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="62f82-138">Need to build a common set of client connectivity features for multiple languages or frameworks.</span></span>
- <span data-ttu-id="62f82-139">Tenga que descargar los problemas de conectividad de cliente transversales en los desarrolladores de infraestructura u otros equipos más especializados.</span><span class="sxs-lookup"><span data-stu-id="62f82-139">Need to offload cross-cutting client connectivity concerns to infrastructure developers or other more specialized teams.</span></span>
- <span data-ttu-id="62f82-140">Tenga que admitir los requisitos de conectividad del clúster o la nube en una aplicación heredada o una aplicación que sea difícil de modificar.</span><span class="sxs-lookup"><span data-stu-id="62f82-140">Need to support cloud or cluster connectivity requirements in a legacy application or an application that is difficult to modify.</span></span>

<span data-ttu-id="62f82-141">Este patrón puede no ser adecuado:</span><span class="sxs-lookup"><span data-stu-id="62f82-141">This pattern may not be suitable:</span></span>

- <span data-ttu-id="62f82-142">Cuando la latencia de solicitud de red es fundamental.</span><span class="sxs-lookup"><span data-stu-id="62f82-142">When network request latency is critical.</span></span> <span data-ttu-id="62f82-143">Un proxy introducirá cierta sobrecarga, aunque mínima, y en algunos casos esto puede afectar a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62f82-143">A proxy will introduce some overhead, although minimal, and in some cases this may affect the application.</span></span>
- <span data-ttu-id="62f82-144">Cuando se usan características de conectividad de cliente por un solo lenguaje.</span><span class="sxs-lookup"><span data-stu-id="62f82-144">When client connectivity features are consumed by a single language.</span></span> <span data-ttu-id="62f82-145">En ese caso, una mejor opción podría ser una biblioteca de cliente que se distribuya a los equipos de desarrollo como un paquete.</span><span class="sxs-lookup"><span data-stu-id="62f82-145">In that case, a better option might be a client library that is distributed to the development teams as a package.</span></span>
- <span data-ttu-id="62f82-146">Cuando las características de conectividad no se pueden generalizar y requieren una integración más profunda con la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="62f82-146">When connectivity features cannot be generalized and require deeper integration with the client application.</span></span>

## <a name="example"></a><span data-ttu-id="62f82-147">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="62f82-147">Example</span></span>

<span data-ttu-id="62f82-148">El siguiente diagrama muestra una aplicación que realiza una solicitud a un servicio remoto a través de un proxy de Ambassador.</span><span class="sxs-lookup"><span data-stu-id="62f82-148">The following diagram shows an application making a request to a remote service via an ambassador proxy.</span></span> <span data-ttu-id="62f82-149">Ambassador proporciona el enrutamiento, la interrupción del circuito y el registro.</span><span class="sxs-lookup"><span data-stu-id="62f82-149">The ambassador provides routing, circuit breaking, and logging.</span></span> <span data-ttu-id="62f82-150">Llama al servicio remoto y luego devuelve la respuesta a la aplicación cliente:</span><span class="sxs-lookup"><span data-stu-id="62f82-150">It calls the remote service and then returns the response to the client application:</span></span>

![](./_images/ambassador-example.png) 

## <a name="related-guidance"></a><span data-ttu-id="62f82-151">Instrucciones relacionadas</span><span class="sxs-lookup"><span data-stu-id="62f82-151">Related guidance</span></span>

- [<span data-ttu-id="62f82-152">Patrón Sidecar</span><span class="sxs-lookup"><span data-stu-id="62f82-152">Sidecar pattern</span></span>](./sidecar.md)

<!-- links -->

[circuit-breaker]: ./circuit-breaker.md
[resiliency-patterns]: ./category/resiliency.md
[sidecar]: ./sidecar.md
