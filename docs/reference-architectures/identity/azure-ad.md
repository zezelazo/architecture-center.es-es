---
title: Integración de dominios de AD locales con Azure Active Directory
titleSuffix: Azure Reference Architectures
description: Implemente una arquitectura de red híbrida segura con Azure Active Directory.
author: telmosampaio
ms.date: 11/28/2016
ms.custom: seodec18
ms.openlocfilehash: cab80adad91626d0e02a6d0a27de23a9dfc43769
ms.sourcegitcommit: 88a68c7e9b6b772172b7faa4b9fd9c061a9f7e9d
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/08/2018
ms.locfileid: "53120074"
---
# <a name="integrate-on-premises-active-directory-domains-with-azure-active-directory"></a><span data-ttu-id="49e1c-103">Integración de dominios locales de Active Directory con Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="49e1c-103">Integrate on-premises Active Directory domains with Azure Active Directory</span></span>

<span data-ttu-id="49e1c-104">Azure Active Directory (Azure AD) es un directorio multiinquilino basado en la nube y un servicio de identidades.</span><span class="sxs-lookup"><span data-stu-id="49e1c-104">Azure Active Directory (Azure AD) is a cloud based multi-tenant directory and identity service.</span></span> <span data-ttu-id="49e1c-105">Esta arquitectura de referencia muestra procedimientos recomendados para la integración de dominios de Active Directory locales con Azure AD a fin de proporcionar la autenticación de identidades basada en la nube.</span><span class="sxs-lookup"><span data-stu-id="49e1c-105">This reference architecture shows best practices for integrating on-premises Active Directory domains with Azure AD to provide cloud-based identity authentication.</span></span> <span data-ttu-id="49e1c-106">[**Implemente esta solución**](#deploy-the-solution).</span><span class="sxs-lookup"><span data-stu-id="49e1c-106">[**Deploy this solution**](#deploy-the-solution).</span></span>

![Arquitectura de identidad en la nube con Azure Active Directory](./images/azure-ad.png)

<span data-ttu-id="49e1c-108">*Descargue un [archivo Visio][visio-download] de esta arquitectura.*</span><span class="sxs-lookup"><span data-stu-id="49e1c-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="49e1c-109">Para simplificar, este diagrama solo muestra las conexiones relacionadas directamente con Azure AD y el tráfico no relacionado con el protocolo que se puede producir como parte de la federación de la identidad y la autenticación.</span><span class="sxs-lookup"><span data-stu-id="49e1c-109">For simplicity, this diagram only shows the connections directly related to Azure AD, and not protocol-related traffic that may occur as part of authentication and identity federation.</span></span> <span data-ttu-id="49e1c-110">Por ejemplo, una aplicación web puede redirigir el explorador web para autenticar la solicitud a través de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-110">For example, a web application may redirect the web browser to authenticate the request through Azure AD.</span></span> <span data-ttu-id="49e1c-111">Una vez autenticada, la solicitud puede pasarse a la aplicación web, con la información de identidad adecuada.</span><span class="sxs-lookup"><span data-stu-id="49e1c-111">Once authenticated, the request can be passed back to the web application, with the appropriate identity information.</span></span>
>

<span data-ttu-id="49e1c-112">Los usos habituales de esta arquitectura de referencia incluyen:</span><span class="sxs-lookup"><span data-stu-id="49e1c-112">Typical uses for this reference architecture include:</span></span>

- <span data-ttu-id="49e1c-113">Aplicaciones web implementadas en Azure que proporcionan acceso a los usuarios remotos que pertenecen a la organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-113">Web applications deployed in Azure that provide access to remote users who belong to your organization.</span></span>
- <span data-ttu-id="49e1c-114">La implementación de funcionalidades de autoservicio para usuarios finales, como restablecer sus contraseñas y delegar la administración de grupos.</span><span class="sxs-lookup"><span data-stu-id="49e1c-114">Implementing self-service capabilities for end-users, such as resetting their passwords, and delegating group management.</span></span> <span data-ttu-id="49e1c-115">Tenga en cuenta que esto requiere la edición Premium de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-115">Note that this requires Azure AD Premium edition.</span></span>
- <span data-ttu-id="49e1c-116">Arquitecturas en las que la red local y la red virtual de Azure de la aplicación no están conectadas mediante un túnel VPN o un circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="49e1c-116">Architectures in which the on-premises network and the application's Azure VNet are not connected using a VPN tunnel or ExpressRoute circuit.</span></span>

> [!NOTE]
> <span data-ttu-id="49e1c-117">Azure AD puede autenticar la identidad de usuarios y aplicaciones que existen en el directorio de una organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-117">Azure AD can authenticate the identity of users and applications that exist in an organization’s directory.</span></span> <span data-ttu-id="49e1c-118">Algunas aplicaciones y servicios, como SQL Server, pueden requerir la autenticación de equipo, en cuyo caso esta solución no es adecuada.</span><span class="sxs-lookup"><span data-stu-id="49e1c-118">Some applications and services, such as SQL Server, may require computer authentication, in which case this solution is not appropriate.</span></span>
>

<span data-ttu-id="49e1c-119">Para consideraciones adicionales, consulte [Selección de una solución para la integración de Active Directory local con Azure][considerations].</span><span class="sxs-lookup"><span data-stu-id="49e1c-119">For additional considerations, see [Choose a solution for integrating on-premises Active Directory with Azure][considerations].</span></span>

## <a name="architecture"></a><span data-ttu-id="49e1c-120">Arquitectura</span><span class="sxs-lookup"><span data-stu-id="49e1c-120">Architecture</span></span>

<span data-ttu-id="49e1c-121">La arquitectura tiene los siguientes componentes.</span><span class="sxs-lookup"><span data-stu-id="49e1c-121">The architecture has the following components.</span></span>

- <span data-ttu-id="49e1c-122">**Inquilino de Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-122">**Azure AD tenant**.</span></span> <span data-ttu-id="49e1c-123">Una instancia de [Azure AD][azure-active-directory] creada por su organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-123">An instance of [Azure AD][azure-active-directory] created by your organization.</span></span> <span data-ttu-id="49e1c-124">Actúa como un servicio de directorio de aplicaciones en la nube mediante el almacenamiento de objetos copiados desde la instancia local de Active Directory y proporciona servicios de identidad.</span><span class="sxs-lookup"><span data-stu-id="49e1c-124">It acts as a directory service for cloud applications by storing objects copied from the on-premises Active Directory and provides identity services.</span></span>
- <span data-ttu-id="49e1c-125">**Subred de nivel web**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-125">**Web tier subnet**.</span></span> <span data-ttu-id="49e1c-126">Esta subred contiene las máquinas virtuales que ejecutan una aplicación web.</span><span class="sxs-lookup"><span data-stu-id="49e1c-126">This subnet holds VMs that run a web application.</span></span> <span data-ttu-id="49e1c-127">Azure AD puede actuar como un intermediario de identidad para esta aplicación.</span><span class="sxs-lookup"><span data-stu-id="49e1c-127">Azure AD can act as an identity broker for this application.</span></span>
- <span data-ttu-id="49e1c-128">**Servidor local AD DS**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-128">**On-premises AD DS server**.</span></span> <span data-ttu-id="49e1c-129">Un servicio local de identidades y directorios.</span><span class="sxs-lookup"><span data-stu-id="49e1c-129">An on-premise directory and identity service.</span></span> <span data-ttu-id="49e1c-130">El directorio de AD DS se puede sincronizar con Azure AD para permitirle autenticar a los usuarios locales.</span><span class="sxs-lookup"><span data-stu-id="49e1c-130">The AD DS directory can be synchronized with Azure AD to enable it to authenticate on-premise users.</span></span>
- <span data-ttu-id="49e1c-131">**Servidor de Azure AD Connect Sync**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-131">**Azure AD Connect sync server**.</span></span> <span data-ttu-id="49e1c-132">Un equipo local que ejecuta el servicio de sincronización [Azure AD Connect][ azure-ad-connect].</span><span class="sxs-lookup"><span data-stu-id="49e1c-132">An on-premises computer that runs the [Azure AD Connect][azure-ad-connect] sync service.</span></span> <span data-ttu-id="49e1c-133">Este servicio sincroniza la información contenida en Active Directory local para Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-133">This service synchronizes information held in the on-premises Active Directory to Azure AD.</span></span> <span data-ttu-id="49e1c-134">Por ejemplo, si aprovisiona o desaprovisiona usuarios y grupos locales, estos cambios se propagan a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-134">For example, if you provision or deprovision groups and users on-premises, these changes propagate to Azure AD.</span></span>

  > [!NOTE]
  > <span data-ttu-id="49e1c-135">Por motivos de seguridad, Azure AD almacena las contraseñas de usuario como un valor hash.</span><span class="sxs-lookup"><span data-stu-id="49e1c-135">For security reasons, Azure AD stores user's passwords as a hash.</span></span> <span data-ttu-id="49e1c-136">Si un usuario requiere el restablecimiento de una contraseña, debe hacerse de forma local y el nuevo hash debe enviarse a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-136">If a user requires a password reset, this must be performed on-premises and the new hash must be sent to Azure AD.</span></span> <span data-ttu-id="49e1c-137">Las ediciones Premium de Azure AD incluyen características que pueden automatizar esta tarea para permitir a los usuarios restablecer sus propias contraseñas.</span><span class="sxs-lookup"><span data-stu-id="49e1c-137">Azure AD Premium editions include features that can automate this task to enable users to reset their own passwords.</span></span>
  >

- <span data-ttu-id="49e1c-138">**Máquinas virtuales para aplicación de N niveles**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-138">**VMs for N-tier application**.</span></span> <span data-ttu-id="49e1c-139">La implementación incluye la infraestructura para una aplicación con n niveles.</span><span class="sxs-lookup"><span data-stu-id="49e1c-139">The deployment includes infrastructure for an N-tier application.</span></span> <span data-ttu-id="49e1c-140">Para más información sobre estos recursos, consulte [Ejecución de máquinas virtuales Windows para una arquitectura de n niveles][implementing-a-multi-tier-architecture-on-Azure].</span><span class="sxs-lookup"><span data-stu-id="49e1c-140">For more information about these resources, see [Run VMs for an N-tier architecture][implementing-a-multi-tier-architecture-on-Azure].</span></span>

## <a name="recommendations"></a><span data-ttu-id="49e1c-141">Recomendaciones</span><span class="sxs-lookup"><span data-stu-id="49e1c-141">Recommendations</span></span>

<span data-ttu-id="49e1c-142">Las siguientes recomendaciones sirven para la mayoría de los escenarios.</span><span class="sxs-lookup"><span data-stu-id="49e1c-142">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="49e1c-143">Sígalas a menos que tenga un requisito concreto que las invalide.</span><span class="sxs-lookup"><span data-stu-id="49e1c-143">Follow these recommendations unless you have a specific requirement that overrides them.</span></span>

### <a name="azure-ad-connect-sync-service"></a><span data-ttu-id="49e1c-144">Cuenta del servicio de sincronización Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="49e1c-144">Azure AD Connect sync service</span></span>

<span data-ttu-id="49e1c-145">El servicio de sincronización de Azure AD Connect garantiza que la información de identidad almacenada en la nube sea coherente con la que se mantiene en local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-145">The Azure AD Connect sync service ensures that identity information stored in the cloud is consistent with that held on-premises.</span></span> <span data-ttu-id="49e1c-146">Este servicio se instala con el software de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="49e1c-146">You install this service using the Azure AD Connect software.</span></span>

<span data-ttu-id="49e1c-147">Antes de implementar la sincronización de Azure AD Connect, determine los requisitos de sincronización de la organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-147">Before implementing Azure AD Connect sync, determine the synchronization requirements of your organization.</span></span> <span data-ttu-id="49e1c-148">Por ejemplo, lo que se debe sincronizar, de qué dominios y con qué frecuencia.</span><span class="sxs-lookup"><span data-stu-id="49e1c-148">For example, what to synchronize, from which domains, and how frequently.</span></span> <span data-ttu-id="49e1c-149">Para más información, vea [Determinación de los requisitos de sincronización de directorios][aad-sync-requirements].</span><span class="sxs-lookup"><span data-stu-id="49e1c-149">For more information, see [Determine directory synchronization requirements][aad-sync-requirements].</span></span>

<span data-ttu-id="49e1c-150">Puede ejecutar el servicio de sincronización de Azure AD Connect en una máquina virtual o un equipo hospedado en local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-150">You can run the Azure AD Connect sync service on a VM or a computer hosted on-premises.</span></span> <span data-ttu-id="49e1c-151">Según la volatilidad de la información en el directorio de Active Directory, es probable que la carga en el servicio de sincronización de Azure AD Connect sea alta después de la sincronización inicial con Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-151">Depending on the volatility of the information in your Active Directory directory, the load on the Azure AD Connect sync service is unlikely to be high after the initial synchronization with Azure AD.</span></span> <span data-ttu-id="49e1c-152">La ejecución del servicio en una máquina virtual facilita escalar el servidor, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="49e1c-152">Running the service on a VM makes it easier to scale the server if needed.</span></span> <span data-ttu-id="49e1c-153">Supervise la actividad en la máquina virtual tal como se describe en la sección de consideraciones de supervisión, para determinar si el escalado es necesario.</span><span class="sxs-lookup"><span data-stu-id="49e1c-153">Monitor the activity on the VM as described in the Monitoring considerations section to determine whether scaling is necessary.</span></span>

<span data-ttu-id="49e1c-154">Si tiene varios dominios locales en un bosque, se recomienda almacenar y sincronizar la información para todo el bosque en un único inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-154">If you have multiple on-premises domains in a forest, we recommend storing and synchronizing information for the entire forest to a single Azure AD tenant.</span></span> <span data-ttu-id="49e1c-155">Filtre la información de identidades que se produce en más de un dominio, por lo que cada identidad aparece una sola vez en Azure AD, en lugar de duplicarse.</span><span class="sxs-lookup"><span data-stu-id="49e1c-155">Filter information for identities that occur in more than one domain, so that each identity appears only once in Azure AD, rather than being duplicated.</span></span> <span data-ttu-id="49e1c-156">La duplicación puede provocar incoherencias cuando se sincronizan los datos.</span><span class="sxs-lookup"><span data-stu-id="49e1c-156">Duplication can lead to inconsistencies when data is synchronized.</span></span> <span data-ttu-id="49e1c-157">Para más información, consulte la sección Topología, a continuación.</span><span class="sxs-lookup"><span data-stu-id="49e1c-157">For more information, see the Topology section below.</span></span>

<span data-ttu-id="49e1c-158">Use un filtro para que solo se almacenen en Azure AD los datos necesarios.</span><span class="sxs-lookup"><span data-stu-id="49e1c-158">Use filtering so that only necessary data is stored in Azure AD.</span></span> <span data-ttu-id="49e1c-159">Por ejemplo, a la organización podría no convenirle almacenar información sobre las cuentas inactivas en Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-159">For example, your organization might not want to store information about inactive accounts in Azure AD.</span></span> <span data-ttu-id="49e1c-160">El filtrado puede basarse en grupos, en dominios, en unidades organizativa (OU) o en atributos.</span><span class="sxs-lookup"><span data-stu-id="49e1c-160">Filtering can be group-based, domain-based, organization unit (OU)-based, or attribute-based.</span></span> <span data-ttu-id="49e1c-161">Puede combinar filtros para generar reglas más complejas.</span><span class="sxs-lookup"><span data-stu-id="49e1c-161">You can combine filters to generate more complex rules.</span></span> <span data-ttu-id="49e1c-162">Por ejemplo, puede sincronizar objetos que se encuentren en un dominio y que tengan un valor específico en un atributo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="49e1c-162">For example, you could synchronize objects held in a domain that have a specific value in a selected attribute.</span></span> <span data-ttu-id="49e1c-163">Para obtener información detallada, consulte [Sincronización de Azure AD Connect: configuración del filtrado][aad-filtering].</span><span class="sxs-lookup"><span data-stu-id="49e1c-163">For detailed information, see [Azure AD Connect sync: Configure Filtering][aad-filtering].</span></span>

<span data-ttu-id="49e1c-164">Para implementar la alta disponibilidad para el servicio de sincronización de AD Connect, ejecute un servidor provisional secundario.</span><span class="sxs-lookup"><span data-stu-id="49e1c-164">To implement high availability for the AD Connect sync service, run a secondary staging server.</span></span> <span data-ttu-id="49e1c-165">Para más información, consulte la sección Recomendaciones de topología.</span><span class="sxs-lookup"><span data-stu-id="49e1c-165">For more information, see the Topology recommendations section.</span></span>

### <a name="security-recommendations"></a><span data-ttu-id="49e1c-166">Recomendaciones de seguridad</span><span class="sxs-lookup"><span data-stu-id="49e1c-166">Security recommendations</span></span>

<span data-ttu-id="49e1c-167">**Administración de contraseñas de usuario**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-167">**User password management**.</span></span> <span data-ttu-id="49e1c-168">Las ediciones Premium de Azure AD admiten la escritura diferida de contraseñas, permitiendo a los usuarios locales realizar restablecimientos de contraseñas de autoservicio desde dentro de Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="49e1c-168">The Azure AD Premium editions support password writeback, enabling your on-premises users to perform self-service password resets from within the Azure portal.</span></span> <span data-ttu-id="49e1c-169">Esta característica solo debería habilitarse después de revisar la directiva de seguridad de las contraseñas de su organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-169">This feature should only be enabled after reviewing your organization's password security policy.</span></span> <span data-ttu-id="49e1c-170">Por ejemplo, puede restringir qué usuarios pueden cambiar sus contraseñas y personalizar la experiencia de su administración.</span><span class="sxs-lookup"><span data-stu-id="49e1c-170">For example, you can restrict which users can change their passwords, and you can tailor the password management experience.</span></span> <span data-ttu-id="49e1c-171">Para más información, vea [Personalización de la administración de contraseñas para ajustarse a las necesidades de su organización][aad-password-management].</span><span class="sxs-lookup"><span data-stu-id="49e1c-171">For more information, see [Customizing Password Management to fit your organization's needs][aad-password-management].</span></span>

<span data-ttu-id="49e1c-172">**Proteja las aplicaciones locales que sean accesibles externamente.**</span><span class="sxs-lookup"><span data-stu-id="49e1c-172">**Protect on-premises applications that can be accessed externally.**</span></span> <span data-ttu-id="49e1c-173">Utilice el Proxy de aplicación de Azure AD para proporcionar acceso controlado a las aplicaciones web locales para los usuarios externos a través de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-173">Use the Azure AD Application Proxy to provide controlled access to on-premises web applications for external users through Azure AD.</span></span> <span data-ttu-id="49e1c-174">Solo los usuarios que tienen credenciales válidas en su directorio de Azure tienen permiso para usar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="49e1c-174">Only users that have valid credentials in your Azure directory have permission to use the application.</span></span> <span data-ttu-id="49e1c-175">Para obtener más información, consulte el artículo [Habilitación del Proxy de aplicación en Azure Portal][aad-application-proxy].</span><span class="sxs-lookup"><span data-stu-id="49e1c-175">For more information, see the article [Enable Application Proxy in the Azure portal][aad-application-proxy].</span></span>

<span data-ttu-id="49e1c-176">**Supervise activamente Azure AD en busca de indicios de actividad sospechosa.**</span><span class="sxs-lookup"><span data-stu-id="49e1c-176">**Actively monitor Azure AD for signs of suspicious activity.**</span></span> <span data-ttu-id="49e1c-177">Considere el uso de la edición Premium P2 de Azure AD, que incluye Azure AD Identity Protection.</span><span class="sxs-lookup"><span data-stu-id="49e1c-177">Consider using Azure AD Premium P2 edition, which includes Azure AD Identity Protection.</span></span> <span data-ttu-id="49e1c-178">Identity Protection utiliza algoritmos de aprendizaje automático adaptables y heurísticos para detectar anomalías y eventos de riesgo que pueden indicar que se ha puesto en peligro una identidad.</span><span class="sxs-lookup"><span data-stu-id="49e1c-178">Identity Protection uses adaptive machine learning algorithms and heuristics to detect anomalies and risk events that may indicate that an identity has been compromised.</span></span> <span data-ttu-id="49e1c-179">Por ejemplo, puede detectar actividad inusual como actividades irregulares de inicio de sesión, inicios de sesión de orígenes desconocidos o de direcciones IP con actividad sospechosa, o inicios de sesión desde dispositivos que pueden estar infectados.</span><span class="sxs-lookup"><span data-stu-id="49e1c-179">For example, it can detect potentially unusual activity such as irregular sign-in activities, sign-ins from unknown sources or from IP addresses with suspicious activity, or sign-ins from devices that may be infected.</span></span> <span data-ttu-id="49e1c-180">Con estos datos, Identity Protection genera informes y alertas que permiten investigar estos eventos de riesgo y tomar las acciones de corrección adecuadas.</span><span class="sxs-lookup"><span data-stu-id="49e1c-180">Using this data, Identity Protection generates reports and alerts that enables you to investigate these risk events and take appropriate action.</span></span> <span data-ttu-id="49e1c-181">Para más información, consulte [Azure Active Directory Identity Protection][aad-identity-protection].</span><span class="sxs-lookup"><span data-stu-id="49e1c-181">For more information, see [Azure Active Directory Identity Protection][aad-identity-protection].</span></span>

<span data-ttu-id="49e1c-182">Puede usar la característica de informes de Azure AD en Azure Portal para supervisar las actividades relacionadas con la seguridad que se producen en el sistema.</span><span class="sxs-lookup"><span data-stu-id="49e1c-182">You can use the reporting feature of Azure AD in the Azure portal to monitor security-related activities occurring in your system.</span></span> <span data-ttu-id="49e1c-183">Para más información sobre estos informes, consulte [Azure Active Directory Reporting Guide][aad-reporting-guide] (Guía de informes de Azure Active Directory).</span><span class="sxs-lookup"><span data-stu-id="49e1c-183">For more information about using these reports, see [Azure Active Directory Reporting Guide][aad-reporting-guide].</span></span>

### <a name="topology-recommendations"></a><span data-ttu-id="49e1c-184">Recomendaciones de topología</span><span class="sxs-lookup"><span data-stu-id="49e1c-184">Topology recommendations</span></span>

<span data-ttu-id="49e1c-185">Configure Azure AD Connect para implementar la topología que mejor se ajuste a los requisitos de su organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-185">Configure Azure AD Connect to implement a topology that most closely matches the requirements of your organization.</span></span> <span data-ttu-id="49e1c-186">Las topologías que admite Azure AD Connect son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="49e1c-186">Topologies that Azure AD Connect supports include the following:</span></span>

- <span data-ttu-id="49e1c-187">**Un único bosque, un único directorio de Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-187">**Single forest, single Azure AD directory**.</span></span> <span data-ttu-id="49e1c-188">En esta topología, Azure AD Connect sincroniza los objetos y la información de identidad de uno o varios dominios de un único bosque local en un solo inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-188">In this topology, Azure AD Connect synchronizes objects and identity information from one or more domains in a single on-premises forest into a single Azure AD tenant.</span></span> <span data-ttu-id="49e1c-189">Se trata de la topología predeterminada implementada por la instalación rápida de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="49e1c-189">This is the default topology implemented by the express installation of Azure AD Connect.</span></span>

  > [!NOTE]
  > <span data-ttu-id="49e1c-190">No use varios servidores de sincronización de Azure AD Connect para conectarse a dominios diferentes en el mismo bosque local para el mismo inquilino de Azure AD, a menos que esté ejecutando un servidor en modo de almacenamiento provisional, según se describe a continuación.</span><span class="sxs-lookup"><span data-stu-id="49e1c-190">Don't use multiple Azure AD Connect sync servers to connect different domains in the same on-premises forest to the same Azure AD tenant, unless you are running a server in staging mode, described below.</span></span>
  >
  >

- <span data-ttu-id="49e1c-191">**Varios bosques, un único directorio de Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-191">**Multiple forests, single Azure AD directory**.</span></span> <span data-ttu-id="49e1c-192">En esta topología, Azure AD Connect sincroniza la información de identidad y los objetos desde varios bosques en un solo inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-192">In this topology, Azure AD Connect synchronizes objects and identity information from multiple forests into a single Azure AD tenant.</span></span> <span data-ttu-id="49e1c-193">Use esta topología si su organización tiene más de un bosque local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-193">Use this topology if your organization has more than one on-premises forest.</span></span> <span data-ttu-id="49e1c-194">Puede consolidar la información de identidad para que cada usuario único se represente una vez en el directorio de Azure AD, aunque exista el mismo usuario en más de un bosque.</span><span class="sxs-lookup"><span data-stu-id="49e1c-194">You can consolidate identity information so that each unique user is represented once in the Azure AD directory, even if the same user exists in more than one forest.</span></span> <span data-ttu-id="49e1c-195">Todos los bosques usar el mismo servidor de sincronización de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="49e1c-195">All forests use the same Azure AD Connect sync server.</span></span> <span data-ttu-id="49e1c-196">El servidor de sincronización de Azure AD Connect no tiene que formar parte de ningún dominio, pero debe ser accesible desde todos los bosques.</span><span class="sxs-lookup"><span data-stu-id="49e1c-196">The Azure AD Connect sync server does not have to be part of any domain, but it must be reachable from all forests.</span></span>

  > [!NOTE]
  > <span data-ttu-id="49e1c-197">En esta topología, no utilice servidores independientes de sincronización de Azure AD Connect para conectar cada bosque local a un único inquilino de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-197">In this topology, don't use separate Azure AD Connect sync servers to connect each on-premises forest to a single Azure AD tenant.</span></span> <span data-ttu-id="49e1c-198">Esto puede dar lugar a información de identidad duplicada en Azure AD si los usuarios están presentes en más de un bosque.</span><span class="sxs-lookup"><span data-stu-id="49e1c-198">This can result in duplicated identity information in Azure AD if users are present in more than one forest.</span></span>
  >

- <span data-ttu-id="49e1c-199">**Varios bosques: topologías independientes**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-199">**Multiple forests, separate topologies**.</span></span> <span data-ttu-id="49e1c-200">Esta topología combina la información de identidad de bosques independientes en un solo inquilino de Azure AD, tratando a todos los bosques como entidades independientes.</span><span class="sxs-lookup"><span data-stu-id="49e1c-200">This topology merges identity information from separate forests into a single Azure AD tenant, treating all forests as separate entities.</span></span> <span data-ttu-id="49e1c-201">Esta topología es útil si se combinan bosques de organizaciones diferentes y se mantiene en un solo bosque la información de identidad para cada usuario.</span><span class="sxs-lookup"><span data-stu-id="49e1c-201">This topology is useful if you are combining forests from different organizations and the identity information for each user is held in only one forest.</span></span>

  > [!NOTE]
  > <span data-ttu-id="49e1c-202">Si se sincronizan las listas globales de direcciones (GAL) de cada bosque, un usuario de un bosque puede estar presente en otro como un contacto.</span><span class="sxs-lookup"><span data-stu-id="49e1c-202">If the global address lists (GAL) in each forest are synchronized, a user in one forest may be present in another as a contact.</span></span> <span data-ttu-id="49e1c-203">Esto puede ocurrir si su organización ha implementado GALSync con Forefront Identity Manager 2010 o Microsoft Identity Manager 2016.</span><span class="sxs-lookup"><span data-stu-id="49e1c-203">This can occur if your organization has implemented GALSync with Forefront Identity manager 2010 or Microsoft Identity Manager 2016.</span></span> <span data-ttu-id="49e1c-204">En este escenario, puede especificar que los usuarios deben identificarse por su atributo *Mail*.</span><span class="sxs-lookup"><span data-stu-id="49e1c-204">In this scenario, you can specify that users should be identified by their *Mail* attribute.</span></span> <span data-ttu-id="49e1c-205">También puede hacer coincidir las identidades mediante los atributos *ObjectSID* y *msExchMasterAccountSID*.</span><span class="sxs-lookup"><span data-stu-id="49e1c-205">You can also match identities using the *ObjectSID* and *msExchMasterAccountSID* attributes.</span></span> <span data-ttu-id="49e1c-206">Resulta de utilidad si tiene uno o varios bosques de recursos con las cuentas deshabilitadas.</span><span class="sxs-lookup"><span data-stu-id="49e1c-206">This is useful if you have one or more resource forests with disabled accounts.</span></span>
  >

- <span data-ttu-id="49e1c-207">**Servidor provisional**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-207">**Staging server**.</span></span> <span data-ttu-id="49e1c-208">En esta configuración, ejecuta una segunda instancia del servidor de sincronización de Azure AD Connect en paralelo con la primera.</span><span class="sxs-lookup"><span data-stu-id="49e1c-208">In this configuration, you run a second instance of the Azure AD Connect sync server in parallel with the first.</span></span> <span data-ttu-id="49e1c-209">Esta estructura es compatible con escenarios como:</span><span class="sxs-lookup"><span data-stu-id="49e1c-209">This structure supports scenarios such as:</span></span>

  - <span data-ttu-id="49e1c-210">Alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="49e1c-210">High availability.</span></span>
  - <span data-ttu-id="49e1c-211">Prueba e implementación de una nueva configuración del servidor de sincronización de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="49e1c-211">Testing and deploying a new configuration of the Azure AD Connect sync server.</span></span>
  - <span data-ttu-id="49e1c-212">Introducción a un nuevo servidor y retirada de una configuración anterior.</span><span class="sxs-lookup"><span data-stu-id="49e1c-212">Introducing a new server and decommissioning an old configuration.</span></span>

    <span data-ttu-id="49e1c-213">En estos casos, la segunda instancia se ejecuta en *modo de almacenamiento provisional*.</span><span class="sxs-lookup"><span data-stu-id="49e1c-213">In these scenarios, the second instance runs in *staging mode*.</span></span> <span data-ttu-id="49e1c-214">El servidor registra los objetos importados y los datos de sincronización en su base de datos, pero no pasa los datos a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-214">The server records imported objects and synchronization data in its database, but does not pass the data to Azure AD.</span></span> <span data-ttu-id="49e1c-215">Si deshabilita el modo de almacenamiento provisional, el servidor comienza a escribir datos en Azure AD y también realiza escrituras diferidas de contraseñas en los directorios locales cuando corresponda.</span><span class="sxs-lookup"><span data-stu-id="49e1c-215">If you disable staging mode, the server starts writing data to Azure AD, and also starts performing password write-backs into the on-premises directories where appropriate.</span></span> <span data-ttu-id="49e1c-216">Para más información, consulte [Sincronización de Azure AD Connect: tareas y consideraciones operativas][aad-connect-sync-operational-tasks].</span><span class="sxs-lookup"><span data-stu-id="49e1c-216">For more information, see [Azure AD Connect sync: Operational tasks and considerations][aad-connect-sync-operational-tasks].</span></span>

- <span data-ttu-id="49e1c-217">**Varios directorios de Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-217">**Multiple Azure AD directories**.</span></span> <span data-ttu-id="49e1c-218">Se recomienda crear un solo directorio de Azure AD para una organización, pero puede haber situaciones en las que necesite dividir la información en directorios de Azure AD diferentes.</span><span class="sxs-lookup"><span data-stu-id="49e1c-218">It is recommended that you create a single Azure AD directory for an organization, but there may be situations where you need to partition information across separate Azure AD directories.</span></span> <span data-ttu-id="49e1c-219">En este caso, evite los problemas de la escritura diferida de las contraseñas y la sincronización asegurándose de que cada objeto del bosque local aparece en un único directorio de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-219">In this case, avoid synchronization and password write-back issues by ensuring that each object from the on-premises forest appears in only one Azure AD directory.</span></span> <span data-ttu-id="49e1c-220">Para implementar este escenario, configure servidores independientes de sincronización de Azure AD Connect y use el filtrado para que cada servidor de sincronización de Azure AD Connect funcione en un conjunto de objetos mutuamente excluyentes.</span><span class="sxs-lookup"><span data-stu-id="49e1c-220">To implement this scenario, configure separate Azure AD Connect sync servers for each Azure AD directory, and use filtering so that each Azure AD Connect sync server operates on a mutually exclusive set of objects.</span></span>

<span data-ttu-id="49e1c-221">Para más información acerca de estas topologías, consulte [Topologías para Azure AD Connect][aad-topologies].</span><span class="sxs-lookup"><span data-stu-id="49e1c-221">For more information about these topologies, see [Topologies for Azure AD Connect][aad-topologies].</span></span>

### <a name="user-authentication"></a><span data-ttu-id="49e1c-222">Autenticación de usuarios</span><span class="sxs-lookup"><span data-stu-id="49e1c-222">User authentication</span></span>

<span data-ttu-id="49e1c-223">De forma predeterminada, el servidor de sincronización de Azure AD Connect configura la sincronización de hash de contraseñas entre el dominio local y Azure AD, y el servicio de Azure AD da por supuesto que los usuarios se autentican proporcionando la misma contraseña que usan en local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-223">By default, the Azure AD Connect sync server configures password hash synchronization between the on-premises domain and Azure AD, and the Azure AD service assumes that users authenticate by providing the same password that they use on-premises.</span></span> <span data-ttu-id="49e1c-224">Para muchas organizaciones, esto es apropiado, pero debe tener en cuenta las directivas existentes y la infraestructura de su organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-224">For many organizations, this is appropriate, but you should consider your organization's existing policies and infrastructure.</span></span> <span data-ttu-id="49e1c-225">Por ejemplo: </span><span class="sxs-lookup"><span data-stu-id="49e1c-225">For example:</span></span>

- <span data-ttu-id="49e1c-226">La directiva de seguridad de una organización podría prohibir la sincronización de hash de contraseñas en la nube.</span><span class="sxs-lookup"><span data-stu-id="49e1c-226">The security policy of your organization may prohibit synchronizing password hashes to the cloud.</span></span> <span data-ttu-id="49e1c-227">En este caso, su organización debe considerar [la autenticación de paso a través](/azure/active-directory/connect/active-directory-aadconnect-pass-through-authentication).</span><span class="sxs-lookup"><span data-stu-id="49e1c-227">In this case your organization should consider [pass-through authentication](/azure/active-directory/connect/active-directory-aadconnect-pass-through-authentication).</span></span>
- <span data-ttu-id="49e1c-228">Podría requerir que los usuarios experimenten un inicio de sesión único (SSO) fluido al tener acceso a recursos en la nube desde máquinas unidas a un dominio en la red corporativa.</span><span class="sxs-lookup"><span data-stu-id="49e1c-228">You might require that users experience seamless single sign-on (SSO) when accessing cloud resources from domain-joined machines on the corporate network.</span></span>
- <span data-ttu-id="49e1c-229">Su organización podría disponer ya de Active Directory Federation Services (AD FS) o de un proveedor de federación implementado de terceros.</span><span class="sxs-lookup"><span data-stu-id="49e1c-229">Your organization might already have Active Directory Federation Services (AD FS) or a third party federation provider deployed.</span></span> <span data-ttu-id="49e1c-230">Puede configurar Azure AD para usar esta infraestructura e implementar la autenticación y SSO, en lugar de utilizar la información de contraseñas que se mantiene en la nube.</span><span class="sxs-lookup"><span data-stu-id="49e1c-230">You can configure Azure AD to use this infrastructure to implement authentication and SSO rather than by using password information held in the cloud.</span></span>

<span data-ttu-id="49e1c-231">Para más información, consulte [Opciones para el inicio de sesión de los usuarios en Azure AD Connect][aad-user-sign-in].</span><span class="sxs-lookup"><span data-stu-id="49e1c-231">For more information, see [Azure AD Connect User Sign on options][aad-user-sign-in].</span></span>

### <a name="azure-ad-application-proxy"></a><span data-ttu-id="49e1c-232">Proxy de aplicación de Azure AD</span><span class="sxs-lookup"><span data-stu-id="49e1c-232">Azure AD application proxy</span></span>

<span data-ttu-id="49e1c-233">Use Azure AD para permitir el acceso a aplicaciones locales.</span><span class="sxs-lookup"><span data-stu-id="49e1c-233">Use Azure AD to provide access to on-premises applications.</span></span>

<span data-ttu-id="49e1c-234">Exponga las aplicaciones web locales mediante los conectores de proxy de aplicación administrados por el componente de proxy de aplicación de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-234">Expose your on-premises web applications using application proxy connectors managed by the Azure AD application proxy component.</span></span> <span data-ttu-id="49e1c-235">El conector de proxy de aplicación abre una conexión de red de salida para el proxy de aplicación de Azure AD y las solicitudes de los usuarios remotos se enrutan desde Azure AD a través de esta conexión a las aplicaciones web.</span><span class="sxs-lookup"><span data-stu-id="49e1c-235">The application proxy connector opens an outbound network connection to the Azure AD application proxy, and remote users' requests are routed back from Azure AD through this connection to the web apps.</span></span> <span data-ttu-id="49e1c-236">Así se evita tener que abrir los puertos entrantes en el firewall local y se reduce la superficie expuesta a ataques de la organización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-236">This removes the need to open inbound ports in the on-premises firewall and reduces the attack surface exposed by your organization.</span></span>

<span data-ttu-id="49e1c-237">Para más información, consulte [Publicación de aplicaciones mediante el proxy de aplicación de Azure AD][aad-application-proxy].</span><span class="sxs-lookup"><span data-stu-id="49e1c-237">For more information, see [Publish applications using Azure AD Application proxy][aad-application-proxy].</span></span>

### <a name="object-synchronization"></a><span data-ttu-id="49e1c-238">Sincronización de objetos</span><span class="sxs-lookup"><span data-stu-id="49e1c-238">Object synchronization</span></span>

<span data-ttu-id="49e1c-239">La configuración predeterminada de Azure AD Connect sincroniza los objetos del directorio local de Active Directory en función de las reglas especificadas en el artículo [Sincronización de Azure AD Connect: descripción de la configuración predeterminada][aad-connect-sync-default-rules].</span><span class="sxs-lookup"><span data-stu-id="49e1c-239">Azure AD Connect's default configuration synchronizes objects from your local Active Directory directory based on the rules specified in the article [Azure AD Connect sync: Understanding the default configuration][aad-connect-sync-default-rules].</span></span> <span data-ttu-id="49e1c-240">Los objetos que cumplen estas reglas se sincronizan mientras que se pasan por alto todos los demás.</span><span class="sxs-lookup"><span data-stu-id="49e1c-240">Objects that satisfy these rules are synchronized while all other objects are ignored.</span></span> <span data-ttu-id="49e1c-241">Algunas reglas de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="49e1c-241">Some example rules:</span></span>

- <span data-ttu-id="49e1c-242">Los objetos de usuario deben tener un único atributo *sourceAnchor* y el atributo *accountEnabled* debe estar relleno.</span><span class="sxs-lookup"><span data-stu-id="49e1c-242">User objects must have a unique *sourceAnchor* attribute and the *accountEnabled* attribute must be populated.</span></span>
- <span data-ttu-id="49e1c-243">Los objetos de usuario deben tener un atributo *sAMAccountName* y no se puede iniciar con el texto *Azure AD_* ni *MSOL_*.</span><span class="sxs-lookup"><span data-stu-id="49e1c-243">User objects must have a *sAMAccountName* attribute and cannot start with the text *Azure AD_* or *MSOL_*.</span></span>

<span data-ttu-id="49e1c-244">Azure AD Connect aplica varias reglas a los objetos User, Contact, Group, ForeignSecurityPrincipal y Computer.</span><span class="sxs-lookup"><span data-stu-id="49e1c-244">Azure AD Connect applies several rules to User, Contact, Group, ForeignSecurityPrincipal, and Computer objects.</span></span> <span data-ttu-id="49e1c-245">Utilice el Editor de reglas de sincronización instalado con Azure AD Connect, si tiene que modificar el conjunto predeterminado de reglas.</span><span class="sxs-lookup"><span data-stu-id="49e1c-245">Use the Synchronization Rules Editor installed with Azure AD Connect if you need to modify the default set of rules.</span></span> <span data-ttu-id="49e1c-246">Para más información, consulte [Sincronización de Azure AD Connect: descripción de la configuración predeterminada][aad-connect-sync-default-rules]).</span><span class="sxs-lookup"><span data-stu-id="49e1c-246">For more information, see [Azure AD Connect sync: Understanding the default configuration][aad-connect-sync-default-rules]).</span></span>

<span data-ttu-id="49e1c-247">También puede definir sus propios filtros para limitar los objetos que se van a sincronizar por dominio o unidad organizativa.</span><span class="sxs-lookup"><span data-stu-id="49e1c-247">You can also define your own filters to limit the objects to be synchronized by domain or OU.</span></span> <span data-ttu-id="49e1c-248">Como alternativa, puede implementar un filtrado personalizado más complejo como el que se describe en [Sincronización de Azure AD Connect: configuración del filtrado][aad-filtering].</span><span class="sxs-lookup"><span data-stu-id="49e1c-248">Alternatively, you can implement more complex custom filtering such as that described in [Azure AD Connect sync: Configure Filtering][aad-filtering].</span></span>

### <a name="monitoring"></a><span data-ttu-id="49e1c-249">Supervisión</span><span class="sxs-lookup"><span data-stu-id="49e1c-249">Monitoring</span></span>

<span data-ttu-id="49e1c-250">La supervisión de estado se realiza mediante los siguientes agentes instalados de forma local:</span><span class="sxs-lookup"><span data-stu-id="49e1c-250">Health monitoring is performed by the following agents installed on-premises:</span></span>

- <span data-ttu-id="49e1c-251">Azure AD Connect instala un agente que captura información acerca de las operaciones de sincronización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-251">Azure AD Connect installs an agent that captures information about synchronization operations.</span></span> <span data-ttu-id="49e1c-252">Utilice la hoja Azure AD Connect Health en Azure Portal para supervisar su estado y rendimiento.</span><span class="sxs-lookup"><span data-stu-id="49e1c-252">Use the Azure AD Connect Health blade in the Azure portal to monitor its health and performance.</span></span> <span data-ttu-id="49e1c-253">Para más información, vea [Uso de Azure AD Connect Health con AD DS][aad-health].</span><span class="sxs-lookup"><span data-stu-id="49e1c-253">For more information, see [Using Azure AD Connect Health for sync][aad-health].</span></span>
- <span data-ttu-id="49e1c-254">Para supervisar el estado de los dominios de AD DS y los directorios de Azure, instale el agente de Azure AD Connect Health para AD DS en una máquina, dentro del dominio local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-254">To monitor the health of the AD DS domains and directories from Azure, install the Azure AD Connect Health for AD DS agent on a machine within the on-premises domain.</span></span> <span data-ttu-id="49e1c-255">Utilice la hoja de Azure Active Directory Connect Health en Azure Portal para la supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="49e1c-255">Use the Azure Active Directory Connect Health blade in the Azure portal for health monitoring.</span></span> <span data-ttu-id="49e1c-256">Para más información, vea [Uso de Azure AD Connect Health con AD DS][aad-health-adds].</span><span class="sxs-lookup"><span data-stu-id="49e1c-256">For more information, see [Using Azure AD Connect Health with AD DS][aad-health-adds]</span></span>
- <span data-ttu-id="49e1c-257">Instale Azure AD Connect Health para el agente de AD FS a fin de supervisar el estado de los servicios que se ejecutan en local y use la hoja de Azure Active Directory Connect Health en Azure Portal para supervisar AD FS.</span><span class="sxs-lookup"><span data-stu-id="49e1c-257">Install the Azure AD Connect Health for AD FS agent to monitor the health of services running on on-premises, and use the Azure Active Directory Connect Health blade in the Azure portal to monitor AD FS.</span></span> <span data-ttu-id="49e1c-258">Para más información, vea [Uso de Azure AD Connect Health con AD FS][aad-health-adfs].</span><span class="sxs-lookup"><span data-stu-id="49e1c-258">For more information, see [Using Azure AD Connect Health with AD FS][aad-health-adfs]</span></span>

<span data-ttu-id="49e1c-259">Para más información acerca de cómo instalar los agentes de Azure AD Connect Health y sus requisitos, consulte [Instalación del agente de Azure AD Connect Health][aad-agent-installation].</span><span class="sxs-lookup"><span data-stu-id="49e1c-259">For more information on installing the AD Connect Health agents and their requirements, see [Azure AD Connect Health Agent Installation][aad-agent-installation].</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="49e1c-260">Consideraciones sobre escalabilidad</span><span class="sxs-lookup"><span data-stu-id="49e1c-260">Scalability considerations</span></span>

<span data-ttu-id="49e1c-261">El servicio de Azure AD permite la escalabilidad en función de las réplicas, con una única réplica principal que controla las operaciones de escritura y varias réplicas secundarias de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="49e1c-261">The Azure AD service supports scalability based on replicas, with a single primary replica that handles write operations plus multiple read-only secondary replicas.</span></span> <span data-ttu-id="49e1c-262">Azure AD redirige de forma transparente los reintentos de escritura realizados en las réplicas secundarias a la réplica principal, y proporciona la coherencia final.</span><span class="sxs-lookup"><span data-stu-id="49e1c-262">Azure AD transparently redirects attempted writes made against secondary replicas to the primary replica and provides eventual consistency.</span></span> <span data-ttu-id="49e1c-263">Todos los cambios realizados en la réplica principal se propagan a las secundarias.</span><span class="sxs-lookup"><span data-stu-id="49e1c-263">All changes made to the primary replica are propagated to the secondary replicas.</span></span> <span data-ttu-id="49e1c-264">Esta arquitectura se escala bien porque la mayoría de las operaciones en Azure AD son lecturas en lugar de escrituras.</span><span class="sxs-lookup"><span data-stu-id="49e1c-264">This architecture scales well because most operations against Azure AD are reads rather than writes.</span></span> <span data-ttu-id="49e1c-265">Para más información, consulte [Azure AD: bajo el paraguas de nuestro directorio en la nube con redundancia geográfica, alta disponibilidad y distribuido][aad-scalability].</span><span class="sxs-lookup"><span data-stu-id="49e1c-265">For more information, see [Azure AD: Under the hood of our geo-redundant, highly available, distributed cloud directory][aad-scalability].</span></span>

<span data-ttu-id="49e1c-266">Para el servidor de sincronización de Azure AD Connect, determine la cantidad de objetos que es probable que se sincronicen desde su directorio local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-266">For the Azure AD Connect sync server, determine how many objects you are likely to synchronize from your local directory.</span></span> <span data-ttu-id="49e1c-267">Si tiene menos de 100.000 objetos, puede usar el software LocalDB de SQL Server Express predeterminado proporcionado con Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="49e1c-267">If you have less than 100,000 objects, you can use the default SQL Server Express LocalDB software provided with Azure AD Connect.</span></span> <span data-ttu-id="49e1c-268">Si tiene un mayor número de objetos, debe instalar una versión de producción de SQL Server y realizar una instalación personalizada de Azure AD Connect, especificando que debería usar una instancia existente de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="49e1c-268">If you have a larger number of objects, you should install a production version of SQL Server and perform a custom installation of Azure AD Connect, specifying that it should use an existing instance of SQL Server.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="49e1c-269">Consideraciones sobre disponibilidad</span><span class="sxs-lookup"><span data-stu-id="49e1c-269">Availability considerations</span></span>

<span data-ttu-id="49e1c-270">El servicio de Azure AD se distribuye geográficamente y se ejecuta en varios centros de datos propagados por el mundo con conmutación por error automática.</span><span class="sxs-lookup"><span data-stu-id="49e1c-270">The Azure AD service is geo-distributed and runs in multiple data centers spread around the world with automated failover.</span></span> <span data-ttu-id="49e1c-271">Si un centro de datos deja de estar disponible, Azure AD garantiza que los datos del directorio están disponibles para el acceso de una instancia en al menos dos centros de datos más dispersos regionalmente.</span><span class="sxs-lookup"><span data-stu-id="49e1c-271">If a data center becomes unavailable, Azure AD ensures that your directory data is available for instance access in at least two more regionally dispersed data centers.</span></span>

> [!NOTE]
> <span data-ttu-id="49e1c-272">El Acuerdo de Nivel de Servicio (SLA) para los servicios de Azure AD Basic y Premium garantiza al menos un 99,9 % de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="49e1c-272">The service level agreement (SLA) for Azure AD Basic and Premium services guarantees at least 99.9% availability.</span></span> <span data-ttu-id="49e1c-273">No hay ningún SLA para el nivel gratuito de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-273">There is no SLA for the Free tier of Azure AD.</span></span> <span data-ttu-id="49e1c-274">Para más información, consulte [SLA de Azure Active Directory][sla-aad].</span><span class="sxs-lookup"><span data-stu-id="49e1c-274">For more information, see [SLA for Azure Active Directory][sla-aad].</span></span>
>

<span data-ttu-id="49e1c-275">Considere la posibilidad de aprovisionar una segunda instancia del servidor de sincronización de Azure AD Connect en modo provisional para aumentar la disponibilidad, como se describe en la sección de recomendaciones de topología.</span><span class="sxs-lookup"><span data-stu-id="49e1c-275">Consider provisioning a second instance of Azure AD Connect sync server in staging mode to increase availability, as discussed in the topology recommendations section.</span></span>

<span data-ttu-id="49e1c-276">Si no utiliza la instancia de LocalDB de SQL Server Express que viene con Azure AD Connect, considere el uso de clústeres SQL para lograr una alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="49e1c-276">If you are not using the SQL Server Express LocalDB instance that comes with Azure AD Connect, consider using SQL clustering to achieve high availability.</span></span> <span data-ttu-id="49e1c-277">En Azure AD Connect, no se admiten soluciones como la creación de reflejo y Always On.</span><span class="sxs-lookup"><span data-stu-id="49e1c-277">Solutions such as mirroring and Always On are not supported by Azure AD Connect.</span></span>

<span data-ttu-id="49e1c-278">Para consideraciones adicionales acerca de cómo lograr la alta disponibilidad del servidor de sincronización de Azure AD Connect y también de cómo recuperarse después de un error, consulte [Sincronización de Azure AD Connect: tareas y consideraciones operativas y recuperación ante desastres][aad-sync-disaster-recovery].</span><span class="sxs-lookup"><span data-stu-id="49e1c-278">For additional considerations about achieving high availability of the Azure AD Connect sync server and also how to recover after a failure, see [Azure AD Connect sync: Operational tasks and considerations - Disaster Recovery][aad-sync-disaster-recovery].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="49e1c-279">Consideraciones sobre la manejabilidad</span><span class="sxs-lookup"><span data-stu-id="49e1c-279">Manageability considerations</span></span>

<span data-ttu-id="49e1c-280">Hay dos aspectos importantes para la administración de Azure AD:</span><span class="sxs-lookup"><span data-stu-id="49e1c-280">There are two aspects to managing Azure AD:</span></span>

- <span data-ttu-id="49e1c-281">La administración de Azure AD en la nube.</span><span class="sxs-lookup"><span data-stu-id="49e1c-281">Administering Azure AD in the cloud.</span></span>
- <span data-ttu-id="49e1c-282">El mantenimiento de los servidores de sincronización de Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="49e1c-282">Maintaining the Azure AD Connect sync servers.</span></span>

<span data-ttu-id="49e1c-283">Azure AD proporciona las siguientes opciones para la administración de dominios y directorios en la nube:</span><span class="sxs-lookup"><span data-stu-id="49e1c-283">Azure AD provides the following options for managing domains and directories in the cloud:</span></span>

- <span data-ttu-id="49e1c-284">**Módulo PowerShell de Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-284">**Azure Active Directory PowerShell Module**.</span></span> <span data-ttu-id="49e1c-285">Use este [módulo] [ aad-powershell] si tiene que programar tareas administrativas comunes de Azure AD, como la administración de usuarios, la administración de dominios y la configuración del inicio de sesión único.</span><span class="sxs-lookup"><span data-stu-id="49e1c-285">Use this [module][aad-powershell] if you need to script common Azure AD administrative tasks such as user management, domain management, and configuring single sign-on.</span></span>
- <span data-ttu-id="49e1c-286">**Hoja de administración de Azure AD en Azure Portal**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-286">**Azure AD management blade in the Azure portal**.</span></span> <span data-ttu-id="49e1c-287">Esta hoja proporciona una vista de administración interactiva del directorio y le permite controlar y configurar la mayoría de los aspectos de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-287">This blade provides an interactive management view of the directory, and enables you to control and configure most aspects of Azure AD.</span></span>

<span data-ttu-id="49e1c-288">Azure AD Connect instala las siguientes herramientas para mantener los servicios de sincronización de Azure AD Connect de las máquinas locales:</span><span class="sxs-lookup"><span data-stu-id="49e1c-288">Azure AD Connect installs the following tools to maintain Azure AD Connect sync services from your on-premises machines:</span></span>

- <span data-ttu-id="49e1c-289">**Consola de Microsoft Azure Active Directory Connect**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-289">**Microsoft Azure Active Directory Connect console**.</span></span> <span data-ttu-id="49e1c-290">Esta herramienta permite modificar la configuración del servidor de sincronización de Azure AD, personalizar el modo en que se produce la sincronización, habilitar o deshabilitar el modo de almacenamiento provisional y cambiar el modo de inicio de sesión del usuario.</span><span class="sxs-lookup"><span data-stu-id="49e1c-290">This tool enables you to modify the configuration of the Azure AD Sync server, customize how synchronization occurs, enable or disable staging mode, and switch the user sign-in mode.</span></span> <span data-ttu-id="49e1c-291">Tenga en cuenta que puede habilitar el inicio de sesión de Active Directory FS con su infraestructura local.</span><span class="sxs-lookup"><span data-stu-id="49e1c-291">Note that you can enable Active Directory FS sign-in using your on-premises infrastructure.</span></span>
- <span data-ttu-id="49e1c-292">**Synchronization Service Manager**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-292">**Synchronization Service Manager**.</span></span> <span data-ttu-id="49e1c-293">Use la pestaña *Operaciones* de esta herramienta para administrar el proceso de sincronización y detectar si alguna parte del proceso ha dado error.</span><span class="sxs-lookup"><span data-stu-id="49e1c-293">Use the *Operations* tab in this tool to manage the synchronization process and detect whether any parts of the process have failed.</span></span> <span data-ttu-id="49e1c-294">Puede desencadenar las sincronizaciones manualmente mediante esta herramienta.</span><span class="sxs-lookup"><span data-stu-id="49e1c-294">You can trigger synchronizations manually using this tool.</span></span> <span data-ttu-id="49e1c-295">La pestaña *Conectores* le permite controlar las conexiones para los dominios a los que se asocia el motor de sincronización.</span><span class="sxs-lookup"><span data-stu-id="49e1c-295">The *Connectors* tab enables you to control the connections for the domains that the synchronization engine is attached to.</span></span>
- <span data-ttu-id="49e1c-296">**Editor de reglas de sincronización**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-296">**Synchronization Rules Editor**.</span></span> <span data-ttu-id="49e1c-297">Utilice esta herramienta para personalizar la forma en que se transforman los objetos cuando se copian entre un directorio local y Azure AD.</span><span class="sxs-lookup"><span data-stu-id="49e1c-297">Use this tool to customize the way objects are transformed when they are copied between an on-premises directory and Azure AD.</span></span> <span data-ttu-id="49e1c-298">Le permite especificar atributos y objetos adicionales para la sincronización y, a continuación, ejecutar los filtros para determinar qué objetos deben o no sincronizarse.</span><span class="sxs-lookup"><span data-stu-id="49e1c-298">This tool enables you to specify additional attributes and objects for synchronization, then executes filters to determine which objects should or should not be synchronized.</span></span> <span data-ttu-id="49e1c-299">Para más información, consulte la sección Editor de reglas de sincronización del documento [Sincronización de Azure AD Connect: descripción de la configuración predeterminada][aad-connect-sync-default-rules].</span><span class="sxs-lookup"><span data-stu-id="49e1c-299">For more information, see the Synchronization Rule Editor section in the document [Azure AD Connect sync: Understanding the default configuration][aad-connect-sync-default-rules].</span></span>

<span data-ttu-id="49e1c-300">Para más información y sugerencias para la administración de Azure AD Connect, consulte [Sincronización de Azure AD Connect: procedimientos recomendados para el cambio de la configuración predeterminada][aad-sync-best-practices].</span><span class="sxs-lookup"><span data-stu-id="49e1c-300">For more information and tips for managing Azure AD Connect, see [Azure AD Connect sync: Best practices for changing the default configuration][aad-sync-best-practices].</span></span>

## <a name="security-considerations"></a><span data-ttu-id="49e1c-301">Consideraciones sobre la seguridad</span><span class="sxs-lookup"><span data-stu-id="49e1c-301">Security considerations</span></span>

<span data-ttu-id="49e1c-302">Use el control de acceso condicional para denegar las solicitudes de autenticación de orígenes inesperados:</span><span class="sxs-lookup"><span data-stu-id="49e1c-302">Use conditional access control to deny authentication requests from unexpected sources:</span></span>

- <span data-ttu-id="49e1c-303">Desencadene [Azure Multi-Factor Authentication (MFA)][azure-multifactor-authentication], si un usuario intenta conectarse desde una ubicación que no sea de confianza, por ejemplo, a través de Internet, en lugar de usar una red de confianza.</span><span class="sxs-lookup"><span data-stu-id="49e1c-303">Trigger [Azure Multi-Factor Authentication (MFA)][azure-multifactor-authentication] if a user attempts to connect from a nontrusted location such as across the Internet instead of a trusted network.</span></span>

- <span data-ttu-id="49e1c-304">Utilice el tipo de plataforma de dispositivo del usuario (iOS, Android, Windows Mobile, Windows) para determinar la directiva de acceso a las aplicaciones y las características.</span><span class="sxs-lookup"><span data-stu-id="49e1c-304">Use the device platform type of the user (iOS, Android, Windows Mobile, Windows) to determine access policy to applications and features.</span></span>

- <span data-ttu-id="49e1c-305">Registre el estado habilitado o deshabilitado de los dispositivos de los usuarios e incorpore dicha información en las comprobaciones de la directiva de acceso.</span><span class="sxs-lookup"><span data-stu-id="49e1c-305">Record the enabled/disabled state of users' devices, and incorporate this information into the access policy checks.</span></span> <span data-ttu-id="49e1c-306">Por ejemplo, si la pérdida o el robo del teléfono de un usuario se debe registrar como deshabilitado para evitar que se use para obtener acceso.</span><span class="sxs-lookup"><span data-stu-id="49e1c-306">For example, if a user's phone is lost or stolen it should be recorded as disabled to prevent it from being used to gain access.</span></span>

- <span data-ttu-id="49e1c-307">Controle el acceso de los usuarios a los recursos según la pertenencia al grupo.</span><span class="sxs-lookup"><span data-stu-id="49e1c-307">Control user access to resources based on group membership.</span></span> <span data-ttu-id="49e1c-308">Use [reglas de pertenencia dinámica de Azure AD][ aad-dynamic-membership-rules] para simplificar la administración del grupo.</span><span class="sxs-lookup"><span data-stu-id="49e1c-308">Use [Azure AD dynamic membership rules][aad-dynamic-membership-rules] to simplify group administration.</span></span> <span data-ttu-id="49e1c-309">Para una breve descripción de cómo funciona esto, consulte [Introducción a la pertenencia dinámica a grupos][aad-dynamic-memberships].</span><span class="sxs-lookup"><span data-stu-id="49e1c-309">For a brief overview of how this works, see [Introduction to Dynamic Memberships for Groups][aad-dynamic-memberships].</span></span>

- <span data-ttu-id="49e1c-310">Use directivas de riesgo del acceso condicional con Azure AD Identity Protection, a fin de proporcionar protección avanzada en función de actividades de inicio de sesión inusuales u otros eventos.</span><span class="sxs-lookup"><span data-stu-id="49e1c-310">Use conditional access risk policies with Azure AD Identity Protection to provide advanced protection based on unusual sign-in activities or other events.</span></span>

<span data-ttu-id="49e1c-311">Para más información, consulte [Acceso condicional en Azure Active Directory][aad-conditional-access].</span><span class="sxs-lookup"><span data-stu-id="49e1c-311">For more information, see [Azure Active Directory conditional access][aad-conditional-access].</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="49e1c-312">Implementación de la solución</span><span class="sxs-lookup"><span data-stu-id="49e1c-312">Deploy the solution</span></span>

<span data-ttu-id="49e1c-313">En GitHub, se puede encontrar una implementación de una arquitectura de referencia que implementa estas recomendaciones y consideraciones.</span><span class="sxs-lookup"><span data-stu-id="49e1c-313">A deployment for a reference architecture that implements these recommendations and considerations is available on GitHub.</span></span> <span data-ttu-id="49e1c-314">Esta arquitectura de referencia implementa una red local simulada en Azure que puede usar para realizar pruebas y experimentar.</span><span class="sxs-lookup"><span data-stu-id="49e1c-314">This reference architecture deploys a simulated on-premises network in Azure that you can use to test and experiment.</span></span> <span data-ttu-id="49e1c-315">La arquitectura de referencia se puede implementar con máquinas virtuales Windows o Linux siguiendo estas instrucciones:</span><span class="sxs-lookup"><span data-stu-id="49e1c-315">The reference architecture can be deployed with either with Windows or Linux VMs by following the directions below:</span></span>

<!-- markdownlint-disable MD033 -->

1. <span data-ttu-id="49e1c-316">Haga clic en el botón a continuación:</span><span class="sxs-lookup"><span data-stu-id="49e1c-316">Click the button below:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fidentity-reference-architectures%2Fmaster%2Fazure-ad%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>

2. <span data-ttu-id="49e1c-317">Una vez abierto el vínculo en Azure Portal, debe especificar los valores de algunas de las opciones:</span><span class="sxs-lookup"><span data-stu-id="49e1c-317">Once the link has opened in the Azure portal, you must enter values for some of the settings:</span></span>
   - <span data-ttu-id="49e1c-318">El nombre del **Grupo de recursos** ya está definido en el archivo de parámetros, así que seleccione **Crear nuevo** y escriba `ra-aad-onpremise-rg` en el cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="49e1c-318">The **Resource group** name is already defined in the parameter file, so select **Create New** and enter `ra-aad-onpremise-rg` in the text box.</span></span>
   - <span data-ttu-id="49e1c-319">Seleccione la región en el cuadro de lista desplegable **Ubicación**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-319">Select the region from the **Location** drop down box.</span></span>
   - <span data-ttu-id="49e1c-320">No modifique los cuadros de texto **URI raíz de plantilla** o **URI raíz de parámetro**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-320">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   - <span data-ttu-id="49e1c-321">Seleccione **Windows** o **Linux** en el cuadro de lista desplegable **Tipo de SO**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-321">Select **windows** or **linux** in the **Os Type** the drop down box.</span></span>
   - <span data-ttu-id="49e1c-322">Revise los términos y condiciones, y haga clic en la casilla **Acepto los términos y condiciones indicados anteriormente**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-322">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   - <span data-ttu-id="49e1c-323">Haga clic en el botón **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-323">Click the **Purchase** button.</span></span>

3. <span data-ttu-id="49e1c-324">Espere a que la implementación se complete.</span><span class="sxs-lookup"><span data-stu-id="49e1c-324">Wait for the deployment to complete.</span></span>

4. <span data-ttu-id="49e1c-325">Los archivos de parámetros incluyen nombres de usuario y contraseñas de administrador codificados de forma rígida, y es muy recomendable que cambie ambos inmediatamente en todas las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="49e1c-325">The parameter files include a hard-coded administrator user names and passwords, and it is strongly recommended that you immediately change both on all the VMs.</span></span> <span data-ttu-id="49e1c-326">Haga clic en cada máquina virtual en Azure Portal y después en **Restablecer contraseña**, en la hoja **Soporte técnico y solución de problemas**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-326">Click each VM in the Azure Portal then click on **Reset password** in the **Support + troubleshooting** blade.</span></span> <span data-ttu-id="49e1c-327">Seleccione **Restablecer contraseña** en el cuadro desplegable **Modo**, seleccione un nuevo valor de **Nombre de usuario** y de **Contraseña**.</span><span class="sxs-lookup"><span data-stu-id="49e1c-327">Select **Reset password** in the **Mode** drop down box, then select a new **User name** and **Password**.</span></span> <span data-ttu-id="49e1c-328">Haga clic en el botón **Actualizar** para conservar el nuevo nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="49e1c-328">Click the **Update** button to persist the new user name and password.</span></span>

<!-- markdownlint-disable MD033 -->

<!-- links -->

[implementing-a-multi-tier-architecture-on-Azure]: ../virtual-machines-windows/n-tier.md

[aad-agent-installation]: /azure/active-directory/active-directory-aadconnect-health-agent-install
[aad-application-proxy]: /azure/active-directory/active-directory-application-proxy-enable
[aad-conditional-access]: /azure/active-directory//active-directory-conditional-access
[aad-connect-sync-default-rules]: /azure/active-directory/hybrid/concept-azure-ad-connect-sync-default-configuration
[aad-connect-sync-operational-tasks]: /azure/active-directory/hybrid/how-to-connect-sync-operations
[aad-dynamic-memberships]: https://youtu.be/Tdiz2JqCl9Q
[aad-dynamic-membership-rules]: /azure/active-directory/active-directory-accessmanagement-groups-with-advanced-rules
[aad-editions]: /azure/active-directory/active-directory-editions
[aad-filtering]: /azure/active-directory/hybrid/how-to-connect-sync-configure-filtering
[aad-health]: /azure/active-directory/active-directory-aadconnect-health-sync
[aad-health-adds]: /azure/active-directory/active-directory-aadconnect-health-adds
[aad-health-adfs]: /azure/active-directory/active-directory-aadconnect-health-adfs
[aad-identity-protection]: /azure/active-directory/active-directory-identityprotection
[aad-password-management]: /azure/active-directory/active-directory-passwords-customize
[aad-powershell]: https://msdn.microsoft.com/library/azure/mt757189.aspx
[aad-reporting-guide]: /azure/active-directory/active-directory-reporting-guide
[aad-scalability]: https://blogs.technet.microsoft.com/enterprisemobility/2014/09/02/azure-ad-under-the-hood-of-our-geo-redundant-highly-available-distributed-cloud-directory/
[aad-sync-best-practices]: /azure/active-directory/hybrid/how-to-connect-sync-best-practices-changing-default-configuration
[aad-sync-disaster-recovery]: /azure/active-directory/hybrid/how-to-connect-sync-operations#disaster-recovery
[aad-sync-requirements]: /azure/active-directory/active-directory-hybrid-identity-design-considerations-directory-sync-requirements
[aad-topologies]: /azure/active-directory/hybrid/plan-connect-topologies
[aad-user-sign-in]: /azure/active-directory/hybrid/plan-connect-user-signin
[azure-active-directory]: /azure/active-directory-domain-services/active-directory-ds-overview
[azure-ad-connect]: /azure/active-directory/hybrid/whatis-hybrid-identity
[azure-multifactor-authentication]: /azure/multi-factor-authentication/multi-factor-authentication
[considerations]: ./considerations.md
[resource-manager-overview]: /azure/azure-resource-manager/resource-group-overview
[sla-aad]: https://azure.microsoft.com/support/legal/sla/active-directory
[visio-download]: https://archcenter.blob.core.windows.net/cdn/identity-architectures.vsdx
