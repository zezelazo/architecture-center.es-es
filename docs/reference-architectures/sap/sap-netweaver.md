---
title: Implementación de SAP NetWeaver (Windows) para AnyDB en máquinas virtuales de Azure
titleSuffix: Azure Reference Architectures
description: Prácticas probadas para ejecutar SAP S/4HANA en un entorno de Linux en Azure con alta disponibilidad.
author: lbrader
ms.date: 08/03/2018
ms.custom: seodec18
ms.openlocfilehash: ace5348ccb32299b2f4167b3d384ba72972ca9ad
ms.sourcegitcommit: bb7fcffbb41e2c26a26f8781df32825eb60df70c
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/20/2018
ms.locfileid: "53644026"
---
# <a name="deploy-sap-netweaver-windows-for-anydb-on-azure-virtual-machines"></a><span data-ttu-id="b9ee7-103">Implementación de SAP NetWeaver (Windows) para AnyDB en máquinas virtuales de Azure</span><span class="sxs-lookup"><span data-stu-id="b9ee7-103">Deploy SAP NetWeaver (Windows) for AnyDB on Azure virtual machines</span></span>

<span data-ttu-id="b9ee7-104">Esta arquitectura de referencia muestra un conjunto de prácticas probadas para ejecutar SAP NetWeaver en un entorno Windows en Azure con alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-104">This reference architecture shows a set of proven practices for running SAP NetWeaver in a Windows environment on Azure with high availability.</span></span> <span data-ttu-id="b9ee7-105">La base de datos es AnyDB, el término de SAP para todos los sistemas de administración de bases de datos compatibles que no sean SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-105">The database is AnyDB, the SAP term for any supported DBMS besides SAP HANA.</span></span> <span data-ttu-id="b9ee7-106">Esta arquitectura se implementa con tamaños de máquina virtual (VM) específicos que se pueden cambiar para acomodarse a las necesidades de la organización.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-106">This architecture is deployed with specific virtual machine (VM) sizes that can be changed to accommodate your organization's needs.</span></span>

![Arquitectura de referencia para SAP NetWeaver (Windows) para AnyDB en máquinas virtuales de Azure](./images/sap-netweaver.png)

<span data-ttu-id="b9ee7-108">*Descargue un [archivo Visio][visio-download] de esta arquitectura.*</span><span class="sxs-lookup"><span data-stu-id="b9ee7-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="b9ee7-109">La implementación de esta arquitectura de referencia requiere licencias adecuadas de los productos de SAP y de otras tecnologías que no son de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-109">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span>

## <a name="architecture"></a><span data-ttu-id="b9ee7-110">Arquitectura</span><span class="sxs-lookup"><span data-stu-id="b9ee7-110">Architecture</span></span>

<span data-ttu-id="b9ee7-111">La arquitectura consta de la siguiente infraestructura y los siguientes componentes de software clave.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-111">The architecture consists of the following infrastructure and key software components.</span></span>

<span data-ttu-id="b9ee7-112">**Red virtual**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-112">**Virtual network**.</span></span> <span data-ttu-id="b9ee7-113">El servicio de Azure Virtual Network conecta los recursos de Azure entre sí de forma segura.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-113">The Azure Virtual Network service securely connects Azure resources to each other.</span></span> <span data-ttu-id="b9ee7-114">En esta arquitectura, la red virtual se conecta a un entorno local a través de una puerta de enlace de VPN implementada en el concentrador de una topología en estrella tipo [hub-spoke](../hybrid-networking/hub-spoke.md).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-114">In this architecture, the virtual network connects to an on-premises environment through a VPN gateway deployed in the hub of a [hub-spoke](../hybrid-networking/hub-spoke.md).</span></span> <span data-ttu-id="b9ee7-115">El radio es la red virtual que se usa tanto para las aplicaciones de SAP como para el nivel de base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-115">The spoke is the virtual network used for the SAP applications and database tier.</span></span>

<span data-ttu-id="b9ee7-116">**Subredes**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-116">**Subnets**.</span></span> <span data-ttu-id="b9ee7-117">La red virtual se divide a su vez en subredes independientes para cada nivel: aplicación (SAP NetWeaver), base de datos, servicios compartidos (JumpBox) y Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-117">The virtual network is subdivided into separate subnets for each tier: application (SAP NetWeaver), database, shared services (the jumpbox), and Active Directory.</span></span>

<span data-ttu-id="b9ee7-118">**Máquinas virtuales**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-118">**Virtual machines**.</span></span> <span data-ttu-id="b9ee7-119">Esta arquitectura usa para la capa de aplicación y el nivel de base de datos máquinas virtuales agrupadas como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="b9ee7-119">This architecture uses virtual machines for the application tier and database tier, grouped as follows:</span></span>

- <span data-ttu-id="b9ee7-120">**SAP NetWeaver**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-120">**SAP NetWeaver**.</span></span> <span data-ttu-id="b9ee7-121">La capa de aplicación usa máquinas virtuales de Windows y ejecuta tanto SAP Central Services como los servidores de aplicaciones de SAP.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-121">The application tier uses Windows virtual machines and runs SAP Central Services and SAP application servers.</span></span> <span data-ttu-id="b9ee7-122">Las máquinas virtuales que ejecutan Central Services están configurados como un Clúster de conmutación por error de Windows Server para poder ofrecer alta disponibilidad y son compatibles con SIOS DataKeeper Cluster Edition.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-122">The VMs that run Central Services are configured as a Windows Server Failover Cluster for high availability, supported by SIOS DataKeeper Cluster Edition.</span></span>
- <span data-ttu-id="b9ee7-123">**AnyDB**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-123">**AnyDB**.</span></span> <span data-ttu-id="b9ee7-124">El nivel de base de datos ejecuta AnyDB como base de datos de origen, como Microsoft SQL Server, Oracle o IBM DB2.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-124">The database tier runs AnyDB as the source database, such as Microsoft SQL Server, Oracle, or IBM DB2.</span></span>
- <span data-ttu-id="b9ee7-125">**JumpBox**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-125">**Jumpbox**.</span></span> <span data-ttu-id="b9ee7-126">También se denomina bastion host.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-126">Also called a bastion host.</span></span> <span data-ttu-id="b9ee7-127">Se trata de una máquina virtual segura en la red que usan los administradores para conectarse al resto de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-127">This is a secure virtual machine on the network that administrators use to connect to the other virtual machines.</span></span>
- <span data-ttu-id="b9ee7-128">**Controladores de dominio de Windows Server Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-128">**Windows Server Active Directory domain controllers**.</span></span> <span data-ttu-id="b9ee7-129">Los controladores de dominio se utilizan en todas las máquinas virtuales y usuarios del dominio.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-129">The domain controllers are used on all VMs and users in the domain.</span></span>

<span data-ttu-id="b9ee7-130">**Equilibradores de carga.**</span><span class="sxs-lookup"><span data-stu-id="b9ee7-130">**Load balancers**.</span></span> <span data-ttu-id="b9ee7-131">Las instancias de [Azure Load Balancer](/azure/load-balancer/load-balancer-overview) se utilizan para distribuir el tráfico a las máquinas virtuales en la subred de la capa de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-131">[Azure Load Balancer](/azure/load-balancer/load-balancer-overview) instances are used to distribute traffic to virtual machines in the application tier subnet.</span></span> <span data-ttu-id="b9ee7-132">En la capa de datos, se puede lograr alta disponibilidad mediante equilibradores de carga SAP integrados, Azure Load Balancer u otros mecanismos, dependiendo del DBMS.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-132">At the data tier, high availability may be achieved using built-in SAP load balancers, Azure Load Balancer, or other mechanisms, depending on the DBMS.</span></span> <span data-ttu-id="b9ee7-133">Para más información, consulte [Implementación de DBMS en Azure Virtual Machines para SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-133">For more information, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span>

<span data-ttu-id="b9ee7-134">**Conjuntos de disponibilidad**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-134">**Availability sets**.</span></span> <span data-ttu-id="b9ee7-135">En las máquinas virtuales de SAP Web Dispatcher, el servidor de aplicaciones de SAP y (A)SCS, los roles se agrupan en [conjuntos de disponibilidad](/azure/virtual-machines/windows/tutorial-availability-sets) independientes y se aprovisionan un mínimo de dos máquinas virtuales por rol,</span><span class="sxs-lookup"><span data-stu-id="b9ee7-135">Virtual machines for the SAP Web Dispatcher, SAP application server, and (A)SCS, roles are grouped into separate [availability sets](/azure/virtual-machines/windows/tutorial-availability-sets), and at least two virtual machines are provisioned per role.</span></span> <span data-ttu-id="b9ee7-136">lo que hace que las máquinas virtuales sean aptas para un [Acuerdo de Nivel de Servicio](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA) mayor.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-136">This makes the virtual machines eligible for a higher [service level agreement](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA).</span></span>

<span data-ttu-id="b9ee7-137">**NIC**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-137">**NICs**.</span></span> <span data-ttu-id="b9ee7-138">Las [tarjetas de interfaz de red](/azure/virtual-network/virtual-network-network-interface) (NIC) permiten la comunicación de las máquinas virtuales en una red virtual.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-138">[Network interface cards](/azure/virtual-network/virtual-network-network-interface) (NICs) enable all communication of virtual machines on a virtual network.</span></span>

<span data-ttu-id="b9ee7-139">**Grupos de seguridad de red**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-139">**Network security groups**.</span></span> <span data-ttu-id="b9ee7-140">Para restringir el tráfico restringir el tráfico de entrada, de salida e interno de las subredes en la red virtual, se pueden crear [grupos de seguridad de red](/azure/virtual-network/virtual-networks-nsg) (NSG).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-140">To restrict incoming, outgoing, and intra-subnet traffic in the virtual network, you can create [network security groups](/azure/virtual-network/virtual-networks-nsg) (NSGs).</span></span>

<span data-ttu-id="b9ee7-141">**Puerta de enlace**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-141">**Gateway**.</span></span> <span data-ttu-id="b9ee7-142">Una puerta de enlace extiende una red local a la red virtual de Azure.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-142">A gateway extends your on-premises network to the Azure virtual network.</span></span> <span data-ttu-id="b9ee7-143">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) es el servicio de Azure recomendado para crear conexiones privadas que no atraviesen Internet, pero también se puede usar una conexión de [sitio a sitio](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-143">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) is the recommended Azure service for creating private connections that do not go over the public Internet, but a [Site-to-Site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal) connection can also be used.</span></span>

<span data-ttu-id="b9ee7-144">**Azure Storage**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-144">**Azure Storage**.</span></span> <span data-ttu-id="b9ee7-145">Para proporcionar un almacenamiento persistente de disco duro virtual (VHD) de una máquina virtual, se requiere [Azure Storage](/azure/storage/storage-standard-storage).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-145">To provide persistent storage of a virtual machine's virtual hard disk (VHD), [Azure Storage](/azure/storage/storage-standard-storage) is required.</span></span> <span data-ttu-id="b9ee7-146">También lo usa [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) para implementar una operación de un clúster de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-146">It is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to implement a failover cluster operation.</span></span>

## <a name="recommendations"></a><span data-ttu-id="b9ee7-147">Recomendaciones</span><span class="sxs-lookup"><span data-stu-id="b9ee7-147">Recommendations</span></span>

<span data-ttu-id="b9ee7-148">Los requisitos pueden diferir de los de la arquitectura que se describe aquí.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-148">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="b9ee7-149">Use estas recomendaciones como punto de partida.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-149">Use these recommendations as a starting point.</span></span>

### <a name="sap-web-dispatcher-pool"></a><span data-ttu-id="b9ee7-150">Grupo de SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="b9ee7-150">SAP Web Dispatcher pool</span></span>

<span data-ttu-id="b9ee7-151">El componente Web Dispatcher se usa como equilibrador de carga para el tráfico SAP que circula entre los servidores de aplicaciones de SAP.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-151">The Web Dispatcher component is used as a load balancer for SAP traffic among the SAP application servers.</span></span> <span data-ttu-id="b9ee7-152">Para lograr una alta disponibilidad para el componente Web Dispatcher, se usa Azure Load Balancer para implementar la configuración paralela de Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-152">To achieve high availability for the Web Dispatcher component, Azure Load Balancer is used to implement the parallel Web Dispatcher setup.</span></span> <span data-ttu-id="b9ee7-153">Web Dispatcher se utiliza en una configuración round robin para la distribución del tráfico HTTP(S) entre los distribuidores web disponibles en el grupo de equilibradores.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-153">Web Dispatcher uses in a round-robin configuration for HTTP(S) traffic distribution among the available Web Dispatchers in the balancers pool.</span></span>

<span data-ttu-id="b9ee7-154">Para más información acerca de la ejecución de SAP NetWeaver en Azure Virtual Machines, consulte [Planeación e implementación de Azure Virtual Machines para SAP en NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-154">For details about running SAP NetWeaver in Azure VMs, see [Azure Virtual Machines planning and implementation for SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span></span>

### <a name="application-servers-pool"></a><span data-ttu-id="b9ee7-155">Grupo de servidores de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="b9ee7-155">Application servers pool</span></span>

<span data-ttu-id="b9ee7-156">Para administrar grupos de inicio de sesión para servidores de aplicaciones de ABAP, se utiliza la transacción SMLG.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-156">To manage logon groups for ABAP application servers, the SMLG transaction is used.</span></span> <span data-ttu-id="b9ee7-157">Usa la función de equilibrio de carga en el servidor de mensajes de Central Services para distribuir la carga de trabajo entre el grupo de servidores de aplicaciones de SAP para SAPGUI y el tráfico de RFC.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-157">It uses the load balancing function within the message server of the Central Services to distribute workload among SAP application servers pool for SAPGUIs and RFC traffic.</span></span> <span data-ttu-id="b9ee7-158">La conexión de servidor de aplicaciones para Central Services de alta disponibilidad se realiza a través del nombre de la red virtual del clúster.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-158">The application server connection to the highly available Central Services is through the cluster virtual network name.</span></span>

### <a name="sap-central-services-cluster"></a><span data-ttu-id="b9ee7-159">Clúster de SAP Central Services</span><span class="sxs-lookup"><span data-stu-id="b9ee7-159">SAP Central Services cluster</span></span>

<span data-ttu-id="b9ee7-160">Esta arquitectura de referencia ejecuta Central Services en máquinas virtuales en la capa de aplicación.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-160">This reference architecture runs Central Services on VMs in the application tier.</span></span> <span data-ttu-id="b9ee7-161">Central Services es un posible único punto de error (SPOF) cuando se implementa en una sola máquina virtual (que es la implementación más habitual cuando la alta disponibilidad no es un requisito).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-161">The Central Services is a potential single point of failure (SPOF) when deployed to a single VM—typical deployment when high availability is not a requirement.</span></span> <span data-ttu-id="b9ee7-162">Para implementar una solución de alta disponibilidad, se pueden utilizar un clúster de disco compartido o en un clúster de recurso compartido de archivos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-162">To implement a high availability solution, either a shared disk cluster or a file share cluster can be used.</span></span>

<span data-ttu-id="b9ee7-163">Para configurar las máquinas virtuales para un clúster de disco compartido, use [Windows Server Failover Cluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-163">To configure VMs for a shared disk cluster, use [Windows Server Failover Cluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span></span> <span data-ttu-id="b9ee7-164">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) se recomienda como testigo de cuórum.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-164">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) is recommended as a quorum witness.</span></span> <span data-ttu-id="b9ee7-165">Para admitir el entorno del clúster de conmutación por error, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) realiza la función de volumen compartido de clústeres mediante la replicación de discos independientes que pertenecen a los nodos del clúster.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-165">To support the failover cluster environment, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) performs the cluster shared volume function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="b9ee7-166">Azure no admite de forma nativa discos compartidos y, por consiguiente, requiere las soluciones que proporciona SIOS.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-166">Azure does not natively support shared disks and therefore requires solutions provided by SIOS.</span></span>

<span data-ttu-id="b9ee7-167">Para obtener información, consulte "3.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-167">For details, see "3.</span></span> <span data-ttu-id="b9ee7-168">Important Update for SAP Customers Running ASCS on SIOS on Azure” (Actualización importante para clientes de SAP que ejecuten ASCS en SIOS en Azure) en [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/) (Ejecución de aplicaciones SAP en la plataforma Microsoft).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-168">Important Update for SAP Customers Running ASCS on SIOS on Azure” at [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/).</span></span>

<span data-ttu-id="b9ee7-169">Otra forma de controlar la agrupación en clústeres es implementar un clúster de recurso compartido de archivos mediante Windows Server Failover Cluster.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-169">Another way to handle clustering is to implement a file share cluster using Windows Server Failover Cluster.</span></span> <span data-ttu-id="b9ee7-170">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) ha modificado recientemente el modelo de implementación de Central Services para acceder a los directorios globales de /sapmnt a través de una ruta de acceso UNC.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-170">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) recently modified the Central Services deployment pattern to access the /sapmnt global directories via a UNC path.</span></span> <span data-ttu-id="b9ee7-171">Este cambio [elimina la necesidad](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) de SIOS u otras soluciones de disco compartido en las máquinas virtuales de Central Services.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-171">This change [removes the requirement](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) for SIOS or other shared disk solutions on the Central Services VMs.</span></span> <span data-ttu-id="b9ee7-172">Sigue siendo recomendable asegurarse de que el recurso compartido UNC /sapmnt tiene [alta disponibilidad](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-172">It is still recommended to ensure that the /sapmnt UNC share is [highly available](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span></span> <span data-ttu-id="b9ee7-173">Esto se puede realizar en la instancia de Central Services mediante Windows Server Failover Cluster con las características [Servidor de archivos de escalabilidad horizontal](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) y [Espacios de almacenamiento directo ](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) (S2D) en Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-173">This can be done on the Central Services instance by using Windows Server Failover Cluster with [Scale Out File Server](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) and the [Storage Spaces Direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) (S2D) feature in Windows Server 2016.</span></span>

### <a name="availability-sets"></a><span data-ttu-id="b9ee7-174">Conjuntos de disponibilidad</span><span class="sxs-lookup"><span data-stu-id="b9ee7-174">Availability sets</span></span>

<span data-ttu-id="b9ee7-175">Los conjuntos de disponibilidad distribuyen los servidores en distintos grupos físicos de actualización y de infraestructura físicos para mejorar la disponibilidad del servicio.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-175">Availability sets distribute servers to different physical infrastructure and update groups to improve service availability.</span></span> <span data-ttu-id="b9ee7-176">La colocación de máquinas virtuales que realicen el mismo rol en conjuntos de disponibilidad ayudan a protegerse contra el tiempo de inactividad que provoca el mantenimiento de la infraestructura de Azure y a cumplir los[Acuerdos de Nivel de Servicio](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-176">Put virtual machines that perform the same role into an availability sets to help guard against downtime caused by Azure infrastructure maintenance and to meet [SLAs](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLAs).</span></span> <span data-ttu-id="b9ee7-177">Se recomiendan dos, o más, máquinas virtuales por conjunto de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-177">Two or more virtual machines per availability set is recommended.</span></span>

<span data-ttu-id="b9ee7-178">Todas las máquinas virtuales de un conjunto deben realizar el misma rol.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-178">All virtual machines in a set must perform the same role.</span></span> <span data-ttu-id="b9ee7-179">No mezcle servidores de distintos roles en el mismo conjunto de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-179">Do not mix servers of different roles in the same availability set.</span></span> <span data-ttu-id="b9ee7-180">Por ejemplo, no coloque un nodo de Central Services en el mismo conjunto de disponibilidad que el servidor de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-180">For example, don't place a Central Services node in the same availability set with the application server.</span></span>

### <a name="nics"></a><span data-ttu-id="b9ee7-181">Tarjetas de red</span><span class="sxs-lookup"><span data-stu-id="b9ee7-181">NICs</span></span>

<span data-ttu-id="b9ee7-182">En las implementaciones de SAP locales tradicionales se implementan varias tarjetas de interfaz de red (NIC) por máquina para aislar el tráfico administrativo del tráfico del negocio.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-182">Traditional on-premises SAP deployments implement multiple network interface cards (NICs) per machine to segregate administrative traffic from business traffic.</span></span> <span data-ttu-id="b9ee7-183">En Azure, la red virtual es una red definida por el software que envía todo el tráfico a través del mismo tejido de red.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-183">On Azure, the virtual network is a software-defined network that sends all traffic through the same network fabric.</span></span> <span data-ttu-id="b9ee7-184">Por tanto, no es necesario el uso de varias tarjetas de interfaz de red.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-184">Therefore, the use of multiple NICs is unnecessary.</span></span> <span data-ttu-id="b9ee7-185">Sin embargo, si su organización necesita separar el tráfico, puede implementar varias tarjetas de interfaz de red por máquina virtual, conecte cada una de ellas a una subred diferente y, después, use los grupos de seguridad de red para aplicar las distintas directivas de control de acceso.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-185">However, if your organization needs to segregate traffic, you can deploy multiple NICs per VM, connect each NIC to a different subnet, and then use NSGs to enforce different access control policies.</span></span>

### <a name="subnets-and-nsgs"></a><span data-ttu-id="b9ee7-186">Subredes y grupos de seguridad de red</span><span class="sxs-lookup"><span data-stu-id="b9ee7-186">Subnets and NSGs</span></span>

<span data-ttu-id="b9ee7-187">Esta arquitectura divide el espacio de direcciones de la red virtual en subredes.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-187">This architecture subdivides the virtual network address space into subnets.</span></span> <span data-ttu-id="b9ee7-188">Esta arquitectura de referencia se centra principalmente en la subred de la capa de aplicación.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-188">This reference architecture focuses primarily on the application tier subnet.</span></span> <span data-ttu-id="b9ee7-189">Cada subred se puede asociar con un grupo de seguridad de red que define las directivas de acceso para la subred.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-189">Each subnet can be associated with a NSG that defines the access policies for the subnet.</span></span> <span data-ttu-id="b9ee7-190">Coloque los servidores de aplicaciones en una subred independiente para poder protegerlos más fácilmente mediante la administración de las directivas de seguridad de la subred, no de los servidores individuales.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-190">Place application servers on a separate subnet so you can secure them more easily by managing the subnet security policies, not the individual servers.</span></span>

<span data-ttu-id="b9ee7-191">Cuando un grupo de seguridad de red se asocia a una subred, se aplica a todos los servidores de esta.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-191">When a NSG is associated with a subnet, it applies to all the servers within the subnet.</span></span> <span data-ttu-id="b9ee7-192">Para más información acerca del uso de los grupos de seguridad de red para tener un control específico sobre los servidores de una subred, consulte [Filtro del tráfico de red con grupos de seguridad de red](https://azure.microsoft.com/en-us/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-192">For more information about using NSGs for fine-grained control over the servers in a subnet, see [Filter network traffic with network security groups](https://azure.microsoft.com/en-us/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span></span>

### <a name="load-balancers"></a><span data-ttu-id="b9ee7-193">Equilibradores de carga</span><span class="sxs-lookup"><span data-stu-id="b9ee7-193">Load balancers</span></span>

<span data-ttu-id="b9ee7-194">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) controla el equilibrio de carga del tráfico HTTP(S) en un grupo de servidores de aplicaciones SAP.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-194">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) handles load balancing of HTTP(S) traffic to a pool of SAP application servers.</span></span>

<span data-ttu-id="b9ee7-195">Para el tráfico de clientes de la GUI de SAP que se conectan a un servidor SAP a través del protocolo DIAG o de instancias de Remote Function Call (RFC), el servidor de mensajes de Central Services equilibra la carga a través de los [grupos de inicio de sesión](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing) del servidor de aplicaciones de SAP, por lo que se necesita un equilibrador de carga adicional.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-195">For traffic from SAP GUI clients connecting a SAP server via DIAG protocol or Remote Function Calls (RFC), the Central Services message server balances the load through SAP application server [logon groups](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing), so no additional load balancer is needed.</span></span>

### <a name="azure-storage"></a><span data-ttu-id="b9ee7-196">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="b9ee7-196">Azure Storage</span></span>

<span data-ttu-id="b9ee7-197">En todas las máquinas virtuales del servidor de bases de datos, se recomienda utilizar Azure Premium Storage para que la latencia de lectura y escritura sea consistente.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-197">For all database server virtual machines, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="b9ee7-198">En el caso de cualquier máquina virtual de una sola instancia que use Premium Storage para todos los discos del sistema operativo y discos de datos, consulte [Contrato de nivel de servicio para Virtual Machines](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-198">For any single instance virtual machine using Premium Storage for all operating system disks and data disks, see [SLA for Virtual Machines](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span></span> <span data-ttu-id="b9ee7-199">Además, en el caso de los sistemas SAP de producción, es aconsejable usar [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) Premium en todos los casos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-199">Also, for production SAP systems, we recommend using Premium [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) in all cases.</span></span> <span data-ttu-id="b9ee7-200">Por confiabilidad, se usan discos administrados para administrar los archivos de VHD en los discos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-200">For reliability, Managed Disks are used to manage the VHD files for the disks.</span></span> <span data-ttu-id="b9ee7-201">Los discos administrados garantizan que los discos de las máquinas virtuales de un conjunto de disponibilidad están aislados, con el fin de evitar únicos puntos de error.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-201">Managed disks ensure that the disks for virtual machines within an availability set are isolated to avoid single points of failure.</span></span>

<span data-ttu-id="b9ee7-202">En el caso de los servidores de aplicaciones SAP, lo que incluye las máquinas virtuales de Central Services, puede usar Azure Standard Storage para reducir el costo, ya que la aplicación se ejecuta en la memoria y los discos solo se usan para el registro.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-202">For SAP application servers, including the Central Services virtual machines, you can use Azure Standard Storage to reduce cost, because application execution takes place in memory and disks are used for logging only.</span></span> <span data-ttu-id="b9ee7-203">Sin embargo, en este momento, Standard Storage solo está certificado para el almacenamiento no administrado.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-203">However, at this time, Standard Storage is only certified for unmanaged storage.</span></span> <span data-ttu-id="b9ee7-204">Puesto que los servidores de aplicaciones no hospeda ningún dato, también puede usar los discos de P4 y almacenamiento de Premium P6 más pequeños para ayudar a minimizar el costo.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-204">Since application servers do not host any data, you can also use the smaller P4 and P6 Premium Storage disks to help minimize cost.</span></span>

<span data-ttu-id="b9ee7-205">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) también usa Azure Storage para mantener el cuórum con un dispositivo de una región remota de Azure alejada de la región primaria en la que residen el clúster.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-205">Azure Storage is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to maintain quorum with a device in a remote Azure region away from the primary region where the cluster resides.</span></span>

<span data-ttu-id="b9ee7-206">En el almacén de datos de copia de seguridad, se recomienda utilizar el [nivel de almacenamiento esporádico](/azure/storage/storage-blob-storage-tiers) y el [almacenamiento de nivel de acceso de archivo](/azure/storage/storage-blob-storage-tiers) de Azure.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-206">For the backup data store, we recommend using Azure [coolaccess tier](/azure/storage/storage-blob-storage-tiers) and [archive access tier storage](/azure/storage/storage-blob-storage-tiers).</span></span> <span data-ttu-id="b9ee7-207">Estos niveles de almacenamiento son formas rentables de almacenamiento de datos de larga duración a los que se accede con poca frecuencia.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-207">These storage tiers are cost-effective ways to store long-lived data that is infrequently accessed.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="b9ee7-208">Consideraciones sobre rendimiento</span><span class="sxs-lookup"><span data-stu-id="b9ee7-208">Performance considerations</span></span>

<span data-ttu-id="b9ee7-209">Los servidores de aplicaciones SAP establecen comunicaciones constantes con los servidores de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-209">SAP application servers carry on constant communications with the database servers.</span></span> <span data-ttu-id="b9ee7-210">En el caso de las aplicaciones con un rendimiento crítico que se ejecutan en cualquier plataforma de base datos, entre las que se incluye SAP HANA, considere la posibilidad de habilitar el [acelerador de escritura](/azure/virtual-machines/linux/how-to-enable-write-accelerator) para mejorar la latencia de la escritura de registro.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-210">For performance-critical applications running on any database platforms, including SAP HANA, consider enabling [Write Accelerator](/azure/virtual-machines/linux/how-to-enable-write-accelerator) to improve log write latency.</span></span> <span data-ttu-id="b9ee7-211">Para optimizar las comunicaciones entre servidores, utilice la [red acelerada](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-211">To optimize inter-server communications, use the [Accelerated Network](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span></span> <span data-ttu-id="b9ee7-212">Tenga en cuenta que estos aceleradores solo están disponibles para determinadas series de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-212">Note that these accelerators are available only for certain VM series.</span></span>

<span data-ttu-id="b9ee7-213">Para lograr un rendimiento del ancho de banda de disco y un IOPS altos, las prácticas habituales de [optimización del rendimiento](/azure/virtual-machines/windows/premium-storage-performance) del volumen de almacenamiento se aplican al diseño de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-213">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume [performance optimization](/azure/virtual-machines/windows/premium-storage-performance) apply to Azure storage layout.</span></span> <span data-ttu-id="b9ee7-214">Por ejemplo, la combinación de varios discos para crear un volumen de disco con secciones mejora el rendimiento de E/S.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-214">For example, combining multiple disks together to create a striped disk volume improves IO performance.</span></span> <span data-ttu-id="b9ee7-215">La habilitación de la caché de lectura en el contenido de almacenamiento que cambia con poca frecuencia mejora la velocidad de recuperación de datos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-215">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span>

<span data-ttu-id="b9ee7-216">En el caso de SAP en SQL, el blog [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) (Diez consideraciones clave para implementar aplicaciones SAP en Azure) ofrece un consejos excelentes para optimizar Azure Storage para las cargas de trabajo SAP en SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-216">For SAP on SQL, the [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) blog offers excellent advice on optimizing Azure storage for SAP workloads on SQL Server.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="b9ee7-217">Consideraciones sobre escalabilidad</span><span class="sxs-lookup"><span data-stu-id="b9ee7-217">Scalability considerations</span></span>

<span data-ttu-id="b9ee7-218">En el nivel de aplicación de SAP, Azure ofrece una amplia variedad de tamaños de máquina virtual tanto para el escalado vertical como para el horizontal. Para ver una lista inclusiva, consulte [Nota de SAP 1928533](https://launchpad.support.sap.com/#/notes/1928533): SAP Applications on Azure: Supported Products and Azure VM Types" (Aplicaciones de SAP en Azure: productos y tipos de máquina virtual de Azure compatibles).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-218">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up and scaling out. For an inclusive list, see [SAP note 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM Types.</span></span> <span data-ttu-id="b9ee7-219">(para acceder se requiere una cuenta de SAP Service Marketplace).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-219">(SAP Service Marketplace account required for access).</span></span> <span data-ttu-id="b9ee7-220">Tanto los servidores de aplicaciones SAP como los clústeres de Central Services pueden realizar escalados y reducciones verticales o escalados horizontales mediante la adición de más instancias.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-220">SAP application servers and the Central Services clusters can scale up/down or scale out by adding more instances.</span></span> <span data-ttu-id="b9ee7-221">La base de datos de AnyDB puede realizar escalados y reducciones verticales, pero no escalados horizontales. El contenedor de base de datos SAP para AnyDB no admite el particionamiento.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-221">The AnyDB database can scale up/down but does not scale out. The SAP database container for AnyDB does not support sharding.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="b9ee7-222">Consideraciones sobre disponibilidad</span><span class="sxs-lookup"><span data-stu-id="b9ee7-222">Availability considerations</span></span>

<span data-ttu-id="b9ee7-223">La redundancia de recursos es el tema general en las soluciones de infraestructura de alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-223">Resource redundancy is the general theme in highly available infrastructure solutions.</span></span> <span data-ttu-id="b9ee7-224">Para las empresas que tienen un Acuerdo de Nivel de Servicio menos estrictos, las máquinas virtuales de Azure de instancia única ofrecen un SLA de tiempo de actividad.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-224">For enterprises that have a less stringent SLA, single-instance Azure VMs offer an uptime SLA.</span></span> <span data-ttu-id="b9ee7-225">Para más información, consulte [Contratos de nivel de servicio](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-225">For more information, see [Azure Service Level Agreement](https://azure.microsoft.com/support/legal/sla/).</span></span>

<span data-ttu-id="b9ee7-226">En esta instalación distribuida de la aplicación SAP, la instalación base se replica para lograr una alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-226">In this distributed installation of the SAP application, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="b9ee7-227">Para cada capa de la arquitectura, el diseño de la alta disponibilidad varía.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-227">For each layer of the architecture, the high availability design varies.</span></span>

### <a name="application-tier"></a><span data-ttu-id="b9ee7-228">Capa de aplicación</span><span class="sxs-lookup"><span data-stu-id="b9ee7-228">Application tier</span></span>

<span data-ttu-id="b9ee7-229">La alta disponibilidad de SAP Web Dispatcher se logra mediante instancias redundantes.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-229">High availability for SAP Web Dispatcher is achieved with redundant instances.</span></span> <span data-ttu-id="b9ee7-230">Consulte [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) en la documentación de SAP.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-230">See [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) in the SAP Documentation.</span></span>

<span data-ttu-id="b9ee7-231">La alta disponibilidad de Central Services se implementa con Windows Server Failover Cluster.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-231">High availability of the Central Services is implemented with Windows Server Failover Cluster.</span></span> <span data-ttu-id="b9ee7-232">Cuando se implementa en Azure, el almacenamiento de clúster del clúster de conmutación por error puede configurarse mediante dos métodos: un volumen compartido en clústeres o un recurso compartido de archivos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-232">When deployed on Azure, the cluster storage for the failover cluster can be configured using two approaches: either a clustered shared volume or a file share.</span></span>

<span data-ttu-id="b9ee7-233">Dado que los discos compartidos no son posibles en Azure, se usa SIOS Datakeeper para replicar el contenido de los discos independientes conectados a los nodos del clúster y para resumir las unidades de disco como un volumen compartido de clústeres para el Administrador de clústeres.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-233">Since shared disks are not possible on Azure, SIOS Datakeeper is used to replicate the content of independent disks attached to the cluster nodes and to abstract the drives as a cluster shared volume for the cluster manager.</span></span> <span data-ttu-id="b9ee7-234">Para obtener detalles acerca de la implementación, consulte [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/) (Agrupación de SAP ASCS en clústeres en Azure).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-234">For implementation details, see [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/).</span></span>

<span data-ttu-id="b9ee7-235">Otra opción consiste en usar un recurso compartido de archivos servido por [Scale Out Fileserver](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-235">Another option is to use a file share served up by the [Scale Out Fileserver](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS).</span></span> <span data-ttu-id="b9ee7-236">SOFS ofrece recursos compartidos de archivos resistentes que se puede usar como volumen compartido de clústeres para el clúster de Windows.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-236">SOFS offers resilient file shares you can use as a cluster shared volume for the Windows cluster.</span></span> <span data-ttu-id="b9ee7-237">Un clúster de SOFS se puede compartir entre varios nodos de Central Services.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-237">A SOFS cluster can be shared among multiple Central Services nodes.</span></span> <span data-ttu-id="b9ee7-238">En el momento de redacción de este documento, SOFS se usa solo para el diseño de alta disponibilidad, ya que el clúster de SOFS no se extiende entre regiones para proporcionar soporte para la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-238">As of this writing, SOFS is used only for high availability design, because the SOFS cluster does not extend across regions to provide disaster recovery support.</span></span>

<span data-ttu-id="b9ee7-239">La alta disponibilidad para los servidores de aplicaciones SAP se logra mediante el equilibrio de carga del tráfico dentro de un grupo de servidores de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-239">High availability for the SAP application servers is achieved by load balancing traffic within a pool of application servers.</span></span>
<span data-ttu-id="b9ee7-240">Consulte [Configuraciones y certificaciones de SAP que se ejecutan en Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-240">See [SAP certifications and configurations running on Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span></span>

### <a name="database-tier"></a><span data-ttu-id="b9ee7-241">Nivel de base de datos</span><span class="sxs-lookup"><span data-stu-id="b9ee7-241">Database tier</span></span>

<span data-ttu-id="b9ee7-242">Esta arquitectura de referencia asume que la base de datos de origen se ejecuta en AnyDB (es decir, un DBMS, como SQL Server, SAP ASE, IBM DB2 u Oracle).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-242">This reference architecture assumes the source database is running on AnyDB—that is, a DBMS such as SQL Server, SAP ASE, IBM DB2, or Oracle.</span></span> <span data-ttu-id="b9ee7-243">La característica de replicación nativa del nivel de base de datos proporciona conmutación automática por error manual o automática entre los nodos replicados.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-243">The database tier's native replication feature provides either manual or automatic failover between replicated nodes.</span></span>

<span data-ttu-id="b9ee7-244">Para obtener detalles de la implementación de los sistemas de base de datos específicos, consulte [Implementación de DBMS de Azure Virtual Machines para SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-244">For implementation details about specific database systems, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span>

## <a name="disaster-recovery-considerations"></a><span data-ttu-id="b9ee7-245">Consideraciones acerca de la recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="b9ee7-245">Disaster recovery considerations</span></span>

<span data-ttu-id="b9ee7-246">Para la recuperación ante desastres (DR), debe ser capaz de realizar la conmutación por error en una región secundaria.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-246">For disaster recovery (DR), you must be able to fail over to a secondary region.</span></span> <span data-ttu-id="b9ee7-247">Cada nivel utiliza una estrategia diferente para proporcionar protección mediante la recuperación ante desastres (DR).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-247">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="b9ee7-248">**Nivel de servidores de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-248">**Application servers tier**.</span></span> <span data-ttu-id="b9ee7-249">Los servidores de aplicaciones de SAP no contienen datos empresariales.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-249">SAP application servers do not contain business data.</span></span> <span data-ttu-id="b9ee7-250">En Azure, una estrategia de recuperación ante desastres simple es crear servidores de aplicaciones SAP en la región secundaria y apagarlos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-250">On Azure, a simple DR strategy is to create SAP application servers in the secondary region, then shut them down.</span></span> <span data-ttu-id="b9ee7-251">Tras cualquier cambio de configuración o actualización del kernel en el servidor de aplicaciones principal, los mismos cambios se deben copiar en las máquinas virtuales de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-251">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to the virtual machines in the secondary region.</span></span> <span data-ttu-id="b9ee7-252">Por ejemplo, los archivos ejecutables del kernel copiados en las máquinas virtuales de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-252">For example, the kernel executables copied to the DR virtual machines.</span></span> <span data-ttu-id="b9ee7-253">Para la replicación automática de los servidores de aplicaciones en una región secundaria, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) es la solución recomendada.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-253">For automatic replication of application servers to a secondary region, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) is the recommended solution.</span></span>

- <span data-ttu-id="b9ee7-254">**Central Services**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-254">**Central Services**.</span></span> <span data-ttu-id="b9ee7-255">Este componente de la pila de aplicaciones SAP tampoco conserva los datos empresariales.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-255">This component of the SAP application stack also does not persist business data.</span></span> <span data-ttu-id="b9ee7-256">Puede crear una máquina virtual en la región de recuperación ante desastres para ejecutar el rol de Central Services.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-256">You can build a VM in the disaster recovery region to run the Central Services role.</span></span> <span data-ttu-id="b9ee7-257">El único contenido del nodo de Central Services principal que se sincroniza es el del recurso compartido /sapmnt.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-257">The only content from the primary Central Services node to synchronize is the /sapmnt share content.</span></span> <span data-ttu-id="b9ee7-258">Además, si los cambios de configuración o las actualizaciones del kernel tienen lugar en los servidores principales de Central Services, se deben repetir en la máquina virtual de la región de recuperación ante desastres que ejecuta Central Services.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-258">Also, if configuration changes or kernel updates take place on the primary Central Services servers, they must be repeated on the VM in the disaster recovery region running Central Services.</span></span> <span data-ttu-id="b9ee7-259">Para sincronizar los dos servidores, puede usar Azure Site Recovery para replicar los nodos del clúster o simplemente usar un trabajo de copia programado regularmente para copiar /sapmnt en la región de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-259">To synchronize the two servers, you can use either Azure Site Recovery to replicate the cluster nodes or simply use a regularly scheduled copy job to copy /sapmnt to the disaster recovery region.</span></span> <span data-ttu-id="b9ee7-260">Para más información acerca de la creación, copia y el proceso de conmutación por error de prueba de este sencillo método de replicación, descargue [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx) (SAP NetWeaver: creación de una solución de recuperación ante desastres basada en Hyper-V y Microsoft Azure) y consulte "4.3.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-260">For details about this simple replication method's build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx), and refer to "4.3.</span></span> <span data-ttu-id="b9ee7-261">Capa de SAP SPOF (ASCS)."</span><span class="sxs-lookup"><span data-stu-id="b9ee7-261">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="b9ee7-262">**Nivel de base de datos**.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-262">**Database tier**.</span></span> <span data-ttu-id="b9ee7-263">La recuperación ante desastres se implementa mejor con la tecnología de replicación integrada propia de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-263">DR is best implemented with the database's own integrated replication technology.</span></span> <span data-ttu-id="b9ee7-264">Por ejemplo, en el caso de SQL Server, se recomienda usar Grupos de disponibilidad AlwaysOn para establecer una réplica en una región remota, lo que replica las transacciones de forma asincrónica con la conmutación por error manual.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-264">In the case of SQL Server, for example, we recommend using AlwaysOn Availability Group to establish a replica in a remote region, replicating transactions asynchronously with manual failover.</span></span> <span data-ttu-id="b9ee7-265">La replicación asincrónica que el rendimiento de las cargas de trabajo interactivas del sitio principal resulte afectado.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-265">Asynchronous replication avoids an impact to the performance of interactive workloads at the primary site.</span></span> <span data-ttu-id="b9ee7-266">La conmutación por error manual ofrece la oportunidad de que una persona evalúe el impacto de recuperación ante desastres y decida si está justificada la operación desde el sitio de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-266">Manual failover offers the opportunity for a person to evaluate the DR impact and decide if operating from the DR site is justified.</span></span>

<span data-ttu-id="b9ee7-267">Para usar Azure Site Recovery para generar automáticamente un sitio de producción totalmente replicado del original, debe ejecutar [scripts de implementación](/azure/site-recovery/site-recovery-runbook-automation) personalizados.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-267">To use Azure Site Recovery to automatically build out a fully replicated production site of your original, you must run customized [deployment scripts](/azure/site-recovery/site-recovery-runbook-automation).</span></span> <span data-ttu-id="b9ee7-268">Site Recovery implementa en primer lugar las máquinas virtuales en conjuntos de disponibilidad y, después, ejecuta scripts para agregar recursos como los equilibradores de carga.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-268">Site Recovery first deploys the VMs in availability sets, then runs scripts to add resources such as load balancers.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="b9ee7-269">Consideraciones sobre la manejabilidad</span><span class="sxs-lookup"><span data-stu-id="b9ee7-269">Manageability considerations</span></span>

<span data-ttu-id="b9ee7-270">Azure proporciona varias funciones para la [supervisión y el diagnóstico](/azure/architecture/best-practices/monitoring) de la infraestructura global.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-270">Azure provides several functions for [monitoring and diagnostics](/azure/architecture/best-practices/monitoring) of the overall infrastructure.</span></span> <span data-ttu-id="b9ee7-271">Además, la supervisión mejorada de las máquinas virtuales de Azure la controla Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-271">Also, enhanced monitoring of Azure virtual machines is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="b9ee7-272">Para proporcionar supervisión basada en SAP de los recursos y del rendimiento de los servicios de la infraestructura de SAP, se usa la extensión [Azure SAP Enhanced Monitoring](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-272">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, the [Azure SAP Enhanced Monitoring](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment) extension is used.</span></span> <span data-ttu-id="b9ee7-273">Esta extensión introduce las estadísticas de supervisión de Azure en la aplicación de SAP para la supervisión de sistema operativo y las funciones de DBA Cockpit.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-273">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="b9ee7-274">Consideraciones sobre la seguridad</span><span class="sxs-lookup"><span data-stu-id="b9ee7-274">Security considerations</span></span>

<span data-ttu-id="b9ee7-275">SAP tiene su propio motor de administración de usuarios (UME) para controlar el acceso basado en rol y la autorización en la aplicación de SAP.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-275">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="b9ee7-276">Para más información, consulte [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/viewer/864321b9b3dd487d94c70f6a007b0397/7.4.19) (Guía de seguridad de SAP NetWeaver Application Server para ABAP) y [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm) (Guía de seguridad de SAP NetWeaver Application Server Java).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-276">For details, see [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/viewer/864321b9b3dd487d94c70f6a007b0397/7.4.19) and [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm).</span></span>

<span data-ttu-id="b9ee7-277">Para aumentar la seguridad de la red, considere la posibilidad de implementar un [red perimetral](../dmz/secure-vnet-hybrid.md), que utiliza una aplicación virtual de red para crear un firewall delante de la subred para Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-277">For additional network security, consider implementing a [network DMZ](../dmz/secure-vnet-hybrid.md), which uses a network virtual appliance to create a firewall in front of the subnet for Web Dispatcher.</span></span>

<span data-ttu-id="b9ee7-278">Para la seguridad de la infraestructura, los datos se cifran tanto en tránsito como en reposo.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-278">For infrastructure security, data is encrypted in transit and at rest.</span></span> <span data-ttu-id="b9ee7-279">En la sección "Security considerations" (Consideraciones de seguridad) de [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) se empieza a afrontar la seguridad de la red.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-279">The "Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) begins to address network security.</span></span> <span data-ttu-id="b9ee7-280">La guía también especifica los puertos de red que se deben abrir en los firewalls para permitir la comunicación de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-280">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span>

<span data-ttu-id="b9ee7-281">Para cifrar discos de una máquina virtual Windows, puede usar [Azure Disk Encryption](/azure/security/azure-security-disk-encryption).</span><span class="sxs-lookup"><span data-stu-id="b9ee7-281">To encrypt Windows virtual machine disks, you can use [Azure Disk Encryption](/azure/security/azure-security-disk-encryption).</span></span> <span data-ttu-id="b9ee7-282">Utiliza la característica BitLocker de Windows para proporcionar el cifrado del volumen de los discos de datos y del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-282">It uses the BitLocker feature of Windows to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="b9ee7-283">La solución también funciona con Azure Key Vault para ayudarle a controlar y administrar las claves y los secretos del cifrado de discos en la suscripción de Key Vault.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-283">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your key vault subscription.</span></span> <span data-ttu-id="b9ee7-284">Los datos de los discos de máquinas virtuales se cifran en reposo en Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-284">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

## <a name="communities"></a><span data-ttu-id="b9ee7-285">Comunidades</span><span class="sxs-lookup"><span data-stu-id="b9ee7-285">Communities</span></span>

<span data-ttu-id="b9ee7-286">Las comunidades pueden responder preguntas y ayudarle a configurar una implementación correcta.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-286">Communities can answer questions and help you set up a successful deployment.</span></span> <span data-ttu-id="b9ee7-287">Tenga en cuenta lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="b9ee7-287">Consider the following:</span></span>

- [<span data-ttu-id="b9ee7-288">Blog Ejecución de aplicaciones SAP en la plataforma de Microsoft</span><span class="sxs-lookup"><span data-stu-id="b9ee7-288">Running SAP Applications on the Microsoft Platform Blog</span></span>](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/)
- [<span data-ttu-id="b9ee7-289">Soporte técnico de la comunidad de Azure</span><span class="sxs-lookup"><span data-stu-id="b9ee7-289">Azure Community Support</span></span>](https://azure.microsoft.com/support/community/)
- [<span data-ttu-id="b9ee7-290">SAP Community</span><span class="sxs-lookup"><span data-stu-id="b9ee7-290">SAP Community</span></span>](https://www.sap.com/community.html)
- [<span data-ttu-id="b9ee7-291">Stack Overflow</span><span class="sxs-lookup"><span data-stu-id="b9ee7-291">Stack Overflow</span></span>](https://stackoverflow.com/tags/sap/)

## <a name="related-resources"></a><span data-ttu-id="b9ee7-292">Recursos relacionados</span><span class="sxs-lookup"><span data-stu-id="b9ee7-292">Related resources</span></span>

<span data-ttu-id="b9ee7-293">Puede examinar los siguientes [escenarios de ejemplo de Azure](/azure/architecture/example-scenario) que muestran soluciones específicas que usan algunas tecnologías similares:</span><span class="sxs-lookup"><span data-stu-id="b9ee7-293">You may wish to review the following [Azure example scenarios](/azure/architecture/example-scenario) that demonstrate specific solutions using some of the same technologies:</span></span>

- [<span data-ttu-id="b9ee7-294">Ejecución de cargas de trabajo SAP de producción mediante una instancia de Oracle Database en Azure</span><span class="sxs-lookup"><span data-stu-id="b9ee7-294">Running SAP production workloads using an Oracle Database on Azure</span></span>](/azure/architecture/example-scenario/apps/sap-production)
- [<span data-ttu-id="b9ee7-295">Entornos de desarrollo y pruebas para cargas de trabajo SAP en Azure</span><span class="sxs-lookup"><span data-stu-id="b9ee7-295">Dev/test environments for SAP workloads on Azure</span></span>](/azure/architecture/example-scenario/apps/sap-dev-test)

<!-- links -->

[visio-download]: https://archcenter.blob.core.windows.net/cdn/sap-reference-architectures.vsdx
