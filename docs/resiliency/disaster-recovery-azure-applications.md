---
title: Recuperación ante desastres para aplicaciones de Azure
description: Información general técnica y detallada sobre cómo diseñar aplicaciones para recuperación ante desastres en Microsoft Azure.
author: adamglick
ms.date: 09/12/2018
ms.openlocfilehash: ff5da8a3d2612d7c122ec8ed87979eddf778dbf0
ms.sourcegitcommit: e7e0e0282fa93f0063da3b57128ade395a9c1ef9
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2018
ms.locfileid: "52902857"
---
# <a name="disaster-recovery-for-azure-applications"></a><span data-ttu-id="3b497-103">Recuperación ante desastres para aplicaciones de Azure</span><span class="sxs-lookup"><span data-stu-id="3b497-103">Disaster recovery for Azure applications</span></span>

<span data-ttu-id="3b497-104">La recuperación ante desastres se ocupa de recuperarse tras una pérdida catastrófica de funcionalidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-104">Disaster recovery (DR) is focused on recovering from a catastrophic loss of application functionality.</span></span> <span data-ttu-id="3b497-105">Por ejemplo, si una región de Azure que hospeda la aplicación deja de estar disponible, necesita un plan para ejecutar la aplicación o acceder a los datos en otra región.</span><span class="sxs-lookup"><span data-stu-id="3b497-105">For example, if an Azure region hosting your application becomes unavailable, you need a plan for running your application or accessing your data in another region.</span></span> 

<span data-ttu-id="3b497-106">Los propietarios de la tecnología y el negocio deberán determinar qué grado de funcionalidad es necesario durante un desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-106">Business and technology owners must determine how much functionality is required during a disaster.</span></span> <span data-ttu-id="3b497-107">El nivel de funcionalidad puede adoptar diversas formas: total falta de disponibilidad, disponibilidad parcial (funcionalidad reducida o procesamiento diferido) o disponibilidad total.</span><span class="sxs-lookup"><span data-stu-id="3b497-107">This level of functionality can take a few forms: completely unavailable, partially available via reduced functionality or delayed processing, or fully available.</span></span>

<span data-ttu-id="3b497-108">Las estrategias de alta disponibilidad y resistencia están diseñadas para controlar condiciones de error temporales.</span><span class="sxs-lookup"><span data-stu-id="3b497-108">Resiliency and high availability strategies are intended for handling temporary failure conditions.</span></span>  <span data-ttu-id="3b497-109">La ejecución de este plan implica a personas, procesos y aplicaciones auxiliares que permiten que el sistema siga funcionando.</span><span class="sxs-lookup"><span data-stu-id="3b497-109">Executing this plan involves people, processes, and supporting applications that allow the system to continue functioning.</span></span> <span data-ttu-id="3b497-110">En el plan deben ensayarse errores y probarse la recuperación de bases de datos para garantizar que el plan sea efectivo.</span><span class="sxs-lookup"><span data-stu-id="3b497-110">Your plan should include rehearsing failures and testing the recovery of databases to ensure the plan is sound.</span></span> 

## <a name="azure-disaster-recovery-features"></a><span data-ttu-id="3b497-111">Características de recuperación ante desastres de Azure</span><span class="sxs-lookup"><span data-stu-id="3b497-111">Azure disaster recovery features</span></span>

<span data-ttu-id="3b497-112">Al igual que sucede con las consideraciones de disponibilidad, Azure ofrece [manuales técnicos de resistencia](./index.md) diseñados para dar soporte técnico para la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-112">As with availability considerations, Azure provides [resiliency technical guidance](./index.md) designed to support disaster recovery.</span></span> <span data-ttu-id="3b497-113">También existe una relación entre las características de disponibilidad de Azure y la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-113">There is also a relationship between availability features of Azure and disaster recovery.</span></span> <span data-ttu-id="3b497-114">Por ejemplo, la administración de roles en dominios de error aumenta la disponibilidad de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-114">For example, the management of roles across fault domains increases the availability of an application.</span></span> <span data-ttu-id="3b497-115">Sin esa administración, un error de hardware no controlado se convertiría en un escenario de "desastre".</span><span class="sxs-lookup"><span data-stu-id="3b497-115">Without that management, an unhandled hardware failure would become a “disaster” scenario.</span></span> <span data-ttu-id="3b497-116">La utilización de estas características y estrategias de disponibilidad desempeña un importante papel a la hora de preparar una aplicación a prueba de desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-116">Leveraging these availability features and strategies is an important part of disaster-proofing your application.</span></span> <span data-ttu-id="3b497-117">Sin embargo, este artículo va más allá de los problemas de disponibilidad general, ya que trata eventos de desastres más graves (y menos frecuentes).</span><span class="sxs-lookup"><span data-stu-id="3b497-117">However, this article goes beyond general availability issues to more serious (and rarer) disaster events.</span></span>

## <a name="multiple-datacenter-regions"></a><span data-ttu-id="3b497-118">Regiones con varios centros de datos</span><span class="sxs-lookup"><span data-stu-id="3b497-118">Multiple datacenter regions</span></span>
<span data-ttu-id="3b497-119">Azure mantiene centros de datos en muchas regiones del mundo.</span><span class="sxs-lookup"><span data-stu-id="3b497-119">Azure maintains datacenters in many regions around the world.</span></span> <span data-ttu-id="3b497-120">Esta infraestructura da soporte a varios escenarios de recuperación ante desastres, como la replicación geográfica que proporciona el sistema de Azure Storage a regiones secundarias.</span><span class="sxs-lookup"><span data-stu-id="3b497-120">This infrastructure supports several disaster recovery scenarios, such as system-provided geo-replication of Azure Storage to secondary regions.</span></span> <span data-ttu-id="3b497-121">También se puede implementar fácil y económicamente un servicio en la nube en varias ubicaciones de todo el mundo.</span><span class="sxs-lookup"><span data-stu-id="3b497-121">You can also easily and inexpensively deploy a cloud service to multiple locations around the world.</span></span> <span data-ttu-id="3b497-122">Compare esto con el costo y la dificultad que supone crear y mantener sus propios centros de datos en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-122">Compare this with the cost and difficulty of building and maintaining your own datacenters in multiple regions.</span></span> <span data-ttu-id="3b497-123">La implementación de datos y servicios en varias regiones contribuye a proteger la aplicación frente a interrupciones importantes en una sola región.</span><span class="sxs-lookup"><span data-stu-id="3b497-123">Deploying data and services to multiple regions helps protect your application from a major outage in a single region.</span></span> <span data-ttu-id="3b497-124">Al diseñar el plan de recuperación ante desastres, es importante comprender el concepto de regiones emparejadas.</span><span class="sxs-lookup"><span data-stu-id="3b497-124">As you design your disaster recovery plan, it’s important to understand the concept of paired regions.</span></span> <span data-ttu-id="3b497-125">Para más información, consulte [Continuidad empresarial y recuperación ante desastres (BCDR): regiones emparejadas de Azure](/azure/best-practices-availability-paired-regions).</span><span class="sxs-lookup"><span data-stu-id="3b497-125">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions](/azure/best-practices-availability-paired-regions).</span></span>

## <a name="azure-site-recovery"></a><span data-ttu-id="3b497-126">Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="3b497-126">Azure Site Recovery</span></span>

<span data-ttu-id="3b497-127">[Azure Site Recovery](/azure/site-recovery/) cuenta con un sencillo mecanismo para replicar máquinas virtuales de Azure entre regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-127">[Azure Site Recovery](/azure/site-recovery/) provides a simple way to replicate Azure VMs between regions.</span></span> <span data-ttu-id="3b497-128">La sobrecarga de administración es mínima, ya que no es necesario aprovisionar recursos adicionales en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-128">It has minimal management overhead, because you don't need to provision any additional resources in the secondary region.</span></span> <span data-ttu-id="3b497-129">Cuando se habilita la replicación, Site Recovery crea automáticamente los recursos necesarios en la región de destino, con arreglo a la configuración de la máquina virtual de origen.</span><span class="sxs-lookup"><span data-stu-id="3b497-129">When you enable replication, Site Recovery automatically creates the required resources in the target region, based on the source VM settings.</span></span> <span data-ttu-id="3b497-130">Proporciona una replicación continua y automatizada, y permite realizar la conmutación por error de las aplicaciones con un solo clic.</span><span class="sxs-lookup"><span data-stu-id="3b497-130">It provides automated continuous replication, and enables you to perform application failover with a single click.</span></span> <span data-ttu-id="3b497-131">También puede ejecutar simulacros de recuperación ante desastres con conmutaciones por error de prueba, sin que la replicación en curso o las cargas de trabajo de producción se vean afectadas.</span><span class="sxs-lookup"><span data-stu-id="3b497-131">You can also run disaster recovery drills by testing failover, without affecting your production workloads or ongoing replication.</span></span> 

## <a name="azure-traffic-manager"></a><span data-ttu-id="3b497-132">Administrador de tráfico de Azure</span><span class="sxs-lookup"><span data-stu-id="3b497-132">Azure Traffic Manager</span></span>
<span data-ttu-id="3b497-133">Si se produce un error en una región concreta, el tráfico debe redirigirse a los servicios o implementaciones de otra región.</span><span class="sxs-lookup"><span data-stu-id="3b497-133">When a region-specific failure occurs, you must redirect traffic to services or deployments in another region.</span></span> <span data-ttu-id="3b497-134">Es más eficaz controlar esta situación a través de servicios como Azure Traffic Manager, que automatiza la conmutación por error del tráfico de usuario en otra región si se produce un error en la región principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-134">It is most effective to handle this via services such as Azure Traffic Manager, which automates the failover of user traffic to another region if the primary region fails.</span></span> <span data-ttu-id="3b497-135">Es importante entender los conceptos básicos de Traffic Manager al diseñar una estrategia eficaz de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-135">Understanding the fundamentals of Traffic Manager is important when designing an effective DR strategy.</span></span>

<span data-ttu-id="3b497-136">Traffic Manager usa el sistema de nombres de dominio (DNS) para dirigir las solicitudes del cliente al punto de conexión más adecuado en función de un método de enrutamiento del tráfico y el estado de los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="3b497-136">Traffic Manager uses the Domain Name System (DNS) to direct client requests to the most appropriate endpoint based on a traffic-routing method and the health of the endpoints.</span></span> <span data-ttu-id="3b497-137">En el diagrama siguiente, los usuarios se conectan a una dirección URL de Traffic Manager (`http://myATMURL.trafficmanager.net`) que abstrae las direcciones URL de sitio reales (`http://app1URL.cloudapp.net` y `http://app2URL.cloudapp.net`).</span><span class="sxs-lookup"><span data-stu-id="3b497-137">In the following diagram, users connect to a Traffic Manager URL (`http://myATMURL.trafficmanager.net`) which abstracts the actual site URLs (`http://app1URL.cloudapp.net` and `http://app2URL.cloudapp.net`).</span></span> <span data-ttu-id="3b497-138">Las solicitudes de usuario se enrutan a la dirección URL subyacente adecuada en función del [método de enrutamiento de Traffic Manager](/azure/traffic-manager/traffic-manager-routing-methods) configurado.</span><span class="sxs-lookup"><span data-stu-id="3b497-138">User requests are routed to the proper underlying URL based on your configured [Traffic Manager routing method](/azure/traffic-manager/traffic-manager-routing-methods).</span></span> <span data-ttu-id="3b497-139">Para este artículo, solo nos centraremos en la opción de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="3b497-139">For the sake of this article, we will be concerned with only the failover option.</span></span>

![Enrutamiento mediante el Administrador de tráfico de Azure](./images/disaster-recovery-azure-applications/routing-using-azure-traffic-manager.png)

<span data-ttu-id="3b497-141">Cuando se configura Traffic Manager, se proporciona un nuevo prefijo de DNS de Traffic Manager, que utilizarán los usuarios para acceder al servicio.</span><span class="sxs-lookup"><span data-stu-id="3b497-141">When configuring Traffic Manager, you provide a new Traffic Manager DNS prefix, which users will use to access your service.</span></span> <span data-ttu-id="3b497-142">Traffic Manager ahora abstrae el equilibrio de carga en un nivel por encima del nivel regional.</span><span class="sxs-lookup"><span data-stu-id="3b497-142">Traffic Manager now abstracts load balancing one level higher that the regional level.</span></span> <span data-ttu-id="3b497-143">El DNS del Administrador de tráfico se asigna a un CNAME en todas las implementaciones que administra.</span><span class="sxs-lookup"><span data-stu-id="3b497-143">The Traffic Manager DNS maps to a CNAME for all the deployments that it manages.</span></span>

<span data-ttu-id="3b497-144">En Traffic Manager, especifique una lista de prioridades con las implementaciones a las que se enrutarán los usuarios cuando se produce un error.</span><span class="sxs-lookup"><span data-stu-id="3b497-144">Within Traffic Manager, you specify a prioritized list of deployments that users will be routed to when failure occurs.</span></span> <span data-ttu-id="3b497-145">Traffic Manager supervisa los puntos de conexión de la implementación.</span><span class="sxs-lookup"><span data-stu-id="3b497-145">Traffic Manager monitors the deployment endpoints.</span></span> <span data-ttu-id="3b497-146">Si la implementación principal deja de estar disponible, Traffic Manager enruta a los usuarios a la siguiente implementación de la lista de prioridades.</span><span class="sxs-lookup"><span data-stu-id="3b497-146">If the primary deployment becomes unavailable, Traffic Manager routes users to the next deployment on the priority list.</span></span>

<span data-ttu-id="3b497-147">Aunque Traffic Manager decide adónde debe ir en una conmutación por error, usted puede decidir si su dominio de conmutación por error está inactivo o activo mientras no está en modo de conmutación por error (lo que no guarda relación con Traffic Manager).</span><span class="sxs-lookup"><span data-stu-id="3b497-147">Although Traffic Manager decides where to go during a failover, you can decide whether your failover domain is dormant or active while you're not in failover mode (which is unrelated to Traffic Manager).</span></span> <span data-ttu-id="3b497-148">Traffic Manager detecta un error en el sitio principal y cambia al sitio de conmutación por error, independientemente de si ese sitio sirve actualmente a los usuarios.</span><span class="sxs-lookup"><span data-stu-id="3b497-148">Traffic Manager detects a failure in the primary site and rolls over to the failover site, regardless of whether that site is currently serving users.</span></span>

<span data-ttu-id="3b497-149">Para más información sobre el funcionamiento del Administrador de tráfico de Azure, consulte:</span><span class="sxs-lookup"><span data-stu-id="3b497-149">For more information on how Azure Traffic Manager works, refer to:</span></span>

* [<span data-ttu-id="3b497-150">Información general sobre el Administrador de tráfico</span><span class="sxs-lookup"><span data-stu-id="3b497-150">Traffic Manager overview</span></span>](/azure/traffic-manager/traffic-manager-overview/)
* [<span data-ttu-id="3b497-151">Métodos de enrutamiento del Administrador de tráfico</span><span class="sxs-lookup"><span data-stu-id="3b497-151">Traffic Manager routing methods</span></span>](/azure/traffic-manager/traffic-manager-routing-methods)
* [<span data-ttu-id="3b497-152">Configuración del método de enrutamiento de conmutación por error</span><span class="sxs-lookup"><span data-stu-id="3b497-152">Configure failover routing method</span></span>](/azure/traffic-manager/traffic-manager-configure-failover-routing-method/)

## <a name="azure-disaster-scenarios"></a><span data-ttu-id="3b497-153">Escenarios de desastre de Azure</span><span class="sxs-lookup"><span data-stu-id="3b497-153">Azure disaster scenarios</span></span>
<span data-ttu-id="3b497-154">Las siguientes secciones tratan varios tipos de escenarios de desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-154">The following sections cover several different types of disaster scenarios.</span></span> <span data-ttu-id="3b497-155">Las interrupciones del servicio a nivel de toda la región no son la única causa de errores en toda la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-155">Region-wide service disruptions are not the only cause of application-wide failures.</span></span> <span data-ttu-id="3b497-156">Un diseño deficiente y errores de administración también pueden provocar interrupciones.</span><span class="sxs-lookup"><span data-stu-id="3b497-156">Poor design and administrative errors can also lead to outages.</span></span> <span data-ttu-id="3b497-157">Es importante tener en cuenta las posibles causas de un error durante las fases de prueba y de diseño del plan de recuperación.</span><span class="sxs-lookup"><span data-stu-id="3b497-157">It's important to consider the possible causes of a failure during both the design and testing phases of your recovery plan.</span></span> <span data-ttu-id="3b497-158">Un buen plan saca provecho a las características de Azure y las aumenta con estrategias específicas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-158">A good plan takes advantage of Azure features and augments them with application-specific strategies.</span></span> <span data-ttu-id="3b497-159">La respuesta elegida viene determinada por la importancia de la aplicación, el objetivo de punto de recuperación (RPO) y el objetivo de tiempo de recuperación (RTO).</span><span class="sxs-lookup"><span data-stu-id="3b497-159">The chosen response is determined by the importance of the application, the recovery point objective (RPO), and the recovery time objective (RTO).</span></span>

### <a name="application-failure"></a><span data-ttu-id="3b497-160">Error de la aplicación</span><span class="sxs-lookup"><span data-stu-id="3b497-160">Application failure</span></span>
<span data-ttu-id="3b497-161">El Administrador de tráfico de Azure controla automáticamente los errores generados por el software subyacente o el sistema operativo de la máquina virtual host.</span><span class="sxs-lookup"><span data-stu-id="3b497-161">Azure Traffic Manager automatically handles failures that result from the underlying hardware or operating system software in the host virtual machine.</span></span> <span data-ttu-id="3b497-162">Azure crea una nueva instancia de rol y la añade al grupo disponible.</span><span class="sxs-lookup"><span data-stu-id="3b497-162">Azure creates a new role instance and adds it to the available pool.</span></span> <span data-ttu-id="3b497-163">Si ya había más de una instancia de rol en ejecución, Azure desplaza el procesamiento a las otras instancias de rol en ejecución mientras se reemplaza el nodo con error.</span><span class="sxs-lookup"><span data-stu-id="3b497-163">If  more than one role instance was already running, Azure shifts processing to the other running role instances while replacing the failed node.</span></span>

<span data-ttu-id="3b497-164">Pueden producirse errores de aplicación graves sin necesidad de que exista un error de hardware o del sistema operativo subyacente.</span><span class="sxs-lookup"><span data-stu-id="3b497-164">Serious application errors can occur without any underlying failure of the hardware or operating system.</span></span> <span data-ttu-id="3b497-165">La aplicación podría dejar de funcionar debido a las excepciones catastróficas causadas por una lógica defectuosa o por problemas en la integridad de los datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-165">The application might fail due to catastrophic exceptions caused by bad logic or data integrity issues.</span></span> <span data-ttu-id="3b497-166">Debe incluir suficiente telemetría en el código de la aplicación para que un sistema de supervisión pueda detectar condiciones de error y enviar las notificaciones pertinentes a un administrador de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="3b497-166">You must include sufficient telemetry in the application code so that a monitoring system can detect failure conditions and notify an application administrator.</span></span> <span data-ttu-id="3b497-167">Un administrador que tenga pleno conocimiento de los procesos de recuperación ante desastres puede decidir si desencadenar un proceso de conmutación por error o aceptar una interrupción de disponibilidad al resolver los errores críticos.</span><span class="sxs-lookup"><span data-stu-id="3b497-167">An administrator who has full knowledge of the disaster recovery processes can decide whether to trigger a failover process or accept an availability outage while resolving the critical errors.</span></span>

### <a name="data-corruption"></a><span data-ttu-id="3b497-168">Datos dañados</span><span class="sxs-lookup"><span data-stu-id="3b497-168">Data corruption</span></span>
<span data-ttu-id="3b497-169">Azure almacena automáticamente los datos de Azure SQL Database y Azure Storage tres veces en distintos dominios de error de la misma región.</span><span class="sxs-lookup"><span data-stu-id="3b497-169">Azure automatically stores Azure SQL Database and Azure Storage data three times redundantly within different fault domains in the same region.</span></span> <span data-ttu-id="3b497-170">Si utiliza la replicación geográfica, los datos se almacenan tres veces más en una región distinta.</span><span class="sxs-lookup"><span data-stu-id="3b497-170">If you use geo-replication, the data is stored three additional times in a different region.</span></span> <span data-ttu-id="3b497-171">Sin embargo, si los usuarios o la aplicación dañan los datos de la copia principal, los datos se replican rápidamente en las restantes copias.</span><span class="sxs-lookup"><span data-stu-id="3b497-171">However, if your users or your application corrupts that data in the primary copy, the data quickly replicates to the other copies.</span></span> <span data-ttu-id="3b497-172">Lamentablemente, esto genera varias copias de datos dañados.</span><span class="sxs-lookup"><span data-stu-id="3b497-172">Unfortunately, this results in multiple copies of corrupt data.</span></span>

<span data-ttu-id="3b497-173">Para administrar el posible daño de los datos, tiene dos opciones.</span><span class="sxs-lookup"><span data-stu-id="3b497-173">To manage potential corruption of your data, you have two options.</span></span> <span data-ttu-id="3b497-174">En primer lugar, puede administrar una estrategia de copia de seguridad personalizada.</span><span class="sxs-lookup"><span data-stu-id="3b497-174">First, you can manage a custom backup strategy.</span></span> <span data-ttu-id="3b497-175">Puede almacenar las copias de seguridad en Azure o de forma local, en función de los requisitos empresariales o las regulaciones gubernamentales.</span><span class="sxs-lookup"><span data-stu-id="3b497-175">You can store your backups in Azure or on-premises, depending on your business requirements or governance regulations.</span></span> <span data-ttu-id="3b497-176">Otra posibilidad es utilizar la opción de restauración a un momento dado para recuperar una base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="3b497-176">Another option is to use the point-in-time restore option to recover a SQL database.</span></span> <span data-ttu-id="3b497-177">Para más información, consulte la sección sobre las [estrategias de datos para la recuperación ante desastres](#data-strategies-for-disaster-recovery) más adelante.</span><span class="sxs-lookup"><span data-stu-id="3b497-177">For more information, see the [data strategies for disaster recovery](#data-strategies-for-disaster-recovery) section below.</span></span>

### <a name="network-outage"></a><span data-ttu-id="3b497-178">Interrupción de la red</span><span class="sxs-lookup"><span data-stu-id="3b497-178">Network outage</span></span>
<span data-ttu-id="3b497-179">Si algunas partes de la red de Azure no están accesibles, es posible que no pueda acceder a su aplicación o a los datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-179">When parts of the Azure network are inaccessible, you may be unable to access your application or data.</span></span> <span data-ttu-id="3b497-180">Si una o varias instancias de rol no están disponibles debido a problemas en la red, Azure usa las restantes instancias disponibles de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-180">If one or more role instances are unavailable due to network issues, Azure uses the remaining available instances of your application.</span></span> <span data-ttu-id="3b497-181">Si la aplicación no puede acceder a los datos debido a una interrupción en la red de Azure, puede usar datos almacenados en caché para trabajar localmente con la funcionalidad de la aplicación reducida.</span><span class="sxs-lookup"><span data-stu-id="3b497-181">If your application cannot access its data because of an Azure network outage, you can potentially run with reduced application functionality locally by using cached data.</span></span> <span data-ttu-id="3b497-182">Debe diseñar la estrategia de recuperación ante desastres para que se ejecute con funcionalidad reducida en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-182">You need to design the disaster recovery strategy to run with reduced functionality in your application.</span></span> <span data-ttu-id="3b497-183">En algunas aplicaciones, esto puede no resultar práctico.</span><span class="sxs-lookup"><span data-stu-id="3b497-183">For some applications, this might not be practical.</span></span>

<span data-ttu-id="3b497-184">Otra opción es almacenar los datos en una ubicación alternativa hasta que se restaure la conectividad.</span><span class="sxs-lookup"><span data-stu-id="3b497-184">Another option is to store data in an alternate location until connectivity is restored.</span></span> <span data-ttu-id="3b497-185">Si reducir la funcionalidad no se contempla, las restantes opciones son el tiempo de inactividad de la aplicación o la conmutación por error a otra región.</span><span class="sxs-lookup"><span data-stu-id="3b497-185">If reducing functionality is not an option, the remaining options are application downtime or failover to an alternate region.</span></span> <span data-ttu-id="3b497-186">El diseño de una aplicación que se ejecuta con funcionalidad reducida es mucho más una decisión empresarial que técnica.</span><span class="sxs-lookup"><span data-stu-id="3b497-186">The design of an application running with reduced functionality is as much a business decision as a technical one.</span></span> <span data-ttu-id="3b497-187">Esto se explica más detalladamente en la sección sobre [funcionalidad de aplicación reducida](#reduced-application-functionality).</span><span class="sxs-lookup"><span data-stu-id="3b497-187">This is discussed further in the section on [reduced application functionality](#reduced-application-functionality).</span></span>

### <a name="failure-of-a-dependent-service"></a><span data-ttu-id="3b497-188">Error de un servicio dependiente</span><span class="sxs-lookup"><span data-stu-id="3b497-188">Failure of a dependent service</span></span>
<span data-ttu-id="3b497-189">Azure proporciona muchos servicios que pueden experimentar tiempos de inactividad periódicamente.</span><span class="sxs-lookup"><span data-stu-id="3b497-189">Azure provides many services that can experience periodic downtime.</span></span> <span data-ttu-id="3b497-190">Por ejemplo, [Azure Redis Cache](https://azure.microsoft.com/services/cache/) es un servicio multiinquilino que proporciona funcionalidad de almacenamiento en caché a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-190">For example, [Azure Redis Cache](https://azure.microsoft.com/services/cache/) is a multi-tenant service which provides caching capabilities to your application.</span></span> <span data-ttu-id="3b497-191">Es importante tener en cuenta lo que ocurre en la aplicación si el servicio dependiente no está disponible.</span><span class="sxs-lookup"><span data-stu-id="3b497-191">It's important to consider what happens in your application if the dependent service is unavailable.</span></span> <span data-ttu-id="3b497-192">En muchos sentidos, este escenario es similar al escenario de interrupción de la red.</span><span class="sxs-lookup"><span data-stu-id="3b497-192">In many ways, this scenario is similar to the network outage scenario.</span></span> <span data-ttu-id="3b497-193">Sin embargo, si se considera cada servicio de forma independiente, se consiguen mejoras potenciales en el plan global.</span><span class="sxs-lookup"><span data-stu-id="3b497-193">However, considering each service independently results in potential improvements to your overall plan.</span></span>

<span data-ttu-id="3b497-194">Azure Redis Cache proporciona almacenamiento en caché a una aplicación desde la implementación del servicio en la nube, lo que proporciona beneficios en la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-194">Azure Redis Cache provides caching to your application from within your cloud service deployment, which provides disaster recovery benefits.</span></span> <span data-ttu-id="3b497-195">En primer lugar, el servicio se ejecuta en roles locales de cara a la implementación.</span><span class="sxs-lookup"><span data-stu-id="3b497-195">First, the service now runs on roles that are local to your deployment.</span></span> <span data-ttu-id="3b497-196">Por consiguiente, tiene mayor capacidad para supervisar y administrar el estado de la memoria caché como parte de los procesos de administración global del servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-196">Therefore, you're better able to monitor and manage the status of the cache as part of your overall management processes for the cloud service.</span></span> <span data-ttu-id="3b497-197">Este tipo de almacenamiento en caché también expone nuevas características, como la alta disponibilidad para los datos en caché que, si se produce un error en un solo nodo, conserva estos datos manteniendo copias duplicadas en otros nodos.</span><span class="sxs-lookup"><span data-stu-id="3b497-197">This type of caching also exposes new features such as high availability for cached data, which preserves cached data if a single node fails by maintaining duplicate copies on other nodes.</span></span>

<span data-ttu-id="3b497-198">Tenga en cuenta que la alta disponibilidad reduce el rendimiento y aumenta la latencia debido a que las operaciones de escritura también deben actualizar todas las copias secundarias.</span><span class="sxs-lookup"><span data-stu-id="3b497-198">Note that high availability decreases throughput and increases latency because write operations must also upedate any secondary copies.</span></span> <span data-ttu-id="3b497-199">De hecho, la cantidad de memoria necesaria para almacenar los datos en caché se duplica, lo que debe tenerse en cuenta al planificar la capacidad requerida.</span><span class="sxs-lookup"><span data-stu-id="3b497-199">The amount of memory required to store the cached data is effectively doubled, which must be taken into account during capacity planning.</span></span>  <span data-ttu-id="3b497-200">Este ejemplo muestra que cada servicio dependiente puede tener funcionalidades que mejoran la disponibilidad general y resistencia a errores catastróficos.</span><span class="sxs-lookup"><span data-stu-id="3b497-200">This example demonstrates that each dependent service might have capabilities that improve your overall availability and resistance to catastrophic failures.</span></span>

<span data-ttu-id="3b497-201">Con cada servicio dependiente, debe comprender las implicaciones de una interrupción del servicio.</span><span class="sxs-lookup"><span data-stu-id="3b497-201">With each dependent service, you should understand the implications of a service disruption.</span></span> <span data-ttu-id="3b497-202">En el ejemplo del almacenamiento en la caché, es posible acceder a los datos directamente desde una base de datos hasta que se restaure la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="3b497-202">In the caching example, it might be possible to access the data directly from a database until you restore your cache.</span></span> <span data-ttu-id="3b497-203">Esto reduciría el rendimiento al tiempo que proporcionaría acceso completo a los datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-203">This would result in reduced performance while providing full access to application data.</span></span>

### <a name="region-wide-service-disruption"></a><span data-ttu-id="3b497-204">Interrupción del servicio en toda la región</span><span class="sxs-lookup"><span data-stu-id="3b497-204">Region-wide service disruption</span></span>
<span data-ttu-id="3b497-205">Los anteriores han sido principalmente errores que pueden administrarse en la misma región de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-205">The previous failures have primarily been failures that can be managed within the same Azure region.</span></span> <span data-ttu-id="3b497-206">Sin embargo, también debe prepararse para la posibilidad de que se produzca una interrupción del servicio en toda la región.</span><span class="sxs-lookup"><span data-stu-id="3b497-206">However, you must also prepare for the possibility that there is a service disruption of the entire region.</span></span> <span data-ttu-id="3b497-207">Si se produce una interrupción del servicio en toda la región, las copias redundantes locales de los datos no estarán disponibles.</span><span class="sxs-lookup"><span data-stu-id="3b497-207">If a region-wide service disruption occurs, the locally redundant copies of your data are not available.</span></span> <span data-ttu-id="3b497-208">Si ha habilitado la replicación geográfica, hay tres copias adicionales de los blobs y las tablas en una región distinta.</span><span class="sxs-lookup"><span data-stu-id="3b497-208">If you have enabled geo-replication, there are three additional copies of your blobs and tables in a different region.</span></span> <span data-ttu-id="3b497-209">Si Microsoft declara la región perdida, Azure reasignará todas las entradas de DNS a la región con replicación geográfica.</span><span class="sxs-lookup"><span data-stu-id="3b497-209">If Microsoft declares the region lost, Azure remaps all of the DNS entries to the geo-replicated region.</span></span>

> [!NOTE]
> <span data-ttu-id="3b497-210">Tenga en cuenta que no tiene ningún control sobre este proceso y que solo se producirá si se produce una interrupción del servicio en toda la región.</span><span class="sxs-lookup"><span data-stu-id="3b497-210">Be aware that you don't have any control over this process, and it will occur only for region-wide service disruption.</span></span> <span data-ttu-id="3b497-211">Considere la posibilidad de utilizar [Azure Site Recovery](/azure/site-recovery/) para conseguir un RPO y un RTO más altos.</span><span class="sxs-lookup"><span data-stu-id="3b497-211">Consider using [Azure Site Recovery](/azure/site-recovery/) to achieve better RPO and RTO.</span></span> <span data-ttu-id="3b497-212">Site Recovery deja que la aplicación decida qué se considera una interrupción aceptable y cuándo debe conmutar por error a las máquinas virtuales replicadas.</span><span class="sxs-lookup"><span data-stu-id="3b497-212">Site Recovery allows application to decide what is an acceptable outage, and when to fail over to the replicated VMs.</span></span>

### <a name="azure-wide-service-disruption"></a><span data-ttu-id="3b497-213">Interrupción de un servicio en todo Azure</span><span class="sxs-lookup"><span data-stu-id="3b497-213">Azure-wide service disruption</span></span>
<span data-ttu-id="3b497-214">En el planeamiento de desastres, es preciso tener en cuenta toda la gama de posibles desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-214">In disaster planning, you must consider the entire range of possible disasters.</span></span> <span data-ttu-id="3b497-215">Una de las interrupciones de servicio más graves implicaría a todas las regiones de Azure de manera simultánea.</span><span class="sxs-lookup"><span data-stu-id="3b497-215">One of the most severe service disruptions would involve all Azure regions simultaneously.</span></span> <span data-ttu-id="3b497-216">Al igual que con otras interrupciones de servicio, puede decidir asumir el riesgo de una inactividad temporal del evento.</span><span class="sxs-lookup"><span data-stu-id="3b497-216">As with other service disruptions, you might decide to accept the risk of temporary downtime in that event.</span></span> <span data-ttu-id="3b497-217">Las interrupciones de servicio generalizadas que abarcan regiones son mucho menos habituales que las aisladas que afectan a servicios dependientes o regiones individuales.</span><span class="sxs-lookup"><span data-stu-id="3b497-217">Widespread service disruptions that span regions are much rarer than isolated service disruptions involving dependent services or single regions.</span></span>

<span data-ttu-id="3b497-218">No obstante, puede decidir que ciertas aplicaciones críticas necesitan un plan de copia de seguridad para una interrupción del servicio en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-218">However, you may decide that certain mission-critical applications require a backup plan for a multi-region service disruption.</span></span> <span data-ttu-id="3b497-219">Este plan puede incluir la conmutación por error de servicios en una [nube alternativa](#alternative-cloud) o en una [solución híbrida local y en la nube](#hybrid-on-premises-and-cloud-solution).</span><span class="sxs-lookup"><span data-stu-id="3b497-219">This plan might include failing over to services in an [alternative cloud](#alternative-cloud) or a [hybrid on-premises and cloud solution](#hybrid-on-premises-and-cloud-solution).</span></span>

### <a name="reduced-application-functionality"></a><span data-ttu-id="3b497-220">Funcionalidad de aplicación reducida</span><span class="sxs-lookup"><span data-stu-id="3b497-220">Reduced application functionality</span></span>
<span data-ttu-id="3b497-221">Una aplicación bien diseñada suele utilizar servicios que se comunican entre sí a través de la implementación de patrones de intercambio de información de acoplamiento flexible.</span><span class="sxs-lookup"><span data-stu-id="3b497-221">A well-designed application typically uses services that communicate with each other though the implementation of loosely coupled information-interchange patterns.</span></span> <span data-ttu-id="3b497-222">Las aplicaciones compatibles con recuperación ante desastres requieren la separación de responsabilidades en el nivel de servicio.</span><span class="sxs-lookup"><span data-stu-id="3b497-222">A DR-friendly application requires separation of responsibilities at the service level.</span></span> <span data-ttu-id="3b497-223">De este modo, se evita que la interrupción de un servicio dependiente desactive toda la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-223">This prevents the disruption of a dependent service from bringing down the entire application.</span></span> <span data-ttu-id="3b497-224">Por ejemplo, piense en una aplicación de comercio electrónico para la empresa Y. Los módulos siguientes podrían constituir la aplicación:</span><span class="sxs-lookup"><span data-stu-id="3b497-224">For example, consider a web commerce application for Company Y. The following modules might constitute the application:</span></span>

* <span data-ttu-id="3b497-225">**Catálogo de productos** : permite a los usuarios examinar los productos.</span><span class="sxs-lookup"><span data-stu-id="3b497-225">**Product Catalog** allows users to browse products.</span></span>
* <span data-ttu-id="3b497-226">**Carro de la compra** : permite a los usuarios agregar productos al carro de la compra o quitarlos de él.</span><span class="sxs-lookup"><span data-stu-id="3b497-226">**Shopping Cart** allows users to add/remove products in their shopping cart.</span></span>
* <span data-ttu-id="3b497-227">**Estado del pedido** : muestra el estado de envío de los pedidos de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="3b497-227">**Order Status** shows the shipping status of user orders.</span></span>
* <span data-ttu-id="3b497-228">**Envío del pedido** : finaliza la sesión de compra enviando el pedido con el pago.</span><span class="sxs-lookup"><span data-stu-id="3b497-228">**Order Submission** finalizes the shopping session by submitting the order with payment.</span></span>
* <span data-ttu-id="3b497-229">**Procesamiento del pedido** : valida la integridad de los datos del pedido y realiza la comprobación de la disponibilidad de la cantidad solicitada.</span><span class="sxs-lookup"><span data-stu-id="3b497-229">**Order Processing** validates the order for data integrity and performs a quantity availability check.</span></span>

<span data-ttu-id="3b497-230">Cuando una dependencia de servicio en esta aplicación deja de estar disponible, ¿cómo funciona el servicio hasta que se recupera la dependencia?</span><span class="sxs-lookup"><span data-stu-id="3b497-230">When a service dependency in this application becomes unavailable, how does the service function until the dependency recovers?</span></span> <span data-ttu-id="3b497-231">Un sistema bien diseñado implementa los límites de aislamiento mediante la separación de responsabilidades tanto en el tiempo de diseño como en el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="3b497-231">A well-designed system implements isolation boundaries through separation of responsibilities, both at design time and at runtime.</span></span> <span data-ttu-id="3b497-232">Todos los errores se pueden clasificar como recuperables y no recuperables.</span><span class="sxs-lookup"><span data-stu-id="3b497-232">You can categorize every failure as recoverable and non-recoverable.</span></span> <span data-ttu-id="3b497-233">Los errores no recuperables harán que el servicio deje de funcionar, pero los errores recuperables se pueden mitigar mediante ciertas alternativas.</span><span class="sxs-lookup"><span data-stu-id="3b497-233">Non-recoverable errors will bring down the service, but you can mitigate a recoverable error through alternatives.</span></span> <span data-ttu-id="3b497-234">Determinados problemas que se solucionan mediante el tratamiento automático de errores y medidas alternativas son transparentes para el usuario.</span><span class="sxs-lookup"><span data-stu-id="3b497-234">Certain problems addressed by automatically handling faults and taking alternate actions are transparent to the user.</span></span> <span data-ttu-id="3b497-235">Durante una interrupción del servicio más grave, la aplicación podría estar completamente no disponible.</span><span class="sxs-lookup"><span data-stu-id="3b497-235">During a more serious service disruption, the application might be completely unavailable.</span></span> <span data-ttu-id="3b497-236">Una tercera opción es seguir atendiendo las solicitudes de usuario con funcionalidad reducida.</span><span class="sxs-lookup"><span data-stu-id="3b497-236">A third option is to continue handling user requests with reduced functionality.</span></span>

<span data-ttu-id="3b497-237">Por ejemplo, si la base de datos para hospedar los pedidos deja de funcionar, el servicio Procesamiento del pedido pierde su capacidad para procesar transacciones de ventas.</span><span class="sxs-lookup"><span data-stu-id="3b497-237">For instance, if the database for hosting orders goes down, the Order Processing service loses its ability to process sales transactions.</span></span> <span data-ttu-id="3b497-238">En función de la arquitectura, puede que sea difícil o imposible que los servicios Envío del pedido y Procesamiento del pedido de la aplicación sigan funcionando.</span><span class="sxs-lookup"><span data-stu-id="3b497-238">Depending on the architecture, it might be difficult or impossible for the Order Submission and Order Processing services of the application to continue.</span></span> <span data-ttu-id="3b497-239">Si la aplicación no está diseñada para controlar este escenario, toda ella puede quedarse sin conexión.</span><span class="sxs-lookup"><span data-stu-id="3b497-239">If the application is not designed to handle this scenario, the entire application might go offline.</span></span> <span data-ttu-id="3b497-240">Sin embargo, si los datos de productos se almacenan en una ubicación diferente, el módulo Catálogo de productos puede seguir utilizándose para ver productos.</span><span class="sxs-lookup"><span data-stu-id="3b497-240">However, if the product data is stored in a different location, then the Product Catalog module can still be used for viewing products.</span></span> <span data-ttu-id="3b497-241">Sin embargo, otras partes de la aplicación no están disponibles, como los pedidos o las consultas al inventario.</span><span class="sxs-lookup"><span data-stu-id="3b497-241">However, other parts of the application are unavailable, such as ordering or inventory queries.</span></span>

<span data-ttu-id="3b497-242">Decidir qué funcionalidad reducida de la aplicación estará disponible es una decisión tanto empresarial como técnica.</span><span class="sxs-lookup"><span data-stu-id="3b497-242">Deciding what reduced application functionality is available is both a business decision and a technical decision.</span></span> <span data-ttu-id="3b497-243">Debe decidir cómo informará la aplicación a los usuarios de los problemas temporales.</span><span class="sxs-lookup"><span data-stu-id="3b497-243">You must decide how the application will inform the users of any temporary problems.</span></span> <span data-ttu-id="3b497-244">En el ejemplo anterior, la aplicación puede permitir ver productos y añadirlos a un carro de la compra.</span><span class="sxs-lookup"><span data-stu-id="3b497-244">In the example above, the application might allow viewing products and adding them to a shopping cart.</span></span> <span data-ttu-id="3b497-245">Sin embargo, cuando el usuario intenta realizar una compra, la aplicación notifica al usuario que la funcionalidad de pedidos no está disponible temporalmente.</span><span class="sxs-lookup"><span data-stu-id="3b497-245">However, when the user attempts to make a purchase, the application notifies the user that the ordering functionality is temporarily unavailable.</span></span> <span data-ttu-id="3b497-246">No es lo ideal para el cliente, pero evita una interrupción del servicio en toda la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-246">This isn't ideal for the customer, but it does prevent an application-wide service disruption.</span></span>

## <a name="data-strategies-for-disaster-recovery"></a><span data-ttu-id="3b497-247">estrategias de datos para la recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="3b497-247">Data strategies for disaster recovery</span></span>
<span data-ttu-id="3b497-248">Un adecuado tratamiento de los datos supone un desafío para un plan de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-248">Proper data handling is a challenging aspect of a disaster recovery plan.</span></span> <span data-ttu-id="3b497-249">Durante el proceso de recuperación, la restauración de datos suele ser la operación que tarda más tiempo.</span><span class="sxs-lookup"><span data-stu-id="3b497-249">During the recovery process, data restoration typically takes the most time.</span></span> <span data-ttu-id="3b497-250">Las diversas opciones para reducir la funcionalidad plantean retos difíciles para la recuperación de datos y la coherencia después de un error.</span><span class="sxs-lookup"><span data-stu-id="3b497-250">Different choices for reducing functionality result in difficult challenges for data recovery from failure and consistency after failure.</span></span>

<span data-ttu-id="3b497-251">Uno de los factores que se debe tener en cuenta es la necesidad de restaurar o mantener una copia de los datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-251">One consideration is the need to restore or maintain a copy of the application’s data.</span></span> <span data-ttu-id="3b497-252">Estos datos se usarán como referencia y para transacciones en un sitio secundario.</span><span class="sxs-lookup"><span data-stu-id="3b497-252">You will use this data for reference and transactional purposes at a secondary site.</span></span> <span data-ttu-id="3b497-253">Una implementación local requiere un proceso de planeamiento costoso y largo para implementar una estrategia de recuperación ante desastres en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-253">An on-premises deployment requires an expensive and lengthy planning process to implement a multiple-region disaster recovery strategy.</span></span> <span data-ttu-id="3b497-254">Afortunadamente, la mayoría de los proveedores de nube, incluido Azure, permiten que las aplicaciones se implementen fácilmente en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-254">Conveniently, most cloud providers, including Azure, readily allow the deployment of applications to multiple regions.</span></span> <span data-ttu-id="3b497-255">Estas regiones están distribuidas geográficamente de tal forma que la interrupción del servicio en varias regiones sea muy poco habitual.</span><span class="sxs-lookup"><span data-stu-id="3b497-255">These regions are geographically distributed in such a way that multiple-region service disruption should be extremely rare.</span></span> <span data-ttu-id="3b497-256">La estrategia para el control de datos entre regiones es uno de los factores que contribuyen el éxito de cualquier plan de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-256">The strategy for handling data across regions is one of the contributing factors for the success of any disaster recovery plan.</span></span>

<span data-ttu-id="3b497-257">En Las secciones siguientes se describen las técnicas de recuperación ante desastres relacionadas con las copias de seguridad de datos, los datos de referencia y los datos transaccionales.</span><span class="sxs-lookup"><span data-stu-id="3b497-257">The following sections discuss disaster recovery techniques related to data backups, reference data, and transactional data.</span></span>

### <a name="backup-and-restore"></a><span data-ttu-id="3b497-258">Copia de seguridad y restauración</span><span class="sxs-lookup"><span data-stu-id="3b497-258">Backup and restore</span></span>
<span data-ttu-id="3b497-259">Copias de seguridad periódicas de los datos de la aplicación pueden dar soporte a algunos escenarios de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-259">Regular backups of application data can support some disaster recovery scenarios.</span></span> <span data-ttu-id="3b497-260">Recursos de almacenamiento diferentes requieren técnicas diferentes.</span><span class="sxs-lookup"><span data-stu-id="3b497-260">Different storage resources require different techniques.</span></span>

#### <a name="sql-database"></a><span data-ttu-id="3b497-261">SQL Database</span><span class="sxs-lookup"><span data-stu-id="3b497-261">SQL Database</span></span>
<span data-ttu-id="3b497-262">En los niveles Basic, Standard y Premium de SQL Database, se puede sacar provecho de la función de restauración a un momento dado para recuperar una base de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-262">For the Basic, Standard, and Premium SQL Database tiers, you can take advantage of point-in-time restore to recover your database.</span></span> <span data-ttu-id="3b497-263">Para más información, consulte [Información general: continuidad del negocio en la nube y recuperación ante desastres con la SQL Database](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="3b497-263">For more information, see [Overview: Cloud business continuity and database disaster recovery with SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span> <span data-ttu-id="3b497-264">Otra opción es usar la replicación geográfica activa para SQL Database.</span><span class="sxs-lookup"><span data-stu-id="3b497-264">Another option is to use Active Geo-Replication for SQL Database.</span></span> <span data-ttu-id="3b497-265">Con esta función se replican automáticamente los cambios de la base de datos en bases de datos secundarias de la misma región de Azure, o incluso de una región distinta.</span><span class="sxs-lookup"><span data-stu-id="3b497-265">This automatically replicates database changes to secondary databases in the same Azure region or even in a different Azure region.</span></span> <span data-ttu-id="3b497-266">Esto proporciona una posible alternativa a algunas de las técnicas de sincronización de datos más manuales que se presentan en este artículo.</span><span class="sxs-lookup"><span data-stu-id="3b497-266">This provides a potential alternative to some of the more manual data synchronization techniques presented in this article.</span></span> <span data-ttu-id="3b497-267">Para más información, consulte [Información general: Replicación geográfica activa para Azure SQL Database](/azure/sql-database/sql-database-geo-replication-overview/).</span><span class="sxs-lookup"><span data-stu-id="3b497-267">For more information, see [Overview: SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/).</span></span>

<span data-ttu-id="3b497-268">También puede utilizar un enfoque más manual para realizar copias de seguridad y restauraciones.</span><span class="sxs-lookup"><span data-stu-id="3b497-268">You can also use a more manual approach for backup and restore.</span></span> <span data-ttu-id="3b497-269">Utilice el comando DATABASE COPY para crear una copia de seguridad de la base de datos con coherencia transaccional.</span><span class="sxs-lookup"><span data-stu-id="3b497-269">Use the DATABASE COPY command to create a backup copy of the database with transactional consistency.</span></span> <span data-ttu-id="3b497-270">También puede usar el servicio de importación y exportación de Azure SQL Database, que permite exportar bases de datos a archivos BACPAC (archivos comprimidos que contienen el esquema de base de datos y los datos asociados) que se almacenan en Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="3b497-270">You can also use the import/export service of Azure SQL Database, which supports exporting databases to BACPAC files (compressed files containing your database schema and associated data) that are stored in Azure Blob storage.</span></span>

<span data-ttu-id="3b497-271">La redundancia integrada de Azure Storage crea dos réplicas del archivo de copia de seguridad en la misma región.</span><span class="sxs-lookup"><span data-stu-id="3b497-271">The built-in redundancy of Azure Storage creates two replicas of the backup file in the same region.</span></span> <span data-ttu-id="3b497-272">Sin embargo, la frecuencia de ejecución del proceso de copia de seguridad determina el RPO, que es la cantidad de datos que se pueden perder en escenarios de desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-272">However, the frequency of running the backup process determines your RPO, which is the amount of data you might lose in disaster scenarios.</span></span> <span data-ttu-id="3b497-273">Por ejemplo, suponga que realiza una copia de seguridad cada hora en punto y se produce un desastre dos minutos antes de la hora en punto.</span><span class="sxs-lookup"><span data-stu-id="3b497-273">For example, imagine that you perform a backup at the top of each hour, and a disaster occurs two minutes before the top of the hour.</span></span> <span data-ttu-id="3b497-274">Perderá los 58 minutos de datos registrados después de la última copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="3b497-274">You lose 58 minutes of data recorded after the last backup was performed.</span></span> <span data-ttu-id="3b497-275">Además, para protegerse contra una interrupción del servicio en toda una región, debe copiar los archivos BACPAC en otra región.</span><span class="sxs-lookup"><span data-stu-id="3b497-275">Also, to protect against a region-wide service disruption, you should copy the BACPAC files to an alternate region.</span></span> <span data-ttu-id="3b497-276">A continuación, tiene la opción de restaurar dichas copias de seguridad en la otra región.</span><span class="sxs-lookup"><span data-stu-id="3b497-276">You then have the option of restoring those backups in the alternate region.</span></span> <span data-ttu-id="3b497-277">Para más información, consulte [Información general: continuidad del negocio en la nube y recuperación ante desastres con la SQL Database](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="3b497-277">For more details, see [Overview: Cloud business continuity and database disaster recovery with SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span>

#### <a name="sql-data-warehouse"></a><span data-ttu-id="3b497-278">SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="3b497-278">SQL Data Warehouse</span></span>
<span data-ttu-id="3b497-279">En el caso de SQL Data Warehouse, use [copias de seguridad con replicación geográfica](/azure/sql-data-warehouse/backup-and-restore#geo-backups) para realizar la restauración a una región emparejada en una recuperación ante un desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-279">For SQL Data Warehouse, use [geo-backups](/azure/sql-data-warehouse/backup-and-restore#geo-backups) to restore to a paired region for disaster recovery.</span></span> <span data-ttu-id="3b497-280">Dichas copias de seguridad se realizan cada 24 horas y se pueden restaurar en 20 minutos en la región emparejada.</span><span class="sxs-lookup"><span data-stu-id="3b497-280">These backups are taken every 24 hours and can be restore within 20 minutes in the paired region.</span></span> <span data-ttu-id="3b497-281">Esta característica está activada de forma predeterminada para todos los almacenes de SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="3b497-281">This feature is on by default for all SQL data warehouses.</span></span> <span data-ttu-id="3b497-282">Para más información acerca de cómo restaurar una almacenamiento de datos, consulte [Uso de PowerShell para restaurar desde una región geográfica de Azure](/azure/sql-data-warehouse/sql-data-warehouse-restore#restore-from-an-azure-geographical-region-using-powershell).</span><span class="sxs-lookup"><span data-stu-id="3b497-282">For more information on how to restore your data warehouse, see [Restore from an Azure geographical region using PowerShell](/azure/sql-data-warehouse/sql-data-warehouse-restore#restore-from-an-azure-geographical-region-using-powershell).</span></span>

#### <a name="azure-storage"></a><span data-ttu-id="3b497-283">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="3b497-283">Azure Storage</span></span>
<span data-ttu-id="3b497-284">En el caso de Azure Storage, puede desarrollar un proceso de copia de seguridad personalizado, o bien utilizar una de las muchas herramientas de copia de seguridad de terceros.</span><span class="sxs-lookup"><span data-stu-id="3b497-284">For Azure Storage, you can develop a custom backup process or use one of many third-party backup tools.</span></span> <span data-ttu-id="3b497-285">Tenga en cuenta que la mayoría de los diseños de aplicaciones presentan complejidades adicionales donde los recursos de almacenamiento se hacen referencia entre sí.</span><span class="sxs-lookup"><span data-stu-id="3b497-285">Note that most application designs have additional complexities where storage resources reference each other.</span></span> <span data-ttu-id="3b497-286">Por ejemplo, piense en una instancia de SQL Database que tenga una columna vinculada a un blob de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="3b497-286">For example, consider a SQL database that has a column that links to a blob in Azure Storage.</span></span> <span data-ttu-id="3b497-287">Si las copias de seguridad no se realizan simultáneamente, la base de datos puede tener un puntero a un blob del que no se había realizado una copia de seguridad antes del error.</span><span class="sxs-lookup"><span data-stu-id="3b497-287">If the backups do not happen simultaneously, the database might have a pointer to a blob that was not backed up before the failure.</span></span> <span data-ttu-id="3b497-288">La aplicación o el plan de recuperación ante desastres debe implementar procesos que controlen esta incoherencia tras una recuperación.</span><span class="sxs-lookup"><span data-stu-id="3b497-288">The application or disaster recovery plan must implement processes to handle this inconsistency after a recovery.</span></span>

#### <a name="other-data-platforms"></a><span data-ttu-id="3b497-289">Otras plataformas de datos</span><span class="sxs-lookup"><span data-stu-id="3b497-289">Other data platforms</span></span>
<span data-ttu-id="3b497-290">Otras plataformas de datos hospedadas en infraestructura como servicio (IaaS), como Elasticsearch o MongoDB, tienen sus propias funcionalidades y consideraciones que tener en cuenta al crear un proceso de copia de seguridad y restauración integrado.</span><span class="sxs-lookup"><span data-stu-id="3b497-290">Other infrastructure-as-a-service (IaaS) hosted data platforms, such as Elasticsearch or MongoDB, have their own capabilities and considerations when creating an integrated backup and restore process.</span></span> <span data-ttu-id="3b497-291">Para estas plataformas de datos, la recomendación general es usar cualquier funcionalidad nativa o disponible de replicación basada en integración o de toma de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="3b497-291">For these data platforms, the general recommendation is to use any native or available integration-based replication or snapshotting capabilities.</span></span> <span data-ttu-id="3b497-292">Si esas funcionalidades no existen o no son adecuadas, considere la posibilidad de usar el servicio Azure Backup o instantáneas de disco administrado o no administrado para crear una copia de un momento específico de los datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-292">If those capabilities do not exist or are not suitable, then consider using Azure Backup Service or managed/unmanaged disk snapshots to create a point-in-time copy of application data.</span></span> <span data-ttu-id="3b497-293">En todos los casos, es importante determinar cómo realizar copias de seguridad coherentes, especialmente cuando los datos de aplicación abarcan varios sistemas de archivos, o cuando se combinan varias unidades en un solo sistema de archivos mediante administradores de volúmenes o sistemas RAID basados en software.</span><span class="sxs-lookup"><span data-stu-id="3b497-293">In all cases, it’s important to determine how to achieve consistent backups, especially when application data spans multiple files systems, or when multiple drives are combined into a single file system using volume managers or software-based RAID.</span></span>

### <a name="reference-data-pattern-for-disaster-recovery"></a><span data-ttu-id="3b497-294">Patrón de datos de referencia para la recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="3b497-294">Reference data pattern for disaster recovery</span></span>
<span data-ttu-id="3b497-295">Los datos de referencia son de solo lectura y admiten la funcionalidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-295">Reference data is read-only data that supports application functionality.</span></span> <span data-ttu-id="3b497-296">Normalmente no cambian con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="3b497-296">It typically does not change frequently.</span></span> <span data-ttu-id="3b497-297">Aunque la copia de seguridad y restauración es un método para controlar las interrupciones del servicio en toda una región, el RTO es relativamente largo.</span><span class="sxs-lookup"><span data-stu-id="3b497-297">Although backup and restore is one method to handle region-wide service disruptions, the RTO is relatively long.</span></span> <span data-ttu-id="3b497-298">Al implementar la aplicación en una región secundaria, algunas estrategias pueden mejorar el RTO de los datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="3b497-298">When you deploy the application to a secondary region, some strategies can improve the RTO for reference data.</span></span>

<span data-ttu-id="3b497-299">Dado que los datos de referencia cambian con poca frecuencia, el RTO se puede mejorar manteniendo una copia permanente de los datos de referencia en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-299">Because reference data changes infrequently, you can improve the RTO by maintaining a permanent copy of the reference data in the secondary region.</span></span> <span data-ttu-id="3b497-300">Esto elimina el tiempo requerido para restaurar copias de seguridad en caso de desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-300">This eliminates the time required to restore backups in the event of a disaster.</span></span> <span data-ttu-id="3b497-301">Para cumplir los requisitos de recuperación ante desastres en varias regiones, es preciso implementar la aplicación y los datos de referencia juntos en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-301">To meet the multiple-region disaster recovery requirements, you must deploy the application and the reference data together in multiple regions.</span></span> <span data-ttu-id="3b497-302">Puede implementar datos de referencia en el propio rol, a un almacenamiento externo o una combinación de ambos.</span><span class="sxs-lookup"><span data-stu-id="3b497-302">You can deploy reference data to the role itself, to external storage, or to a combination of both.</span></span>

<span data-ttu-id="3b497-303">El modelo de implementación de datos de referencia en los nodos de proceso cumple implícitamente los requisitos de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-303">The reference data deployment model within compute nodes implicitly satisfies the disaster recovery requirements.</span></span> <span data-ttu-id="3b497-304">La implementación de datos de referencia en SQL Database requiere que se implemente una copia de los datos de referencia en cada región.</span><span class="sxs-lookup"><span data-stu-id="3b497-304">Reference data deployment to SQL Database requires that you deploy a copy of the reference data to each region.</span></span> <span data-ttu-id="3b497-305">La misma estrategia se aplica a Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="3b497-305">The same strategy applies to Azure Storage.</span></span> <span data-ttu-id="3b497-306">Debe implementar una copia de todos los datos de referencia almacenados en Azure Storage en las regiones principal y secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-306">You must deploy a copy of any reference data that's stored in Azure Storage to the primary and secondary regions.</span></span>

![Publicación de datos de referencia en las regiones principal y secundaria](./images/disaster-recovery-azure-applications/reference-data-publication-to-both-primary-and-secondary-regions.png)

<span data-ttu-id="3b497-308">Debe implementar sus propias rutinas de copia de seguridad específicas de la aplicación para todos los datos, incluidos los datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="3b497-308">You must implement your own application-specific backup routines for all data, including reference data.</span></span> <span data-ttu-id="3b497-309">Las copias con replicas geográficas entre regiones solo se utilizan en una interrupción del servicio en toda una región.</span><span class="sxs-lookup"><span data-stu-id="3b497-309">Geo-replicated copies across regions are used only in a region-wide service disruption.</span></span> <span data-ttu-id="3b497-310">Para evitar un tiempo de inactividad prolongado, implemente las partes críticas de los datos de la aplicación en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-310">To prevent extended downtime, deploy the mission-critical parts of the application’s data to the secondary region.</span></span> <span data-ttu-id="3b497-311">Para obtener un ejemplo de esta topología, consulte el [modelo activo-pasivo](#active-passive).</span><span class="sxs-lookup"><span data-stu-id="3b497-311">For an example of this topology, see the [active-passive model](#active-passive).</span></span>

### <a name="transactional-data-pattern-for-disaster-recovery"></a><span data-ttu-id="3b497-312">Patrón de datos transaccionales para la recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="3b497-312">Transactional data pattern for disaster recovery</span></span>
<span data-ttu-id="3b497-313">La implementación de una estrategia del modo de desastres totalmente funcional requiere la replicación asincrónica de los datos transaccionales en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-313">Implementation of a fully functional disaster mode strategy requires asynchronous replication of the transactional data to the secondary region.</span></span> <span data-ttu-id="3b497-314">Las ventanas de tiempo prácticas en las que puede producirse la replicación determinarán las características RPO de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-314">The practical time windows within which the replication can occur will determine the RPO characteristics of the application.</span></span> <span data-ttu-id="3b497-315">En la ventana de la replicación se pueden recuperar los datos perdidos de la región principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-315">You might still recover the data that was lost from the primary region during the replication window.</span></span> <span data-ttu-id="3b497-316">También puede combinarlos con los de la región secundaria más adelante.</span><span class="sxs-lookup"><span data-stu-id="3b497-316">You might also be able to merge with the secondary region later.</span></span>

<span data-ttu-id="3b497-317">Los siguientes ejemplos de arquitectura proporcionan algunas ideas de distintas formas de controlar los datos transaccionales en un escenario de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="3b497-317">The following architecture examples provide some ideas on different ways of handling transactional data in a failover scenario.</span></span> <span data-ttu-id="3b497-318">Es importante tener en cuenta que estos ejemplos no son exhaustivos.</span><span class="sxs-lookup"><span data-stu-id="3b497-318">It's important to note that these examples are not exhaustive.</span></span> <span data-ttu-id="3b497-319">Por ejemplo, las ubicaciones de almacenamiento intermedias, como las colas, pueden reemplazarse por Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="3b497-319">For example, intermediate storage locations such as queues might be replaced with Azure SQL Database.</span></span> <span data-ttu-id="3b497-320">Las propias colas pueden ser colas de Azure Storage o de Service Bus (consulte [Colas de Service Bus y colas de Azure: comparación y diferencias](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/)).</span><span class="sxs-lookup"><span data-stu-id="3b497-320">The queues themselves might be either Azure Storage or Azure Service Bus queues (see [Azure queues and Service Bus queues - compared and contrasted](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/)).</span></span> <span data-ttu-id="3b497-321">Los destinos de almacenamiento del servidor también pueden variar, como las tablas de Azure, en lugar de SQL Database.</span><span class="sxs-lookup"><span data-stu-id="3b497-321">Server storage destinations might also vary, such as Azure tables instead of SQL Database.</span></span> <span data-ttu-id="3b497-322">Además, pueden insertarse roles de trabajo como intermediarios en varios pasos.</span><span class="sxs-lookup"><span data-stu-id="3b497-322">In addition, worker roles might be inserted as intermediaries in various steps.</span></span> <span data-ttu-id="3b497-323">El objetivo es no emular estas arquitecturas exactamente, sino considerar diversas alternativas en la recuperación de datos transaccionales y los módulos relacionados.</span><span class="sxs-lookup"><span data-stu-id="3b497-323">The intent is not to emulate these architectures exactly, but to consider various alternatives in the recovery of transactional data and related modules.</span></span>

#### <a name="replication-of-transactional-data-in-preparation-for-disaster-recovery"></a><span data-ttu-id="3b497-324">Replicación de datos transaccionales en preparación para la recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="3b497-324">Replication of transactional data in preparation for disaster recovery</span></span>
<span data-ttu-id="3b497-325">Considere una aplicación que utiliza las colas de Azure Storage para contener datos transaccionales.</span><span class="sxs-lookup"><span data-stu-id="3b497-325">Consider an application that uses Azure Storage queues to hold transactional data.</span></span> <span data-ttu-id="3b497-326">Esto permite que los roles de trabajo procesen dichos datos transaccionales en la base de datos de servidor en una arquitectura desacoplada.</span><span class="sxs-lookup"><span data-stu-id="3b497-326">This allows worker roles to process the transactional data to the server database in a decoupled architecture.</span></span> <span data-ttu-id="3b497-327">Esto requiere que las transacciones utilicen alguna forma de caché temporal si los roles de front-end requieren la consulta inmediata de dichos datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-327">This requires the transactions to use some form of temporary caching if the front-end roles require the immediate query of that data.</span></span> <span data-ttu-id="3b497-328">En función del nivel de tolerancia de la pérdida de datos, puede elegir replicar las colas, la base de datos o todos los recursos de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="3b497-328">Depending on the level of data-loss tolerance, you might choose to replicate the queues, the database, or all of the storage resources.</span></span> <span data-ttu-id="3b497-329">Con solo la replicación de la base de datos, si la región principal deja de funcionar, puede recuperar los datos de las colas cuando dicha región vuelva a funcionar.</span><span class="sxs-lookup"><span data-stu-id="3b497-329">With only database replication, if the primary region goes down, you can still recover the data in the queues when the primary region comes back.</span></span>

<span data-ttu-id="3b497-330">El siguiente diagrama muestra una arquitectura en la que la base de datos de servidor está sincronizada entre regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-330">The following diagram shows an architecture where the server database is synchronized across regions.</span></span>

![Replicación de datos transaccionales en preparación para la recuperación ante desastres](./images/disaster-recovery-azure-applications/replicate-transactional-data-in-preparation-for-disaster-recovery.png)

<span data-ttu-id="3b497-332">El mayor desafío a la hora de implementar esta arquitectura es la estrategia de replicación entre regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-332">The biggest challenge to implementing this architecture is the replication strategy between regions.</span></span> <span data-ttu-id="3b497-333">El servicio [Azure SQL Data Sync](/azure/sql-database/sql-database-get-started-sql-data-sync/) permite este tipo de replicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-333">The [Azure SQL Data Sync](/azure/sql-database/sql-database-get-started-sql-data-sync/) service enables this type of replication.</span></span> <span data-ttu-id="3b497-334">En el momento de la redacción de este artículo, dicho servicio existe en versión preliminar y no se recomienda en entornos de producción.</span><span class="sxs-lookup"><span data-stu-id="3b497-334">As of this writing, the service is in preview and is not yet recommended for production environments.</span></span> <span data-ttu-id="3b497-335">Para más información, consulte [Información general: continuidad del negocio en la nube y recuperación ante desastres con la SQL Database](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="3b497-335">For more information, see [Overview: Cloud business continuity and database disaster recovery with SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span> <span data-ttu-id="3b497-336">Para las aplicaciones de producción, debe invertir en una solución de terceros o crear su propia lógica de replicación en el código.</span><span class="sxs-lookup"><span data-stu-id="3b497-336">For production applications, you must invest in a third-party solution or create your own replication logic in code.</span></span> <span data-ttu-id="3b497-337">En función de la arquitectura, la replicación puede ser bidireccional, que es más compleja.</span><span class="sxs-lookup"><span data-stu-id="3b497-337">Depending on the architecture, the replication might be bidirectional, which is more complex.</span></span>

<span data-ttu-id="3b497-338">Una posible implementación podría hacer uso de la cola intermedia del ejemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="3b497-338">One potential implementation might make use of the intermediate queue in the previous example.</span></span> <span data-ttu-id="3b497-339">El rol de trabajo que procesa los datos en el destino de almacenamiento final puede realizar el cambio en las regiones principal y secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-339">The worker role that processes the data to the final storage destination might make the change in both the primary region and the secondary region.</span></span> <span data-ttu-id="3b497-340">Estas tareas no son triviales y una guía completa para el código de replicación está fuera del ámbito de este artículo.</span><span class="sxs-lookup"><span data-stu-id="3b497-340">These are not trivial tasks, and complete guidance for replication code is beyond the scope of this article.</span></span> <span data-ttu-id="3b497-341">Dedique tiempo suficiente y realice las pruebas necesarias de la estrategia para replicar datos en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-341">Invest significant time and testing into the approach for replicating data to the secondary region.</span></span> <span data-ttu-id="3b497-342">Las pruebas y procesamientos adicionales pueden contribuir a garantizar que los procesos de recuperación y de conmutación por error controlen correctamente todas las posibles incoherencias de los datos o transacciones duplicadas.</span><span class="sxs-lookup"><span data-stu-id="3b497-342">Additional processing and testing can help ensure that the failover and recovery processes correctly handle any possible data inconsistencies or duplicate transactions.</span></span>

> [!NOTE]
> <span data-ttu-id="3b497-343">La mayor parte de este documento se centra en Plataforma como servicio (PaaS).</span><span class="sxs-lookup"><span data-stu-id="3b497-343">Most of this paper focuses on platform as a service (PaaS).</span></span> <span data-ttu-id="3b497-344">Sin embargo, las opciones de replicación y disponibilidad adicionales para las aplicaciones híbridas utilizan Azure Virtual Machines.</span><span class="sxs-lookup"><span data-stu-id="3b497-344">However, additional replication and availability options for hybrid applications use Azure Virtual Machines.</span></span> <span data-ttu-id="3b497-345">Estas aplicaciones híbridas usan Infraestructura como servicio (IaaS) para hospedar SQL Server en máquinas virtuales de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-345">These hybrid applications use infrastructure as a service (IaaS) to host SQL Server on virtual machines in Azure.</span></span> <span data-ttu-id="3b497-346">Esto permite enfoques tradicionales de disponibilidad en SQL Server, como grupos de disponibilidad AlwaysOn o trasvase de registros.</span><span class="sxs-lookup"><span data-stu-id="3b497-346">This allows traditional availability approaches in SQL Server, such as AlwaysOn Availability Groups or Log Shipping.</span></span> <span data-ttu-id="3b497-347">Algunas técnicas, como AlwaysOn, solo funcionan entre instancias de SQL Server locales y máquinas virtuales de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-347">Some techniques, such as AlwaysOn, work only between on-premises SQL Server instances and Azure virtual machines.</span></span> <span data-ttu-id="3b497-348">Para más información, consulte [Alta disponibilidad y recuperación ante desastres para SQL Server en Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="3b497-348">For more information, see [High availability and disaster recovery for SQL Server in Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>
>
> 

#### <a name="reduced-application-functionality-for-transaction-capture"></a><span data-ttu-id="3b497-349">Funcionalidad reducida de la aplicación para la captura de transacciones</span><span class="sxs-lookup"><span data-stu-id="3b497-349">Reduced application functionality for transaction capture</span></span>
<span data-ttu-id="3b497-350">Considere una segunda arquitectura que opere con funcionalidad reducida.</span><span class="sxs-lookup"><span data-stu-id="3b497-350">Consider a second architecture that operates with reduced functionality.</span></span> <span data-ttu-id="3b497-351">La aplicación de la región secundaria desactiva toda la funcionalidad, como informes, inteligencia empresarial (BI) o colas de drenaje.</span><span class="sxs-lookup"><span data-stu-id="3b497-351">The application in the secondary region deactivates all the functionality, such as reporting, business intelligence (BI), or draining queues.</span></span> <span data-ttu-id="3b497-352">Solo acepta los tipos más importantes de flujos de trabajo transaccionales de acuerdo con los requisitos empresariales.</span><span class="sxs-lookup"><span data-stu-id="3b497-352">It accepts only the most important types of transactional workflows, as defined by business requirements.</span></span> <span data-ttu-id="3b497-353">El sistema captura las transacciones y las escribe en las colas.</span><span class="sxs-lookup"><span data-stu-id="3b497-353">The system captures the transactions and writes them to queues.</span></span> <span data-ttu-id="3b497-354">El sistema puede posponer el procesamiento de los datos durante la fase inicial de la interrupción del servicio.</span><span class="sxs-lookup"><span data-stu-id="3b497-354">The system might postpone processing the data during the initial stage of the service disruption.</span></span> <span data-ttu-id="3b497-355">Si el sistema de la región principal se reactiva en la ventana de tiempo esperado, los roles de trabajo de la región principal pueden purgar las colas.</span><span class="sxs-lookup"><span data-stu-id="3b497-355">If the system on the primary region is reactivated within the expected time window, the worker roles in the primary region can drain the queues.</span></span> <span data-ttu-id="3b497-356">Este proceso elimina la necesidad de combinar bases de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-356">This process eliminates the need for database merging.</span></span> <span data-ttu-id="3b497-357">Si la interrupción del servicio de la región principal va más allá de la ventana tolerable, la aplicación puede empezar a procesar las colas.</span><span class="sxs-lookup"><span data-stu-id="3b497-357">If the primary region service disruption goes beyond the tolerable window, the application can start processing the queues.</span></span>

<span data-ttu-id="3b497-358">En este escenario, la base de datos de la región secundaria contiene datos transaccionales incrementales que se deben combinar después de que la principal se reactive.</span><span class="sxs-lookup"><span data-stu-id="3b497-358">In this scenario, the database in the secondary region contains incremental transactional data that must be merged after the primary is reactivated.</span></span> <span data-ttu-id="3b497-359">El diagrama siguiente muestra esta estrategia para almacenar temporalmente datos transaccionales hasta que se restaure la región principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-359">The following diagram shows this strategy for temporarily storing transactional data until the primary region is restored.</span></span>

![Funcionalidad reducida de la aplicación para la captura de transacciones](./images/disaster-recovery-azure-applications/reduced-application-functionality-for-transaction-capture.png)

<span data-ttu-id="3b497-361">Para más información acerca de las técnicas de administración de datos para aplicaciones de Azure resistentes, consulte [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe)(Failsafe: Guía para las arquitecturas resistentes en la nube).</span><span class="sxs-lookup"><span data-stu-id="3b497-361">For more discussion of data management techniques for resilient Azure applications, see [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe).</span></span>

## <a name="deployment-topologies-for-disaster-recovery"></a><span data-ttu-id="3b497-362">Topologías de implementación para recuperación ante desastres</span><span class="sxs-lookup"><span data-stu-id="3b497-362">Deployment topologies for disaster recovery</span></span>
<span data-ttu-id="3b497-363">Debe preparar aplicaciones críticas para abordar interrupciones del servicio en toda una región.</span><span class="sxs-lookup"><span data-stu-id="3b497-363">You must prepare mission-critical applications to handle region-wide service disruptions.</span></span> <span data-ttu-id="3b497-364">Incorpore al planeamiento operativo una estrategia de implementación en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-364">Incorporate a multiple-region deployment strategy into the operational planning.</span></span>

<span data-ttu-id="3b497-365">Las implementaciones en varias regiones pueden implicar procesos de TI para publicar la aplicación y los datos de referencia en la región secundaria después de un desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-365">Multiple-region deployments might involve IT processes to publish the application and reference data to the secondary region after a disaster.</span></span> <span data-ttu-id="3b497-366">Si la aplicación requiere una conmutación por error instantánea, el proceso de implementación puede implicar una configuración activa/activa o activa/pasiva.</span><span class="sxs-lookup"><span data-stu-id="3b497-366">If the application requires instant failover, the deployment process might involve an active/passive setup or an active/active setup.</span></span> <span data-ttu-id="3b497-367">Este tipo de implementación tiene instancias existentes de la aplicación que se ejecutan en la región alternativa.</span><span class="sxs-lookup"><span data-stu-id="3b497-367">This type of deployment has existing instances of the application running in the alternate region.</span></span> <span data-ttu-id="3b497-368">Un servicio de enrutamiento, como Azure Traffic Manager, proporciona servicios de equilibrio de carga a nivel de DNS.</span><span class="sxs-lookup"><span data-stu-id="3b497-368">A routing service such as Azure Traffic Manager provides load-balancing services at the DNS level.</span></span> <span data-ttu-id="3b497-369">Puede detectar interrupciones del servicio y enrutar a los usuarios a distintas regiones cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="3b497-369">It can detect service disruptions and route the users to different regions when needed.</span></span>

<span data-ttu-id="3b497-370">Una correcta recuperación ante desastres de Azure implica crear dicha recuperación en la solución desde el principio.</span><span class="sxs-lookup"><span data-stu-id="3b497-370">A successful Azure disaster recovery includes building that recovery into the solution from the start.</span></span> <span data-ttu-id="3b497-371">La nube proporciona opciones adicionales para recuperarse de errores durante un desastre que no pueden ofrecer los proveedores de hospedaje tradicionales.</span><span class="sxs-lookup"><span data-stu-id="3b497-371">The cloud provides additional options for recovering from failures during a disaster that are not available in a traditional hosting provider.</span></span> <span data-ttu-id="3b497-372">En concreto, puede asignar recursos de manera dinámica y rápida en una región distinta, evitando así el costo que acarrean los recursos inactivos antes de un error.</span><span class="sxs-lookup"><span data-stu-id="3b497-372">Specifically, you can dynamically and quickly allocate resources in a different region, avoiding the cost of idle resources prior to a failure.</span></span>

<span data-ttu-id="3b497-373">En las secciones siguientes se tratan las diferentes topologías de implementación existentes para la recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-373">The following sections cover different deployment topologies for disaster recovery.</span></span> <span data-ttu-id="3b497-374">Normalmente, hay un aumento del costo o la complejidad si se desea mayor disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="3b497-374">Typically, there's a tradeoff in increased cost or complexity for additional availability.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="3b497-375">Implementación en una sola región</span><span class="sxs-lookup"><span data-stu-id="3b497-375">Single-region deployment</span></span>
<span data-ttu-id="3b497-376">Una implementación en una sola región no es realmente una topología de recuperación ante desastres, pero supone un contraste con respecto a las restantes arquitecturas.</span><span class="sxs-lookup"><span data-stu-id="3b497-376">A single-region deployment is not really a disaster recovery topology, but is meant to contrast with the other architectures.</span></span> <span data-ttu-id="3b497-377">Las implementaciones en una sola región son frecuentes en aplicaciones de Azure. Sin embargo, no cumplen los requisitos de una topología de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-377">Single-region deployments are common for applications in Azure; however, they do not meet the requirements of a disaster recovery topology.</span></span>

<span data-ttu-id="3b497-378">El siguiente diagrama muestra una aplicación que se ejecuta en una sola región de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-378">The following diagram depicts an application running in a single Azure region.</span></span> <span data-ttu-id="3b497-379">El Administrador de tráfico de Azure y el uso de dominios de error y de actualización aumentan la disponibilidad de la aplicación dentro de la región.</span><span class="sxs-lookup"><span data-stu-id="3b497-379">Azure Traffic Manager and the use of fault and upgrade domains increase availability of the application within the region.</span></span>

![Implementación en una sola región](./images/disaster-recovery-azure-applications/single-region-deployment.png)

<span data-ttu-id="3b497-381">En este escenario, la base de datos es un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="3b497-381">In this scenario, the database is a single point of failure.</span></span> <span data-ttu-id="3b497-382">Aunque Azure replica los datos a través de distintos dominios de error de manera interna, la replicación solo se produce en la misma región.</span><span class="sxs-lookup"><span data-stu-id="3b497-382">Though Azure replicates the data across different fault domains to internal replicas, this replication occurs only within the same region.</span></span> <span data-ttu-id="3b497-383">La aplicación no puede resistir un error catastrófico.</span><span class="sxs-lookup"><span data-stu-id="3b497-383">The application cannot withstand a catastrophic failure.</span></span> <span data-ttu-id="3b497-384">Si la región deja de estar disponible, también dejarán de estarlo los dominios de error, lo que incluye todas las instancias de servicio y los recursos de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="3b497-384">If the region becomes unavailable, then so do the fault domains, including all service instances and storage resources.</span></span>

<span data-ttu-id="3b497-385">Debe idear un plan para implementar su aplicación en varias regiones, salvo en el caso de las aplicaciones menos críticas.</span><span class="sxs-lookup"><span data-stu-id="3b497-385">For all but the least critical applications, you must devise a plan to deploy your applications across multiple regions.</span></span> <span data-ttu-id="3b497-386">Al plantearse qué topología de implementación va a utilizar, también debe tener en cuenta las restricciones de costo y el RTO.</span><span class="sxs-lookup"><span data-stu-id="3b497-386">You should also consider RTO and cost constraints in considering which deployment topology to use.</span></span>

<span data-ttu-id="3b497-387">Examinemos varias estrategias concretas para admitir la conmutación por error en diferentes regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-387">Let's take a look now at specific approaches to supporting failover across different regions.</span></span> <span data-ttu-id="3b497-388">Todos estos ejemplos utilizan dos regiones para describir el proceso.</span><span class="sxs-lookup"><span data-stu-id="3b497-388">These examples all use two regions to describe the process.</span></span>

### <a name="failover-using-azure-site-recovery"></a><span data-ttu-id="3b497-389">Conmutación por error con Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="3b497-389">Failover using Azure Site Recovery</span></span>

<span data-ttu-id="3b497-390">Cuando se habilita la replicación de máquinas virtuales de Azure con Azure Site Recovery, se crean varios recursos en la región secundaria:</span><span class="sxs-lookup"><span data-stu-id="3b497-390">When you enable Azure VM replication using Azure Site Recovery, it creates several resources in the secondary region:</span></span>

- <span data-ttu-id="3b497-391">Un grupo de recursos</span><span class="sxs-lookup"><span data-stu-id="3b497-391">Resource group.</span></span>
- <span data-ttu-id="3b497-392">Una red virtual (VNet)</span><span class="sxs-lookup"><span data-stu-id="3b497-392">Virtual network (VNet).</span></span>
- <span data-ttu-id="3b497-393">Una cuenta de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="3b497-393">Storage account.</span></span> 
- <span data-ttu-id="3b497-394">Unos conjuntos de disponibilidad que albergan las máquinas virtuales después de la conmutación por error</span><span class="sxs-lookup"><span data-stu-id="3b497-394">Availability sets to hold VMs after failover.</span></span>

<span data-ttu-id="3b497-395">Las escrituras de datos que se realizan en los discos de las máquinas virtuales de la región primaria se transfieren de forma continuada a la cuenta de almacenamiento de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-395">Data writes on the VM disks in the primary region are continuously transferred to the storage account in the secondary region.</span></span> <span data-ttu-id="3b497-396">Cada pocos minutos se generan puntos de recuperación en la cuenta de almacenamiento de destino.</span><span class="sxs-lookup"><span data-stu-id="3b497-396">Recovery points are generated in the target storage account every few minutes.</span></span> <span data-ttu-id="3b497-397">Cuando se inicia una conmutación por error, las máquinas virtuales recuperadas se crean en el grupo de recursos, VNet y el conjunto de disponibilidad de destino.</span><span class="sxs-lookup"><span data-stu-id="3b497-397">When you initiate a failover, the recovered VMs are created in the target resource group, VNet, and availability set.</span></span> <span data-ttu-id="3b497-398">Durante una conmutación por error, puede elegir cualquier punto de recuperación disponible.</span><span class="sxs-lookup"><span data-stu-id="3b497-398">During a failover, you can choose any available recovery point.</span></span>


### <a name="redeployment-to-a-secondary-azure-region"></a><span data-ttu-id="3b497-399">Reimplementación en una región de Azure secundaria</span><span class="sxs-lookup"><span data-stu-id="3b497-399">Redeployment to a secondary Azure region</span></span>
<span data-ttu-id="3b497-400">En la estrategia de reimplementación en una región secundaria, solo la región principal tiene aplicaciones y bases de datos en ejecución.</span><span class="sxs-lookup"><span data-stu-id="3b497-400">For the approach of redeployment to a secondary region, only the primary region has applications and databases running.</span></span> <span data-ttu-id="3b497-401">La región secundaria no está configurada para una conmutación por error automática.</span><span class="sxs-lookup"><span data-stu-id="3b497-401">The secondary region is not set up for an automatic failover.</span></span> <span data-ttu-id="3b497-402">Por consiguiente, si se produce un desastre, será preciso poner en marcha todas las partes del servicio en la nueva región.</span><span class="sxs-lookup"><span data-stu-id="3b497-402">So when a disaster occurs, you must spin up all the parts of the service in the new region.</span></span> <span data-ttu-id="3b497-403">Esto incluye la carga de un servicio en la nube en Azure, la implementación del servicio en la nube, la restauración de los datos y el cambio del DNS para reenrutar el tráfico.</span><span class="sxs-lookup"><span data-stu-id="3b497-403">This includes uploading a cloud service to Azure, deploying the cloud service, restoring the data, and changing DNS to reroute the traffic.</span></span>

<span data-ttu-id="3b497-404">Aunque esta es la más asequible de todas las opciones para varias regiones, también es la que tiene las peores características de RTO.</span><span class="sxs-lookup"><span data-stu-id="3b497-404">Although this is the most affordable of the multiple-region options, it has the worst RTO characteristics.</span></span> <span data-ttu-id="3b497-405">En este modelo, las copias de seguridad de base de datos y el paquete de servicio se almacenan localmente o en la instancia de Almacenamiento de blobs de Azure de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-405">In this model, the service package and database backups are stored either on-premises or in the Azure Blob storage instance of the secondary region.</span></span> <span data-ttu-id="3b497-406">Sin embargo, antes de reanudar el funcionamiento es preciso implementar un nuevo servicio y restaurar los datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-406">However, you must deploy a new service and restore the data before it resumes operation.</span></span> <span data-ttu-id="3b497-407">Aunque la transferencia de datos desde el almacenamiento de copias de seguridad esté completamente automatizada, el aprovisionamiento del nuevo entorno de base de datos consume mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="3b497-407">Even with full automation of the data transfer from backup storage, provisioning a new database environment consumes a lot of time.</span></span> <span data-ttu-id="3b497-408">La parte más cara del proceso de restauración es el movimiento de datos desde el almacenamiento en disco de copias de seguridad a la base de datos vacía de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-408">Moving data from the backup disk storage to the empty database on the secondary region is the most expensive part of the restore process.</span></span> <span data-ttu-id="3b497-409">Sin embargo, esta operación debe realizarse para poner la base de datos nueva en estado operativo, ya que no se ha replicado.</span><span class="sxs-lookup"><span data-stu-id="3b497-409">You must do this, however, to bring the new database to an operational state because it isn't replicated.</span></span>

<span data-ttu-id="3b497-410">Lo mejor es almacenar los paquetes de servicio en el Almacenamiento de blobs de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-410">The best approach is to store the service packages in Blob storage in the secondary region.</span></span> <span data-ttu-id="3b497-411">De esta forma se elimina la necesidad de cargar el paquete en Azure, que es lo que ocurre cuando la implementación se realiza desde una máquina de desarrollo local.</span><span class="sxs-lookup"><span data-stu-id="3b497-411">This eliminates the need to upload the package to Azure, which is what happens when you deploy from an on-premises development machine.</span></span> <span data-ttu-id="3b497-412">Con los scripts de PowerShell es posible implementar rápidamente los paquetes de servicio en un servicio en la nube nuevo desde el Almacenamiento de blobs.</span><span class="sxs-lookup"><span data-stu-id="3b497-412">You can quickly deploy the service packages to a new cloud service from Blob storage by using PowerShell scripts.</span></span>

<span data-ttu-id="3b497-413">Esta opción solo es práctica para las aplicaciones no críticas que pueden tolerar un RTO elevado.</span><span class="sxs-lookup"><span data-stu-id="3b497-413">This option is practical only for non-critical applications that can tolerate a high RTO.</span></span> <span data-ttu-id="3b497-414">Por ejemplo, puede funcionar en una aplicación que pueda estar inactiva durante varias horas, pero que deba estar disponible en menos de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="3b497-414">For instance, this might work for an application that can be down for several hours but is required to be available within 24 hours.</span></span>

![Reimplementación en una región de Azure secundaria](./images/disaster-recovery-azure-applications/redeploy-to-a-secondary-azure-region.png)

### <a name="active-passive"></a><span data-ttu-id="3b497-416">Activo-pasivo</span><span class="sxs-lookup"><span data-stu-id="3b497-416">Active-passive</span></span>
<span data-ttu-id="3b497-417">La topología activa-pasiva es la opción favorita de muchas empresas,</span><span class="sxs-lookup"><span data-stu-id="3b497-417">An active-passive topology is the choice that many companies favor.</span></span> <span data-ttu-id="3b497-418">ya que proporciona mejoras en el RTO con un aumento relativamente pequeño del costo, con respecto a la estrategia de reimplementación.</span><span class="sxs-lookup"><span data-stu-id="3b497-418">This topology provides improvements to the RTO with a relatively small increase in cost over the redeployment approach.</span></span> <span data-ttu-id="3b497-419">En este escenario, de nuevo hay una región principal y una región secundaria de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-419">In this scenario, there is again a primary and a secondary Azure region.</span></span> <span data-ttu-id="3b497-420">Todo el tráfico se dirige a la implementación activa de la región principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-420">All of the traffic goes to the active deployment on the primary region.</span></span> <span data-ttu-id="3b497-421">La región secundaria está mejor preparada para la recuperación ante desastres, ya que la base de datos se ejecuta en ambas regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-421">The secondary region is better prepared for disaster recovery because the database is running on both regions.</span></span> <span data-ttu-id="3b497-422">Además, hay un mecanismo de sincronización en vigor entre ellas.</span><span class="sxs-lookup"><span data-stu-id="3b497-422">Additionally, a synchronization mechanism is in place between them.</span></span> <span data-ttu-id="3b497-423">Este enfoque en espera puede implicar dos variaciones: un enfoque de solo la base de datos o una implementación completa en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-423">This standby approach can involve two variations: a database-only approach or a complete deployment in the secondary region.</span></span>

#### <a name="database-only"></a><span data-ttu-id="3b497-424">Solo base de datos</span><span class="sxs-lookup"><span data-stu-id="3b497-424">Database only</span></span>
<span data-ttu-id="3b497-425">En la primera variación de la estrategia activa-pasiva, la región principal es la única en que se implementa una aplicación de servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-425">In the first variation of the active-passive topology, only the primary region has a deployed cloud service application.</span></span> <span data-ttu-id="3b497-426">Sin embargo, a diferencia de la estrategia de reimplementación, ambas regiones se sincronizan con el contenido de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-426">However, unlike the redeployment approach, both regions are synchronized with the contents of the database.</span></span> <span data-ttu-id="3b497-427">Para más información, consulte la sección [Patrón de datos transaccionales para la recuperación ante desastres](#transactional-data-pattern-for-disaster-recovery). Cuando se produce un desastre, hay menos requisitos de activación.</span><span class="sxs-lookup"><span data-stu-id="3b497-427">(For more information, see the section on [transactional data pattern for disaster recovery](#transactional-data-pattern-for-disaster-recovery).) When a disaster occurs, there are fewer activation requirements.</span></span> <span data-ttu-id="3b497-428">Inicie la aplicación de la región secundaria, cambie las cadenas de conexión a la base de datos nueva y cambiar las entradas DNS para reenrutar el tráfico.</span><span class="sxs-lookup"><span data-stu-id="3b497-428">You start the application in the secondary region, change connection strings to the new database, and change the DNS entries to reroute traffic.</span></span>

<span data-ttu-id="3b497-429">Al igual que en la estrategia de reimplementación, para agilizar la implementación, los paquetes de servicio deben haberse almacenado previamente en Azure Blob Storage en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-429">Like the redeployment approach, you should have already stored the service packages in Azure Blob storage in the secondary region for faster deployment.</span></span> <span data-ttu-id="3b497-430">A diferencia de la estrategia de reimplementación, no se incurre en la mayoría de la sobrecarga que requieren las operaciones de restauración de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-430">However, you don’t incur the majority of the overhead that database restore operation requires, because the database is ready and running.</span></span> <span data-ttu-id="3b497-431">Esto ahorra mucho tiempo, lo que hace que este sea el patrón de recuperación ante desastres más asequible (y el que más se utiliza).</span><span class="sxs-lookup"><span data-stu-id="3b497-431">This saves a significant amount of time, making this an affordable DR pattern (and the one most frequently used).</span></span>

![Activo-pasivo (solo base de datos)](./images/disaster-recovery-azure-applications/active-passive-database-only.png)

#### <a name="full-replica"></a><span data-ttu-id="3b497-433">Réplica completa</span><span class="sxs-lookup"><span data-stu-id="3b497-433">Full replica</span></span>
<span data-ttu-id="3b497-434">En la segunda variación de la topología activa-pasiva, tanto la región principal como la secundaria tienen una implementación completa.</span><span class="sxs-lookup"><span data-stu-id="3b497-434">In the second variation of the active-passive topology, both the primary region and the secondary region have a full deployment.</span></span> <span data-ttu-id="3b497-435">Esta implementación incluye los servicios en la nube y una base de datos sincronizada.</span><span class="sxs-lookup"><span data-stu-id="3b497-435">This deployment includes the cloud services and a synchronized database.</span></span> <span data-ttu-id="3b497-436">Sin embargo, la región principal es la única que controla activamente las solicitudes de red de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="3b497-436">However, only the primary region is actively handling network requests from the users.</span></span> <span data-ttu-id="3b497-437">La región secundaria no pasa a ser la activa hasta que la región principal experimenta una interrupción del servicio.</span><span class="sxs-lookup"><span data-stu-id="3b497-437">The secondary region becomes active only when the primary region experiences a service disruption.</span></span> <span data-ttu-id="3b497-438">En ese caso, todas las solicitudes de red nuevas se enrutan a la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-438">In that case, all new network requests route to the secondary region.</span></span> <span data-ttu-id="3b497-439">El Administrador de tráfico de Azure puede administrar esta conmutación por error de forma automática.</span><span class="sxs-lookup"><span data-stu-id="3b497-439">Azure Traffic Manager can manage this failover automatically.</span></span>

<span data-ttu-id="3b497-440">La conmutación por error se produce más rápidamente que la variación de solo la base de datos porque los servicios ya están implementados.</span><span class="sxs-lookup"><span data-stu-id="3b497-440">Failover occurs faster than the database-only variation because the services are already deployed.</span></span> <span data-ttu-id="3b497-441">Esta topología proporciona un objetivo de tiempo de recuperación muy bajo.</span><span class="sxs-lookup"><span data-stu-id="3b497-441">This topology provides a very low RTO.</span></span> <span data-ttu-id="3b497-442">La región de conmutación por error secundaria debe estar lista para empezar a funcionar inmediatamente después que se produzca un error en la región principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-442">The secondary failover region must be ready to go immediately after failure of the primary region.</span></span>

<span data-ttu-id="3b497-443">Junto con un tiempo de respuesta más rápido, esta topología preasigna e implementa servicios de copia de seguridad, lo que evita la posibilidad de que falte espacio para asignar nuevas instancias durante un desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-443">Along with a quicker response time, this topology pre-allocates and deploys backup services, avoiding the possibility of a lack of space to allocate new instances during a disaster.</span></span> <span data-ttu-id="3b497-444">Esto es importante si la región secundaria de Azure está cerca de alcanzar su capacidad máxima.</span><span class="sxs-lookup"><span data-stu-id="3b497-444">This is important if your secondary Azure region is nearing capacity.</span></span> <span data-ttu-id="3b497-445">Ningún contrato de nivel de servicio garantiza que puede implementar uno o más servicios de nube nuevos en cualquier región al instante.</span><span class="sxs-lookup"><span data-stu-id="3b497-445">No service-level agreement (SLA) guarantees that you can instantly deploy one or more new cloud services in any region.</span></span>

<span data-ttu-id="3b497-446">Para reducir al máximo el tiempo de respuesta con este modelo, es preciso tener una escala similar (número de instancias de rol) en las regiones principal y secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-446">For the fastest response time with this model, you must have similar scale (number of role instances) in the primary and secondary regions.</span></span> <span data-ttu-id="3b497-447">A pesar de las ventajas, es costoso pagar por instancias de proceso que no se utilizan, por lo que es posible que esta opción no sea la más prudente desde un punto de vista financiero.</span><span class="sxs-lookup"><span data-stu-id="3b497-447">Despite the advantages, paying for unused compute instances is costly, and this might not be the most prudent financial choice.</span></span> <span data-ttu-id="3b497-448">Por este motivo, es más habitual utilizar una versión ligeramente reducida de los servicios en la nube en la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-448">Because of this, it's more common to use a slightly scaled-down version of cloud services on the secondary region.</span></span> <span data-ttu-id="3b497-449">A partir de ahí, se podrá realizar rápidamente una conmutación por error y escalar horizontalmente la implementación secundaria, si fuera necesario.</span><span class="sxs-lookup"><span data-stu-id="3b497-449">Then you can quickly fail over and scale out the secondary deployment if necessary.</span></span> <span data-ttu-id="3b497-450">El proceso de conmutación por error se debe automatizar con el fin de que, una vez que no se pueda acceder a la región principal, active las instancias adicionales en función de la carga.</span><span class="sxs-lookup"><span data-stu-id="3b497-450">You should automate the failover process so that after the primary region is inaccessible, you activate additional instances, depending on the load.</span></span> <span data-ttu-id="3b497-451">Esto puede implicar el uso de un mecanismo de escalado automático, como los [conjuntos de escala de máquinas virtuales](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span><span class="sxs-lookup"><span data-stu-id="3b497-451">This might involve the use of an autoscaling mechanism like [virtual machine scale sets](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span></span>

<span data-ttu-id="3b497-452">El siguiente diagrama muestra el modelo en el que las regiones principal y secundaria contienen un servicio en la nube totalmente implementado en una topología activa-pasiva.</span><span class="sxs-lookup"><span data-stu-id="3b497-452">The following diagram shows the model where the primary and secondary regions contain a fully deployed cloud service in an active-passive topology.</span></span>

![Activo-pasivo (réplica completa)](./images/disaster-recovery-azure-applications/active-passive-full-replica.png)

### <a name="active-active"></a><span data-ttu-id="3b497-454">Activo-activo</span><span class="sxs-lookup"><span data-stu-id="3b497-454">Active-active</span></span>
<span data-ttu-id="3b497-455">En una topología activa-activa, tanto los servicios en la nube como la base de datos están totalmente implementados en ambas regiones.</span><span class="sxs-lookup"><span data-stu-id="3b497-455">In an active-active topology, the cloud services and database are fully deployed in both regions.</span></span> <span data-ttu-id="3b497-456">A diferencia del modelo activo-pasivo, ambas regiones reciben tráfico de usuarios.</span><span class="sxs-lookup"><span data-stu-id="3b497-456">Unlike the active-passive model, both regions receive user traffic.</span></span> <span data-ttu-id="3b497-457">Esta opción es la que tiene el menor tiempo de recuperación.</span><span class="sxs-lookup"><span data-stu-id="3b497-457">This option yields the quickest recovery time.</span></span> <span data-ttu-id="3b497-458">Los servicios ya se han escalado para controlar una parte de la carga en cada región.</span><span class="sxs-lookup"><span data-stu-id="3b497-458">The services are already scaled to handle a portion of the load at each region.</span></span> <span data-ttu-id="3b497-459">El DNS ya está habilitado para usar la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-459">DNS is already enabled to use the secondary region.</span></span> <span data-ttu-id="3b497-460">Hay mayor complejidad a la hora de determinar cómo enrutar los usuarios a la región adecuada.</span><span class="sxs-lookup"><span data-stu-id="3b497-460">There's additional complexity in determining how to route users to the appropriate region.</span></span> <span data-ttu-id="3b497-461">Se puede usar la programación round robin.</span><span class="sxs-lookup"><span data-stu-id="3b497-461">Round-robin scheduling might be possible.</span></span> <span data-ttu-id="3b497-462">Es más probable que determinados usuarios utilicen la región específica en la que reside la copia principal de sus datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-462">It's more likely that certain users would use a specific region where the primary copy of their data resides.</span></span>

<span data-ttu-id="3b497-463">En caso de conmutación por error, sencillamente deshabilite el DNS en la región principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-463">In case of failover, simply disable DNS to the primary region.</span></span> <span data-ttu-id="3b497-464">Esto enruta todo el tráfico a la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-464">This routes all traffic to the secondary region.</span></span>

<span data-ttu-id="3b497-465">Incluso en este modelo, hay algunas variaciones.</span><span class="sxs-lookup"><span data-stu-id="3b497-465">Even in this model, there are some variations.</span></span> <span data-ttu-id="3b497-466">Por ejemplo, el siguiente diagrama muestra una región principal que posee la copia maestra de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-466">For example, the following diagram depicts a primary region which owns the master copy of the database.</span></span> <span data-ttu-id="3b497-467">Los servicios en la nube de ambas regiones escriben en dicha base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3b497-467">The cloud services in both regions write to that primary database.</span></span> <span data-ttu-id="3b497-468">La implementación de la región secundaria puede leer tanto de la base de datos principal como de la replicada.</span><span class="sxs-lookup"><span data-stu-id="3b497-468">The secondary deployment can read from the primary or replicated database.</span></span> <span data-ttu-id="3b497-469">En este ejemplo, la replicación es unidireccional.</span><span class="sxs-lookup"><span data-stu-id="3b497-469">Replication in this example is one-way.</span></span>

![Activo-activo](./images/disaster-recovery-azure-applications/active-active.png)

<span data-ttu-id="3b497-471">La arquitectura de activo-activo del diagrama anterior tiene una desventaja.</span><span class="sxs-lookup"><span data-stu-id="3b497-471">There is a downside to the active-active architecture in the preceding diagram.</span></span> <span data-ttu-id="3b497-472">La segunda región debe tener acceso a la base de datos de la primera región, ya que es ahí donde reside la copia maestra.</span><span class="sxs-lookup"><span data-stu-id="3b497-472">The second region must access the database in the first region because the master copy resides there.</span></span> <span data-ttu-id="3b497-473">El rendimiento disminuye considerablemente cuando se accede a los datos desde fuera de una región.</span><span class="sxs-lookup"><span data-stu-id="3b497-473">Performance significantly drops off when you access data from outside a region.</span></span> <span data-ttu-id="3b497-474">En las llamadas a la base de datos entre regiones, es preciso considerar algún tipo de estrategia de procesamiento por lotes para mejorar el rendimiento de estas llamadas.</span><span class="sxs-lookup"><span data-stu-id="3b497-474">In cross-region database calls, you should consider some type of batching strategy to improve the performance of these calls.</span></span> <span data-ttu-id="3b497-475">Para más información, consulte [Uso del procesamiento por lotes para mejorar el rendimiento de las aplicaciones de SQL Database](/azure/sql-database/sql-database-use-batching-to-improve-performance/).</span><span class="sxs-lookup"><span data-stu-id="3b497-475">For more information, see [How to use batching to improve SQL Database application performance](/azure/sql-database/sql-database-use-batching-to-improve-performance/).</span></span>

<span data-ttu-id="3b497-476">Una arquitectura alternativa podría implicar que cada región accediera directamente a su propia base de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-476">An alternative architecture might involve each region accessing its own database directly.</span></span> <span data-ttu-id="3b497-477">En este modelo, se necesita cierto tipo de replicación bidireccional para sincronizar las bases de datos en cada región.</span><span class="sxs-lookup"><span data-stu-id="3b497-477">In that model, some type of bidirectional replication is required to synchronize the databases in each region.</span></span>

<span data-ttu-id="3b497-478">Con las topologías anteriores, al reducir el objetivo de tiempo de recuperación generalmente se incrementan los costos y la complejidad.</span><span class="sxs-lookup"><span data-stu-id="3b497-478">With the previous topologies, decreasing RTO generally increases costs and complexity.</span></span> <span data-ttu-id="3b497-479">La topología activa-activa se desvía de este patrón de costo.</span><span class="sxs-lookup"><span data-stu-id="3b497-479">The active-active topology deviates from this cost pattern.</span></span> <span data-ttu-id="3b497-480">En la topología activa-activa, es posible que no se necesiten tantas instancias en la región principal como en la topología activa-pasiva.</span><span class="sxs-lookup"><span data-stu-id="3b497-480">In the active-active topology, you might not need as many instances on the primary region as you would in the active-passive topology.</span></span> <span data-ttu-id="3b497-481">Si en una arquitectura de activo-pasivo hay diez instancias en la región principal, es posible que solo se necesiten cinco en cada región en una arquitectura de activo-activo.</span><span class="sxs-lookup"><span data-stu-id="3b497-481">If you have 10 instances on the primary region in an active-passive architecture, you might need only 5 in each region in an active-active architecture.</span></span> <span data-ttu-id="3b497-482">Ahora ambas regiones comparten la carga.</span><span class="sxs-lookup"><span data-stu-id="3b497-482">Both regions now share the load.</span></span> <span data-ttu-id="3b497-483">Esto puede suponer un ahorro de costos sobre la topología activa-pasiva si se mantiene una espera semiactiva en la región pasiva con diez instancias en espera de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="3b497-483">This might be a cost savings over the active-passive topology if you keep a warm standby on the passive region with 10 instances waiting for failover.</span></span>

<span data-ttu-id="3b497-484">Tenga en cuenta que hasta que se restaure la región principal, la región secundaria puede recibir una sobrecarga repentina de nuevos usuarios.</span><span class="sxs-lookup"><span data-stu-id="3b497-484">Realize that until you restore the primary region, the secondary region might receive a sudden surge of new users.</span></span> <span data-ttu-id="3b497-485">Si había 10 000 usuarios en cada servidor al producirse la interrupción del servicio en la región principal, la región secundaria tiene que administrar repentinamente 20 000 usuarios.</span><span class="sxs-lookup"><span data-stu-id="3b497-485">If there are 10,000 users on each server when the primary region experiences a service disruption, the secondary region suddenly has to handle 20,000 users.</span></span> <span data-ttu-id="3b497-486">Las reglas de supervisión de la región secundaria deben detectar este incremento y duplicar las instancias de la región secundaria.</span><span class="sxs-lookup"><span data-stu-id="3b497-486">Monitoring rules on the secondary region must detect this increase and double the instances in the secondary region.</span></span> <span data-ttu-id="3b497-487">Para más información, consulte la sección sobre [detección de errores](#failure-detection).</span><span class="sxs-lookup"><span data-stu-id="3b497-487">For more information on this, see the section on [failure detection](#failure-detection).</span></span>

## <a name="hybrid-on-premises-and-cloud-solution"></a><span data-ttu-id="3b497-488">solución híbrida local y en la nube</span><span class="sxs-lookup"><span data-stu-id="3b497-488">Hybrid on-premises and cloud solution</span></span>
<span data-ttu-id="3b497-489">Una estrategia adicional para la recuperación ante desastres es diseñar una aplicación híbrida que se ejecute de manera local y en la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-489">One additional strategy for disaster recovery is to architect a hybrid application that runs on-premises and in the cloud.</span></span> <span data-ttu-id="3b497-490">En función de la aplicación, la región principal puede estar en cualquier ubicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-490">Depending on the application, the primary region might be either location.</span></span> <span data-ttu-id="3b497-491">Piense en las arquitecturas anteriores e imagine las regiones principal o secundaria como una ubicación local.</span><span class="sxs-lookup"><span data-stu-id="3b497-491">Consider the previous architectures and imagine the primary or secondary region as an on-premises location.</span></span>

<span data-ttu-id="3b497-492">Estas arquitecturas híbridas plantean algunos desafíos.</span><span class="sxs-lookup"><span data-stu-id="3b497-492">There are some challenges in these hybrid architectures.</span></span> <span data-ttu-id="3b497-493">En primer lugar, la mayor parte de este artículo ha abordado patrones de arquitectura de PaaS.</span><span class="sxs-lookup"><span data-stu-id="3b497-493">First, most of this article has addressed PaaS architecture patterns.</span></span> <span data-ttu-id="3b497-494">Las aplicaciones típicas de PaaS en Azure se basan en construcciones específicas de Azure como roles, servicios en la nube y el Administrador de tráfico.</span><span class="sxs-lookup"><span data-stu-id="3b497-494">Typical PaaS applications in Azure rely on Azure-specific constructs such as roles, cloud services, and Traffic Manager.</span></span> <span data-ttu-id="3b497-495">Para crear una solución local para este tipo de aplicación de PaaS se requeriría una arquitectura muy distinta,</span><span class="sxs-lookup"><span data-stu-id="3b497-495">Creating an on-premises solution for this type of PaaS application would require a significantly different architecture.</span></span> <span data-ttu-id="3b497-496">algo que puede que no sea factible desde una perspectiva de costos o administración.</span><span class="sxs-lookup"><span data-stu-id="3b497-496">This might not be feasible from a management or cost perspective.</span></span>

<span data-ttu-id="3b497-497">Sin embargo, una solución híbrida para la recuperación ante desastres plantea menos desafíos para las arquitecturas tradicionales que se han migrado a la nube, como las arquitecturas basadas en IaaS.</span><span class="sxs-lookup"><span data-stu-id="3b497-497">However, a hybrid solution for disaster recovery has fewer challenges for traditional architectures that have been migrated to the cloud, such as IaaS-based architectures.</span></span> <span data-ttu-id="3b497-498">Las aplicaciones de IaaS utilizan máquinas virtuales en la nube que pueden tener equivalentes directos en el sistema local.</span><span class="sxs-lookup"><span data-stu-id="3b497-498">IaaS applications use virtual machines in the cloud that can have direct on-premises equivalents.</span></span> <span data-ttu-id="3b497-499">También puede usar redes virtuales para conectar máquinas en la nube con recursos de red locales.</span><span class="sxs-lookup"><span data-stu-id="3b497-499">You can also use virtual networks to connect machines in the cloud with on-premises network resources.</span></span> <span data-ttu-id="3b497-500">Esto ofrece varias opciones que no son posibles con las aplicaciones solo PaaS.</span><span class="sxs-lookup"><span data-stu-id="3b497-500">This allows several possibilities that are not possible with PaaS-only applications.</span></span> <span data-ttu-id="3b497-501">Por ejemplo, SQL Server puede sacar provecho de soluciones de recuperación ante desastres, como los grupos de disponibilidad AlwaysOn y la creación de reflejo de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3b497-501">For example, SQL Server can take advantage of disaster recovery solutions such as AlwaysOn Availability Groups and database mirroring.</span></span> <span data-ttu-id="3b497-502">Para más información, consulte [Alta disponibilidad y recuperación ante desastres para SQL Server en máquinas virtuales de Azure](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="3b497-502">For details, see [High availability and disaster recovery for SQL Server in Azure virtual machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

<span data-ttu-id="3b497-503">Las soluciones de IaaS también proporcionan una ruta más sencilla para que las aplicaciones locales utilicen Azure como opción de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="3b497-503">IaaS solutions also provide an easier path for on-premises applications to use Azure as the failover option.</span></span> <span data-ttu-id="3b497-504">Puede haber una aplicación totalmente funcional en una región local existente.</span><span class="sxs-lookup"><span data-stu-id="3b497-504">You might have a fully functioning application in an existing on-premises region.</span></span> <span data-ttu-id="3b497-505">Sin embargo, ¿qué ocurre si faltan los recursos necesarios para mantener una región geográficamente independiente para la conmutación por error?</span><span class="sxs-lookup"><span data-stu-id="3b497-505">However, what if you lack the resources to maintain a geographically separate region for failover?</span></span> <span data-ttu-id="3b497-506">Se pueden usar máquinas virtuales y redes virtuales para que la aplicación se ejecute en Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-506">You might decide to use virtual machines and virtual networks to get your application running in Azure.</span></span> <span data-ttu-id="3b497-507">En tal caso, defina procesos que sincronicen los datos con la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-507">In that case, define processes that synchronize data to the cloud.</span></span> <span data-ttu-id="3b497-508">En ese momento, la implementación de Azure se convierte en la región secundaria que se utilizará para la conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="3b497-508">The Azure deployment then becomes the secondary region to use for failover.</span></span> <span data-ttu-id="3b497-509">La región principal sigue siendo la aplicación local.</span><span class="sxs-lookup"><span data-stu-id="3b497-509">The primary region remains the on-premises application.</span></span> <span data-ttu-id="3b497-510">Para más información acerca de las arquitecturas de IaaS y sus funcionalidades, consulte la [documentación de las máquinas virtuales](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="3b497-510">For more information about IaaS architectures and capabilities, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="alternative-cloud"></a><span data-ttu-id="3b497-511">Nube alternativa</span><span class="sxs-lookup"><span data-stu-id="3b497-511">Alternative cloud</span></span>
<span data-ttu-id="3b497-512">Hay situaciones en las que el amplio abanico de funciones de Microsoft Azure puede no ajustarse a las directivas o normas de cumplimiento internas que requiere su organización.</span><span class="sxs-lookup"><span data-stu-id="3b497-512">There are situations where the broad capabilities of Microsoft Azure still may not meet internal compliance rules or policies required by your organization.</span></span> <span data-ttu-id="3b497-513">Incluso la mejor preparación y diseño para implementar sistemas de copia de seguridad durante un desastre son inadecuados durante una interrupción global del servicio de un proveedor de servicios en la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-513">Even the best preparation and design to implement backup systems during a disaster are inadequate during a global service disruption of a cloud service provider.</span></span>

<span data-ttu-id="3b497-514">Debería comparar los requisitos de disponibilidad con el costo y la complejidad del aumento de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="3b497-514">You should compare availability requirements with the cost and complexity of increased availability.</span></span> <span data-ttu-id="3b497-515">Realice un análisis de riesgos y defina el RTO y el RPO de la solución.</span><span class="sxs-lookup"><span data-stu-id="3b497-515">Perform a risk analysis, and define the RTO and RPO for your solution.</span></span> <span data-ttu-id="3b497-516">Si la aplicación no puede tolerar ningún tiempo de inactividad, puede considerar la posibilidad de utilizar una solución en la nube adicional.</span><span class="sxs-lookup"><span data-stu-id="3b497-516">If your application cannot tolerate any downtime, you might consider using an additional cloud solution.</span></span> <span data-ttu-id="3b497-517">A menos que todo Internet deje de funcionar simultáneamente, es posible que aún haya otra solución en la nube si no se pudiera acceder a Azure a nivel global.</span><span class="sxs-lookup"><span data-stu-id="3b497-517">Unless the entire Internet goes down, another cloud solution might still be available if Azure becomes globally inaccessible.</span></span>

<span data-ttu-id="3b497-518">Al igual que sucede en el escenario híbrido, las implementaciones de conmutación por error en las arquitecturas de recuperación ante desastres anteriores también pueden existir en otra solución en la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-518">As with the hybrid scenario, the failover deployments in the previous disaster recovery architectures can also exist within another cloud solution.</span></span> <span data-ttu-id="3b497-519">Los sitios de recuperación ante desastres en la nube alternativos solo deben utilizarse para aquellas soluciones cuyo RTO permita muy poco tiempo de inactividad, o ninguno.</span><span class="sxs-lookup"><span data-stu-id="3b497-519">Alternative cloud DR sites should be used only for solutions whose RTO allows very little, if any, downtime.</span></span> <span data-ttu-id="3b497-520">Tenga en cuenta que una solución que utilice un sitio de recuperación ante desastres fuera de Azure requerirá más trabajo de configuración, desarrollo, implementación y mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="3b497-520">Note that a solution that uses a DR site outside Azure will require more work to configure, develop, deploy, and maintain.</span></span> <span data-ttu-id="3b497-521">También es más difícil implementar los procedimientos demostrados en una arquitectura entre nubes.</span><span class="sxs-lookup"><span data-stu-id="3b497-521">It's also more difficult to implement proven practices in a cross-cloud architecture.</span></span> <span data-ttu-id="3b497-522">Aunque las plataformas en la nube tienen conceptos de alto nivel similares, las API y las arquitecturas son diferentes.</span><span class="sxs-lookup"><span data-stu-id="3b497-522">Although cloud platforms have similar high-level concepts, the APIs and architectures are different.</span></span>

<span data-ttu-id="3b497-523">Si su estrategia de recuperación ante desastres se basa en varias plataformas en la nube, es útil incluir capas de abstracción en el diseño de la solución.</span><span class="sxs-lookup"><span data-stu-id="3b497-523">If your DR strategy relies upon multiple cloud platforms, it's valuable to include abstraction layers in the design of the solution.</span></span> <span data-ttu-id="3b497-524">Si lo hace, no será preciso que desarrolle y mantenga dos versiones diferentes de la misma aplicación para plataformas en la nube distintas en caso de desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-524">This eliminates the need to develop and maintain two different versions of the same application for different cloud platforms in case of disaster.</span></span> <span data-ttu-id="3b497-525">Como sucede en el escenario híbrido, el uso de Azure Virtual Machines o el servicio Contenedor de Azure puede ser más sencillo en estos casos que el empleo de diseños de PaaS específicos de la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-525">As with the hybrid scenario, the use of Azure Virtual Machines or Azure Container Service might be easier in these cases than the use of cloud-specific PaaS designs.</span></span>

## <a name="automation"></a><span data-ttu-id="3b497-526">Automation</span><span class="sxs-lookup"><span data-stu-id="3b497-526">Automation</span></span>
<span data-ttu-id="3b497-527">Algunos de los patrones que acabamos de describir requieren una activación rápida de las implementaciones sin conexión, así como la restauración de determinadas partes de un sistema.</span><span class="sxs-lookup"><span data-stu-id="3b497-527">Some of the patterns that we just discussed require quick activation of offline deployments as well as restoration of specific parts of a system.</span></span> <span data-ttu-id="3b497-528">Los scripts de automatización pueden activar recursos a petición e implementar soluciones rápidamente.</span><span class="sxs-lookup"><span data-stu-id="3b497-528">Automation scripts can activate resources on demand and deploy solutions rapidly.</span></span> <span data-ttu-id="3b497-529">En los siguientes ejemplos de automatización relacionados con la recuperación ante desastres se usa [Azure PowerShell](https://msdn.microsoft.com/library/azure/jj156055.aspx), pero también es una buena opción usar la [CLI de Azure](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli) o la [API de REST de administración del servicio](https://msdn.microsoft.com/library/azure/ee460799.aspx).</span><span class="sxs-lookup"><span data-stu-id="3b497-529">The DR-related automation examples below use [Azure PowerShell](https://msdn.microsoft.com/library/azure/jj156055.aspx), but using the [Azure CLI](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli) or the [Service Management REST API](https://msdn.microsoft.com/library/azure/ee460799.aspx) are also good options.</span></span>

<span data-ttu-id="3b497-530">Los scripts de automatización administran aspectos de recuperación ante desastres que Azure no controla de manera transparente.</span><span class="sxs-lookup"><span data-stu-id="3b497-530">Automation scripts manage aspects of DR not transparently handled by Azure.</span></span> <span data-ttu-id="3b497-531">Esto produce resultados coherentes y repetibles, lo que reduce al mínimo los errores humanos.</span><span class="sxs-lookup"><span data-stu-id="3b497-531">This produces consistent and repeatable results, minimizing human error.</span></span> <span data-ttu-id="3b497-532">Los scripts predefinidos de recuperación ante desastres también reducen el tiempo necesario para recompilar un sistema y las partes que lo constituyen durante un desastre.</span><span class="sxs-lookup"><span data-stu-id="3b497-532">Predefined DR scripts also reduce the time to rebuild a system and its constituent parts during a disaster.</span></span> <span data-ttu-id="3b497-533">No es buena idea intentar averiguar manualmente cómo restaurar su sitio mientras está inactivo y perder dinero a cada minuto.</span><span class="sxs-lookup"><span data-stu-id="3b497-533">You don’t want to try to manually figure out how to restore your site while it's down and losing money every minute.</span></span>

<span data-ttu-id="3b497-534">Pruebe los scripts varias veces de principio a fin.</span><span class="sxs-lookup"><span data-stu-id="3b497-534">Test your scripts repeatedly from start to finish.</span></span> <span data-ttu-id="3b497-535">Después de comprobar su funcionalidad básica, asegúrese de probarlos en una [simulación de desastre](#disaster-simulation).</span><span class="sxs-lookup"><span data-stu-id="3b497-535">After verifying their basic functionality, make sure to test them in [disaster simulation](#disaster-simulation).</span></span> <span data-ttu-id="3b497-536">Esto ayuda a detectar defectos en los scripts o procesos.</span><span class="sxs-lookup"><span data-stu-id="3b497-536">This helps uncover defects in the scripts or processes.</span></span>

<span data-ttu-id="3b497-537">Un procedimiento recomendado con automatización es crear un repositorio de scripts de PowerShell o de interfaz de la línea de comandos (CLI) para recuperación ante desastres de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-537">A best practice with automation is to create a repository of PowerShell scripts or command-line interface (CLI) scripts for Azure disaster recovery.</span></span> <span data-ttu-id="3b497-538">Márquelos y clasifíquelos claramente para encontrarlos rápidamente.</span><span class="sxs-lookup"><span data-stu-id="3b497-538">Clearly mark and categorize them for quick access.</span></span> <span data-ttu-id="3b497-539">Designe una persona principal para que se encargue de administrar el repositorio y el control de versiones de los scripts.</span><span class="sxs-lookup"><span data-stu-id="3b497-539">Designate a primary person to manage the repository and versioning of the scripts.</span></span> <span data-ttu-id="3b497-540">Documéntelos perfectamente con explicaciones de los parámetros y ejemplos de uso de los scripts.</span><span class="sxs-lookup"><span data-stu-id="3b497-540">Document them well with explanations of parameters and examples of script use.</span></span> <span data-ttu-id="3b497-541">Asegúrese de que esta documentación está sincronizada con las implementaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="3b497-541">Also ensure that you keep this documentation in sync with your Azure deployments.</span></span> <span data-ttu-id="3b497-542">Esto subraya la importancia de que haya una persona principal responsable de todas las partes del repositorio.</span><span class="sxs-lookup"><span data-stu-id="3b497-542">This underscores the purpose of having a primary person in charge of all parts of the repository.</span></span>

## <a name="failure-detection"></a><span data-ttu-id="3b497-543">detección de errores</span><span class="sxs-lookup"><span data-stu-id="3b497-543">Failure detection</span></span>
<span data-ttu-id="3b497-544">Para controlar correctamente los problemas de disponibilidad y recuperación ante desastres, es preciso ser capaz de detectar y diagnosticar los errores.</span><span class="sxs-lookup"><span data-stu-id="3b497-544">To correctly handle problems with availability and disaster recovery, you must be able to detect and diagnose failures.</span></span> <span data-ttu-id="3b497-545">Realice una supervisión avanzada del servidor y la implementación para identificar rápidamente el momento en que un sistema o sus componentes dejan de estar disponibles repentinamente.</span><span class="sxs-lookup"><span data-stu-id="3b497-545">Perform advanced server and deployment monitoring to quickly recognize when a system or its components suddenly become unavailable.</span></span> <span data-ttu-id="3b497-546">Una parte de este trabajo pueden realizarla las herramientas de supervisión que evalúan el estado general del servicio en la nube y sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="3b497-546">Monitoring tools that assess the overall health of the cloud service and its dependencies can perform part of this work.</span></span> <span data-ttu-id="3b497-547">Una herramienta de Microsoft adecuada es [System Center 2016](https://www.microsoft.com/cloud-platform/system-center).</span><span class="sxs-lookup"><span data-stu-id="3b497-547">One suitable Microsoft tool is [System Center 2016](https://www.microsoft.com/cloud-platform/system-center).</span></span> <span data-ttu-id="3b497-548">Hay herramientas de terceros que también pueden proporcionar funcionalidades de supervisión.</span><span class="sxs-lookup"><span data-stu-id="3b497-548">Third-party tools can also provide monitoring capabilities.</span></span> <span data-ttu-id="3b497-549">La mayoría de las soluciones de supervisión principales hacen un seguimiento de los contadores de rendimiento clave y de la disponibilidad del servicio.</span><span class="sxs-lookup"><span data-stu-id="3b497-549">Most monitoring solutions track key performance counters and service availability.</span></span>

<span data-ttu-id="3b497-550">Aunque estas herramientas son vitales, debe planear la detección de errores y la generación de informes en un servicio en la nube.</span><span class="sxs-lookup"><span data-stu-id="3b497-550">Although these tools are vital, you must plan for fault detection and reporting within a cloud service.</span></span> <span data-ttu-id="3b497-551">Asimismo, debe planear el uso correcto de Azure Diagnostics.</span><span class="sxs-lookup"><span data-stu-id="3b497-551">You must also plan to properly use Azure Diagnostics.</span></span> <span data-ttu-id="3b497-552">Los contadores de rendimiento personalizados o las entradas del registro de eventos también pueden formar parte de la estrategia global.</span><span class="sxs-lookup"><span data-stu-id="3b497-552">Custom performance counters or event-log entries can also be part of the overall strategy.</span></span> <span data-ttu-id="3b497-553">Todo esto proporciona más datos durante los errores y, en consecuencia, agiliza el diagnóstico del problema y la restauración de todas las capacidades.</span><span class="sxs-lookup"><span data-stu-id="3b497-553">This provides more data during failures to quickly diagnose the problem and restore full capabilities.</span></span> <span data-ttu-id="3b497-554">También proporciona métricas adicionales que las herramientas de supervisión pueden usar determinar el estado de cualquier aplicación.</span><span class="sxs-lookup"><span data-stu-id="3b497-554">It also provides additional metrics that the monitoring tools can use to determine application health.</span></span> <span data-ttu-id="3b497-555">Para más información, consulte [Habilitación de diagnósticos de Azure en Azure Cloud Services](/azure/cloud-services/cloud-services-dotnet-diagnostics/).</span><span class="sxs-lookup"><span data-stu-id="3b497-555">For more information, see [Enabling Azure Diagnostics in Azure Cloud Services](/azure/cloud-services/cloud-services-dotnet-diagnostics/).</span></span> <span data-ttu-id="3b497-556">Para una explicación de cómo planear un "modelo de estado" global, consulte [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe)(Failsafe: Guía para las arquitecturas resistentes en la nube).</span><span class="sxs-lookup"><span data-stu-id="3b497-556">For a discussion of how to plan for an overall “health model,” see [Failsafe: Guidance for Resilient Cloud Architectures](https://channel9.msdn.com/Series/FailSafe).</span></span>

## <a name="disaster-simulation"></a><span data-ttu-id="3b497-557">simulación de desastre</span><span class="sxs-lookup"><span data-stu-id="3b497-557">Disaster simulation</span></span>
<span data-ttu-id="3b497-558">Las pruebas de simulación implican la creación de situaciones reales a pequeña escala en el lugar de trabajo real para observar cómo reaccionan los miembros del equipo.</span><span class="sxs-lookup"><span data-stu-id="3b497-558">Simulation testing involves creating small real-life situations on the work floor to observe how the team members react.</span></span> <span data-ttu-id="3b497-559">Las simulaciones también muestran la eficacia de la descripción de las soluciones del plan de recuperación.</span><span class="sxs-lookup"><span data-stu-id="3b497-559">Simulations also show how effective the solutions are in the recovery plan.</span></span> <span data-ttu-id="3b497-560">Ejecute simulaciones de forma que los escenarios creados no interrumpan la actividad empresarial real, pero puedan considerarse situaciones reales.</span><span class="sxs-lookup"><span data-stu-id="3b497-560">Execute simulations so that the created scenarios don't disrupt actual business, while still feeling like real situations.</span></span>

<span data-ttu-id="3b497-561">Considere la posibilidad de incluir algún tipo de "panel de control" en la aplicación para simular manualmente problemas de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="3b497-561">Consider architecting a type of “switchboard” in the application to manually simulate availability issues.</span></span> <span data-ttu-id="3b497-562">Por ejemplo, a través de una conmutación suave, desencadene excepciones de acceso a la base de datos en un módulo de pedidos, que hacen que no funcione correctamente.</span><span class="sxs-lookup"><span data-stu-id="3b497-562">For instance, through a soft switch, trigger database access exceptions for an ordering module by causing it to malfunction.</span></span> <span data-ttu-id="3b497-563">Se pueden adoptar otros enfoques ligeros similares para otros módulos en el nivel de interfaz de red.</span><span class="sxs-lookup"><span data-stu-id="3b497-563">You can take similar lightweight approaches for other modules at the network interface level.</span></span>

<span data-ttu-id="3b497-564">La simulación resalta todos los problemas que no se hayan abordado correctamente.</span><span class="sxs-lookup"><span data-stu-id="3b497-564">The simulation highlights any issues that were inadequately addressed.</span></span> <span data-ttu-id="3b497-565">Los escenarios simulados deben ser completamente controlables,</span><span class="sxs-lookup"><span data-stu-id="3b497-565">The simulated scenarios must be completely controllable.</span></span> <span data-ttu-id="3b497-566">lo que significa que, aunque parezca que el plan de recuperación no funciona, debe ser posible devolver la situación a un estado normal sin provocar daños importantes.</span><span class="sxs-lookup"><span data-stu-id="3b497-566">This means that, even if the recovery plan seems to be failing, you can restore the situation back to normal without causing any significant damage.</span></span> <span data-ttu-id="3b497-567">También es importante que informar a la dirección de alto nivel de cómo y cuándo se van a realizar los ejercicios de simulación.</span><span class="sxs-lookup"><span data-stu-id="3b497-567">It’s also important that you inform higher-level management about when and how the simulation exercises will be executed.</span></span> <span data-ttu-id="3b497-568">Este plan debe detallar el tiempo o los recursos afectados durante la simulación.</span><span class="sxs-lookup"><span data-stu-id="3b497-568">This plan should detail the time or resources affected during the simulation.</span></span> <span data-ttu-id="3b497-569">Defina también cómo medir el éxito de las pruebas del plan de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-569">Also define the measures of success when testing your disaster recovery plan.</span></span>

<span data-ttu-id="3b497-570">Si utiliza Azure Site Recovery, puede ejecutar una conmutación por error de prueba en Azure para comprobar la estrategia de replicación o realizar un simulacro de recuperación ante desastres sin que se pierda ningún dato y sin tiempos de inactividad.</span><span class="sxs-lookup"><span data-stu-id="3b497-570">If you are using Azure Site Recovery, you can execute a test failover to Azure, to validate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span></span> <span data-ttu-id="3b497-571">La conmutación por error de prueba no afecta a la replicación de la máquina virtual en curso ni al entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="3b497-571">A test failover does not affect on the ongoing VM replication or your production environment.</span></span>

<span data-ttu-id="3b497-572">Existen varias técnicas más para probar planes de recuperación ante desastres.</span><span class="sxs-lookup"><span data-stu-id="3b497-572">Several other techniques can test disaster recovery plans.</span></span> <span data-ttu-id="3b497-573">Sin embargo, la mayor parte de ellas son simples variaciones de estas técnicas básicas.</span><span class="sxs-lookup"><span data-stu-id="3b497-573">However, most of them are simply variations of these basic techniques.</span></span> <span data-ttu-id="3b497-574">El propósito de esta prueba es evaluar la viabilidad del plan de recuperación.</span><span class="sxs-lookup"><span data-stu-id="3b497-574">The intent of this testing is to evaluate the feasibility of the recovery plan.</span></span> <span data-ttu-id="3b497-575">Las pruebas de recuperación ante desastres se centran en los detalles para detectar lapsos en el plan de recuperación básico.</span><span class="sxs-lookup"><span data-stu-id="3b497-575">Disaster recovery testing focuses on the details to discover gaps in the basic recovery plan.</span></span>

## <a name="service-specific-guidance"></a><span data-ttu-id="3b497-576">Guía específica del servicio</span><span class="sxs-lookup"><span data-stu-id="3b497-576">Service-specific guidance</span></span>

<span data-ttu-id="3b497-577">Los temas siguientes describen los servicios de Azure específicos de recuperación ante desastres:</span><span class="sxs-lookup"><span data-stu-id="3b497-577">The following topics describe disaster recovery specific Azure services:</span></span>

| <span data-ttu-id="3b497-578">Servicio</span><span class="sxs-lookup"><span data-stu-id="3b497-578">Service</span></span> | <span data-ttu-id="3b497-579">Tema</span><span class="sxs-lookup"><span data-stu-id="3b497-579">Topic</span></span> |
|---------|-------|
| <span data-ttu-id="3b497-580">Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="3b497-580">Azure Database for MySQL</span></span> | [<span data-ttu-id="3b497-581">Introducción a la continuidad empresarial con Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="3b497-581">Overview of business continuity with Azure Database for MySQL</span></span>](/azure/mysql/concepts-business-continuity) |
| <span data-ttu-id="3b497-582">Azure Database for PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="3b497-582">Azure Database for PostgreSQL</span></span> | [<span data-ttu-id="3b497-583">Introducción a la continuidad empresarial con Azure Database for PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="3b497-583">Overview of business continuity with Azure Database for PostgreSQL</span></span>](/azure/postgresql/concepts-business-continuity)
| <span data-ttu-id="3b497-584">Cloud Services</span><span class="sxs-lookup"><span data-stu-id="3b497-584">Cloud Services</span></span> | [<span data-ttu-id="3b497-585">Qué hacer en caso de una interrupción del servicio de Azure que afecte a Azure Cloud Services</span><span class="sxs-lookup"><span data-stu-id="3b497-585">What to do in the event of an Azure service disruption that impacts Azure Cloud Services</span></span>](/azure/cloud-services/cloud-services-disaster-recovery-guidance) |
| <span data-ttu-id="3b497-586">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="3b497-586">Cosmos DB</span></span> | [<span data-ttu-id="3b497-587">Conmutación por error regional automática para la continuidad empresarial en Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="3b497-587">Automatic regional failover for business continuity in Azure Cosmos DB</span></span>](/azure/cosmos-db/regional-failover)
| <span data-ttu-id="3b497-588">Key Vault</span><span class="sxs-lookup"><span data-stu-id="3b497-588">Key Vault</span></span> | [<span data-ttu-id="3b497-589">Redundancia y disponibilidad de Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="3b497-589">Azure Key Vault availability and redundancy</span></span>](/azure/key-vault/key-vault-disaster-recovery-guidance) |
|<span data-ttu-id="3b497-590">Storage</span><span class="sxs-lookup"><span data-stu-id="3b497-590">Storage</span></span> | [<span data-ttu-id="3b497-591">Qué hacer si se produce una interrupción del servicio Azure Storage</span><span class="sxs-lookup"><span data-stu-id="3b497-591">What to do if an Azure Storage outage occurs</span></span>](/azure/storage/storage-disaster-recovery-guidance) |
| <span data-ttu-id="3b497-592">SQL Database</span><span class="sxs-lookup"><span data-stu-id="3b497-592">SQL Database</span></span> | [<span data-ttu-id="3b497-593">Restauración de Azure SQL Database o una conmutación por error en una secundaria</span><span class="sxs-lookup"><span data-stu-id="3b497-593">Restore an Azure SQL Database or failover to a secondary</span></span>](/azure/sql-database/sql-database-disaster-recovery) |
| <span data-ttu-id="3b497-594">Máquinas virtuales</span><span class="sxs-lookup"><span data-stu-id="3b497-594">Virtual machines</span></span> | [<span data-ttu-id="3b497-595">Qué hacer si se produce una interrupción del servicio de Azure que afecta a las máquinas virtuales de Azure</span><span class="sxs-lookup"><span data-stu-id="3b497-595">What to do in the event that an Azure service disruption impacts Azure virtual machines</span></span>](/azure/virtual-machines/virtual-machines-disaster-recovery-guidance) |
| <span data-ttu-id="3b497-596">Redes virtuales</span><span class="sxs-lookup"><span data-stu-id="3b497-596">Virtual networks</span></span> | [<span data-ttu-id="3b497-597">Virtual Network: continuidad del negocio</span><span class="sxs-lookup"><span data-stu-id="3b497-597">Virtual Network – Business Continuity</span></span>](/azure/virtual-network/virtual-network-disaster-recovery-guidance) |

