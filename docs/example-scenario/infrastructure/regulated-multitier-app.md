---
title: Compilación de aplicaciones web seguras con máquinas virtuales Windows
titleSuffix: Azure Example Scenarios
description: Compile una aplicación web segura, de varios niveles, con Windows Server en Azure que use conjuntos de escalado, Application Gateway y equilibradores de carga.
author: iainfoulds
ms.date: 12/06/2018
ms.custom: seodec18
ms.openlocfilehash: 2c5f77f265c10388f42138e7d3f6da9e3ead1cd8
ms.sourcegitcommit: bb7fcffbb41e2c26a26f8781df32825eb60df70c
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/20/2018
ms.locfileid: "53643540"
---
# <a name="building-secure-web-applications-with-windows-virtual-machines-on-azure"></a><span data-ttu-id="46f38-103">Compilación de aplicaciones web seguras con máquinas virtuales Windows en Azure</span><span class="sxs-lookup"><span data-stu-id="46f38-103">Building secure web applications with Windows virtual machines on Azure</span></span>

<span data-ttu-id="46f38-104">Este escenario proporciona una guía de arquitectura y diseño para ejecutar aplicaciones web seguras y de niveles múltiples en Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="46f38-104">This scenario provides architecture and design guidance for running secure, multi-tier web applications on Microsoft Azure.</span></span> <span data-ttu-id="46f38-105">En este ejemplo, una aplicación de ASP.NET se conecta de forma segura a un clúster back-end protegido de Microsoft SQL Server mediante máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="46f38-105">In this example, an ASP.NET application securely connects to a protected back-end Microsoft SQL Server cluster using virtual machines.</span></span>

<span data-ttu-id="46f38-106">Tradicionalmente, las organizaciones usaban aplicaciones y servicios locales heredados para proporcionar una infraestructura segura.</span><span class="sxs-lookup"><span data-stu-id="46f38-106">Traditionally, organizations had to maintain legacy on-premises applications and services to provide a secure infrastructure.</span></span> <span data-ttu-id="46f38-107">Al implementar estas aplicaciones de Windows Server de forma segura en Azure, las organizaciones pueden modernizar sus implementaciones y reducir los costos operativos locales y la sobrecarga de administración.</span><span class="sxs-lookup"><span data-stu-id="46f38-107">By deploying these Windows Server applications securely in Azure, organizations can modernize their deployments and reduce their on-premises operating costs and management overhead.</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="46f38-108">Casos de uso pertinentes</span><span class="sxs-lookup"><span data-stu-id="46f38-108">Relevant use cases</span></span>

<span data-ttu-id="46f38-109">Algunos ejemplos de dónde se puede aplicar este escenario:</span><span class="sxs-lookup"><span data-stu-id="46f38-109">A few examples of where this scenario may apply:</span></span>

- <span data-ttu-id="46f38-110">Modernización de implementaciones de aplicaciones en un entorno seguro en la nube.</span><span class="sxs-lookup"><span data-stu-id="46f38-110">Modernizing application deployments in a secure cloud environment.</span></span>
- <span data-ttu-id="46f38-111">Reducción de la sobrecarga de administración de las aplicaciones y servicios locales heredados.</span><span class="sxs-lookup"><span data-stu-id="46f38-111">Reducing the management overhead of legacy on-premises applications and services.</span></span>
- <span data-ttu-id="46f38-112">Mejora de la asistencia sanitaria al paciente y experimentación con nuevas plataformas de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="46f38-112">Improving patient healthcare and experience with new application platforms.</span></span>

## <a name="architecture"></a><span data-ttu-id="46f38-113">Arquitectura</span><span class="sxs-lookup"><span data-stu-id="46f38-113">Architecture</span></span>

![Introducción a la arquitectura de los componentes de Azure implicados en aplicaciones de Windows Server de varios niveles para sectores regulados][architecture]

<span data-ttu-id="46f38-115">Este escenario muestra una aplicación web front-end conectada a una base de datos back-end, y ambas se ejecutan en Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="46f38-115">This scenario shows a front-end web application connecting to a back-end database, both running on Windows Server 2016.</span></span> <span data-ttu-id="46f38-116">Los datos fluyen por el escenario de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="46f38-116">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="46f38-117">Los usuarios acceden a la aplicación front-end de ASP.NET mediante una instancia de Azure Application Gateway.</span><span class="sxs-lookup"><span data-stu-id="46f38-117">Users access the front-end ASP.NET application through an Azure Application Gateway.</span></span>
2. <span data-ttu-id="46f38-118">Application Gateway distribuye el tráfico a las instancias de máquinas virtuales de un conjunto de escalado de máquinas virtuales de Azure.</span><span class="sxs-lookup"><span data-stu-id="46f38-118">The Application Gateway distributes traffic to VM instances within an Azure virtual machine scale set.</span></span>
3. <span data-ttu-id="46f38-119">La aplicación se conecta al clúster de Microsoft SQL Server en un nivel de back-end mediante un equilibrador de carga de Azure.</span><span class="sxs-lookup"><span data-stu-id="46f38-119">The application connects to Microsoft SQL Server cluster in a back-end tier via an Azure load balancer.</span></span> <span data-ttu-id="46f38-120">Estas instancias de back-end de SQL Server están en una red virtual de Azure independiente, protegidas mediante reglas de grupo de seguridad de red que limitan el flujo de tráfico.</span><span class="sxs-lookup"><span data-stu-id="46f38-120">These back-end SQL Server instances are in a separate Azure virtual network, secured by network security group rules that limit traffic flow.</span></span>
4. <span data-ttu-id="46f38-121">El equilibrador de carga distribuye el tráfico de SQL Server en instancias de máquinas virtuales de otro conjunto de escalado de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="46f38-121">The load balancer distributes SQL Server traffic to VM instances in another virtual machine scale set.</span></span>
5. <span data-ttu-id="46f38-122">Azure Blob Storage actúa como un [testigo en la nube][cloud-witness] para el clúster de SQL Server en el nivel de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-122">Azure Blob Storage acts as a [cloud witness][cloud-witness] for the SQL Server cluster in the back-end tier.</span></span> <span data-ttu-id="46f38-123">La conexión desde dentro de la red virtual se habilita con un punto de conexión de servicio de red virtual para Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="46f38-123">The connection from within the VNet is enabled with a VNet Service Endpoint for Azure Storage.</span></span>

### <a name="components"></a><span data-ttu-id="46f38-124">Componentes</span><span class="sxs-lookup"><span data-stu-id="46f38-124">Components</span></span>

- <span data-ttu-id="46f38-125">[Azure Application Gateway][appgateway-docs] es un equilibrador de carga de tráfico web de capa 7 que es compatible con aplicaciones y puede distribuir el tráfico según reglas de enrutamiento específicas.</span><span class="sxs-lookup"><span data-stu-id="46f38-125">[Azure Application Gateway][appgateway-docs] is a layer 7 web traffic load balancer that is application-aware and can distribute traffic based on specific routing rules.</span></span> <span data-ttu-id="46f38-126">App Gateway puede también controlar la descarga de SSL para obtener un rendimiento de servidor web mejorado.</span><span class="sxs-lookup"><span data-stu-id="46f38-126">App Gateway can also handle SSL offloading for improved web server performance.</span></span>
- <span data-ttu-id="46f38-127">[Azure Virtual Network][vnet-docs] permite que varios recursos como, por ejemplo, máquinas virtuales, se puedan comunicar de forma segura entre ellos, con Internet y con redes locales.</span><span class="sxs-lookup"><span data-stu-id="46f38-127">[Azure Virtual Network][vnet-docs] allows resources such as VMs to securely communicate with each other, the Internet, and on-premises networks.</span></span> <span data-ttu-id="46f38-128">Las redes virtuales proporcionan aislamiento y segmentación, filtrado y enrutamiento de tráfico, y permiten la conexión entre ubicaciones.</span><span class="sxs-lookup"><span data-stu-id="46f38-128">Virtual networks provide isolation and segmentation, filter and route traffic, and allow connection between locations.</span></span> <span data-ttu-id="46f38-129">Se usan dos redes virtuales combinadas con los grupos de seguridad de red adecuados en este escenario para proporcionar una [red perimetral][dmz] (DMZ) y aislamiento para los componentes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="46f38-129">Two virtual networks combined with the appropriate NSGs are used in this scenario to provide a [demilitarized zone][dmz] (DMZ) and isolation of the application components.</span></span> <span data-ttu-id="46f38-130">El emparejamiento de redes virtuales conecta las dos redes entre sí.</span><span class="sxs-lookup"><span data-stu-id="46f38-130">Virtual network peering connects the two networks together.</span></span>
- <span data-ttu-id="46f38-131">El [conjunto de escalado de máquinas virtuales de Azure][scaleset-docs] permite crear y administrar un grupo de máquinas virtuales idénticas con equilibrio de carga.</span><span class="sxs-lookup"><span data-stu-id="46f38-131">[Azure virtual machine scale set][scaleset-docs] lets you create and manager a group of identical, load balanced, VMs.</span></span> <span data-ttu-id="46f38-132">El número de instancias de máquina virtual puede aumentar o disminuir automáticamente según la demanda, o de acuerdo a una programación definida.</span><span class="sxs-lookup"><span data-stu-id="46f38-132">The number of VM instances can automatically increase or decrease in response to demand or a defined schedule.</span></span> <span data-ttu-id="46f38-133">Se usan dos conjuntos de escalado de máquinas virtuales en este escenario, uno para las instancias de la aplicación de ASP.NET de front-end y otro para las instancias de máquinas virtuales de clústeres de SQL Server de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-133">Two separate virtual machine scale sets are used in this scenario - one for the front-end ASP.NET application instances, and one for the back-end SQL Server cluster VM instances.</span></span> <span data-ttu-id="46f38-134">Se puede usar Desired State Configuration (DSC) de PowerShell o la extensión de script personalizada de Azure para aprovisionar las instancias de máquinas virtuales con el software y los valores de configuración requeridos.</span><span class="sxs-lookup"><span data-stu-id="46f38-134">PowerShell desired state configuration (DSC) or the Azure custom script extension can be used to provision the VM instances with the required software and configuration settings.</span></span>
- <span data-ttu-id="46f38-135">Los [grupos de seguridad de red de Azure][nsg-docs] contienen una lista de reglas de seguridad que permiten o deniegan el tráfico entrante o saliente en función de las direcciones IP de origen o destino, el puerto y el protocolo.</span><span class="sxs-lookup"><span data-stu-id="46f38-135">[Azure network security groups][nsg-docs] contain a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol.</span></span> <span data-ttu-id="46f38-136">Las redes virtuales de este escenario se protegen con reglas de grupo de seguridad de red que restringen el flujo de tráfico entre los componentes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="46f38-136">The virtual networks in this scenario are secured with network security group rules that restrict the flow of traffic between the application components.</span></span>
- <span data-ttu-id="46f38-137">[Azure Load Balancer][loadbalancer-docs] distribuye el tráfico entrante según reglas y sondeos de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="46f38-137">[Azure load balancer][loadbalancer-docs] distributes inbound traffic according to rules and health probes.</span></span> <span data-ttu-id="46f38-138">Una instancia de Load Balancer proporciona baja latencia y alto rendimiento, y puede escalar hasta millones de flujos para todas las aplicaciones TCP y UDP.</span><span class="sxs-lookup"><span data-stu-id="46f38-138">A load balancer provides low latency and high throughput, and scales up to millions of flows for all TCP and UDP applications.</span></span> <span data-ttu-id="46f38-139">Se usa un equilibrador de carga interno en este escenario para distribuir el tráfico desde la capa de aplicación front-end al clúster de SQL Server de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-139">An internal load balancer is used in this scenario to distribute traffic from the front-end application tier to the back-end SQL Server cluster.</span></span>
- <span data-ttu-id="46f38-140">[Azure Blob Storage][cloudwitness-docs] actúa como una ubicación de testigo en la nube para el clúster de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="46f38-140">[Azure Blob Storage][cloudwitness-docs] acts a Cloud Witness location for the SQL Server cluster.</span></span> <span data-ttu-id="46f38-141">Este testigo se usa para las operaciones del clúster y las decisiones que requieren un voto adicional para decidir el cuórum.</span><span class="sxs-lookup"><span data-stu-id="46f38-141">This witness is used for cluster operations and decisions that require an additional vote to decide quorum.</span></span> <span data-ttu-id="46f38-142">El uso de un testigo en la nube elimina la necesidad de una máquina virtual adicional para que actúe como un testigo de recurso compartido de archivos tradicional.</span><span class="sxs-lookup"><span data-stu-id="46f38-142">Using Cloud Witness removes the need for an additional VM to act as a traditional File Share Witness.</span></span>

### <a name="alternatives"></a><span data-ttu-id="46f38-143">Alternativas</span><span class="sxs-lookup"><span data-stu-id="46f38-143">Alternatives</span></span>

- <span data-ttu-id="46f38-144">Linux y Windows pueden utilizarse de forma intercambiable, ya que la infraestructura no depende del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="46f38-144">Linux and Windows can be used interchangeably since the infrastructure isn't dependent on the operating system.</span></span>

- <span data-ttu-id="46f38-145">[SQL Server para Linux][sql-linux] puede reemplazar el almacén de datos de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-145">[SQL Server for Linux][sql-linux] can replace the back-end data store.</span></span>

- <span data-ttu-id="46f38-146">[Cosmos DB](/azure/cosmos-db/introduction) es otra alternativa para el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="46f38-146">[Cosmos DB](/azure/cosmos-db/introduction) is another alternative for the data store.</span></span>

## <a name="considerations"></a><span data-ttu-id="46f38-147">Consideraciones</span><span class="sxs-lookup"><span data-stu-id="46f38-147">Considerations</span></span>

### <a name="availability"></a><span data-ttu-id="46f38-148">Disponibilidad</span><span class="sxs-lookup"><span data-stu-id="46f38-148">Availability</span></span>

<span data-ttu-id="46f38-149">En este escenario las instancias de máquinas virtuales se implementan en [Availability Zones](/azure/availability-zones/az-overview).</span><span class="sxs-lookup"><span data-stu-id="46f38-149">The VM instances in this scenario are deployed across [Availability Zones](/azure/availability-zones/az-overview).</span></span> <span data-ttu-id="46f38-150">Cada zona de disponibilidad consta de uno o varios centros de datos equipados con alimentación, refrigeración y redes independientes.</span><span class="sxs-lookup"><span data-stu-id="46f38-150">Each zone is made up of one or more datacenters equipped with independent power, cooling, and networking.</span></span> <span data-ttu-id="46f38-151">Cada región habilitada tiene un mínimo de tres zonas de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="46f38-151">Each enabled region has a minimum of three availability zones.</span></span> <span data-ttu-id="46f38-152">Esta distribución de instancias de máquinas virtuales en varias zonas proporciona alta disponibilidad para las capas de aplicación.</span><span class="sxs-lookup"><span data-stu-id="46f38-152">This distribution of VM instances across zones provides high availability to the application tiers.</span></span>

<span data-ttu-id="46f38-153">El nivel de base de datos se puede configurar para usar grupos de disponibilidad Always On.</span><span class="sxs-lookup"><span data-stu-id="46f38-153">The database tier can be configured to use Always On availability groups.</span></span> <span data-ttu-id="46f38-154">Con esta configuración de SQL Server, se configura una base de datos principal dentro de un clúster con un máximo de ocho bases de datos secundarias.</span><span class="sxs-lookup"><span data-stu-id="46f38-154">With this SQL Server configuration, one primary database within a cluster is configured with up to eight secondary databases.</span></span> <span data-ttu-id="46f38-155">Si se produce un problema con la base de datos principal, el clúster conmuta por error a una de las bases de datos secundarias, lo cual permite que la aplicación siga estando disponible.</span><span class="sxs-lookup"><span data-stu-id="46f38-155">If an issue occurs with the primary database, the cluster fails over to one of the secondary databases, which allows the application to continue to be available.</span></span> <span data-ttu-id="46f38-156">Para más información, consulte [Información general de los grupos de disponibilidad AlwaysOn (SQL Server)][sqlalwayson-docs].</span><span class="sxs-lookup"><span data-stu-id="46f38-156">For more information, see [Overview of Always On availability groups for SQL Server][sqlalwayson-docs].</span></span>

<span data-ttu-id="46f38-157">Para ver más guías sobre disponibilidad, consulte la [lista de comprobación de disponibilidad][availability] que encontrará en Centro de arquitectura de Azure.</span><span class="sxs-lookup"><span data-stu-id="46f38-157">For more availability guidance, see the [availability checklist][availability] in the Azure Architecture Center.</span></span>

### <a name="scalability"></a><span data-ttu-id="46f38-158">Escalabilidad</span><span class="sxs-lookup"><span data-stu-id="46f38-158">Scalability</span></span>

<span data-ttu-id="46f38-159">Este escenario utiliza conjuntos de escalado de máquinas virtuales para los componentes de front-end y de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-159">This scenario uses virtual machine scale sets for the front-end and back-end components.</span></span> <span data-ttu-id="46f38-160">Con los conjuntos de escalado, el número de instancias de máquina virtual que se ejecutan en la capa de aplicación de front-end se puede escalar de forma automática en respuesta a la demanda del cliente, o según una programación definida.</span><span class="sxs-lookup"><span data-stu-id="46f38-160">With scale sets, the number of VM instances that run the front-end application tier can automatically scale in response to customer demand, or based on a defined schedule.</span></span> <span data-ttu-id="46f38-161">Para más información, consulte [Introducción al escalado automático con conjuntos de escalado de máquinas virtuales][vmssautoscale-docs].</span><span class="sxs-lookup"><span data-stu-id="46f38-161">For more information, see [Overview of autoscale with virtual machine scale sets][vmssautoscale-docs].</span></span>

<span data-ttu-id="46f38-162">Para ver otros temas de escalabilidad, consulte la [lista de comprobación de escalabilidad][scalability] que encontrará en el centro de arquitectura de Azure.</span><span class="sxs-lookup"><span data-stu-id="46f38-162">For other scalability topics, see the [scalability checklist][scalability] in the Azure Architecture Center.</span></span>

### <a name="security"></a><span data-ttu-id="46f38-163">Seguridad</span><span class="sxs-lookup"><span data-stu-id="46f38-163">Security</span></span>

<span data-ttu-id="46f38-164">Los grupos de seguridad de red protegen todo el tráfico de la red virtual hacia la capa de aplicación de front-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-164">All the virtual network traffic into the front-end application tier and protected by network security groups.</span></span> <span data-ttu-id="46f38-165">Las reglas limitan el flujo de tráfico de forma que solo las instancias de máquinas virtuales de la capa de aplicación de front-end pueden acceder al nivel de la base de datos de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-165">Rules limit the flow of traffic so that only the front-end application tier VM instances can access the back-end database tier.</span></span> <span data-ttu-id="46f38-166">No se permite ningún tráfico de Internet saliente procedente del nivel de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="46f38-166">No outbound Internet traffic is allowed from the database tier.</span></span> <span data-ttu-id="46f38-167">Para reducir la superficie de ataque, no hay ningún puerto de administración remota directa abierto.</span><span class="sxs-lookup"><span data-stu-id="46f38-167">To reduce the attack footprint, no direct remote management ports are open.</span></span> <span data-ttu-id="46f38-168">Para más información, consulte [Grupos de seguridad de red de Azure][nsg-docs].</span><span class="sxs-lookup"><span data-stu-id="46f38-168">For more information, see [Azure network security groups][nsg-docs].</span></span>

<span data-ttu-id="46f38-169">Para ver instrucciones sobre la implementación de Payment Card Industry Data Security Standard (PCI DSS 3.2), consulte [infraestructura compatible][pci-dss].</span><span class="sxs-lookup"><span data-stu-id="46f38-169">To view guidance on deploying Payment Card Industry Data Security Standards (PCI DSS 3.2) [compliant infrastructure][pci-dss].</span></span> <span data-ttu-id="46f38-170">Para obtener instrucciones generales sobre el diseño de escenarios seguros, consulte la [documentación de seguridad de Azure][security].</span><span class="sxs-lookup"><span data-stu-id="46f38-170">For general guidance on designing secure scenarios, see the [Azure Security Documentation][security].</span></span>

### <a name="resiliency"></a><span data-ttu-id="46f38-171">Resistencia</span><span class="sxs-lookup"><span data-stu-id="46f38-171">Resiliency</span></span>

<span data-ttu-id="46f38-172">En combinación con el uso de zonas de disponibilidad y conjuntos de escalado de máquinas virtuales, este escenario utiliza una instancia de Azure Application Gateway y un equilibrador de carga.</span><span class="sxs-lookup"><span data-stu-id="46f38-172">In combination with the use of Availability Zones and virtual machine scale sets, this scenario uses Azure Application Gateway and load balancer.</span></span> <span data-ttu-id="46f38-173">Estos dos componentes de redes distribuyen el tráfico a las instancias de máquinas virtuales conectadas e incluyen sondeos de estado que garantizan que el tráfico solo se distribuye a las máquinas virtuales correctas.</span><span class="sxs-lookup"><span data-stu-id="46f38-173">These two networking components distribute traffic to the connected VM instances, and include health probes that ensure traffic is only distributed to healthy VMs.</span></span> <span data-ttu-id="46f38-174">Se configuran dos instancias de Application Gateway en una configuración activa/pasiva, y se usa un equilibrador de carga con redundancia de zona.</span><span class="sxs-lookup"><span data-stu-id="46f38-174">Two Application Gateway instances are configured in an active-passive configuration, and a zone-redundant load balancer is used.</span></span> <span data-ttu-id="46f38-175">Esta configuración hace que los recursos y aplicaciones de red sean resistentes frente a problemas que, de lo contrario, interrumpirían el tráfico y afectarían al acceso de los usuarios finales.</span><span class="sxs-lookup"><span data-stu-id="46f38-175">This configuration makes the networking resources and application resilient to issues that would otherwise disrupt traffic and impact end-user access.</span></span>

<span data-ttu-id="46f38-176">Para obtener instrucciones generales sobre el diseño de escenarios resistentes, consulte [Diseño de aplicaciones resistentes de Azure][resiliency].</span><span class="sxs-lookup"><span data-stu-id="46f38-176">For general guidance on designing resilient scenarios, see [Designing resilient applications for Azure][resiliency].</span></span>

## <a name="deploy-the-scenario"></a><span data-ttu-id="46f38-177">Implementación del escenario</span><span class="sxs-lookup"><span data-stu-id="46f38-177">Deploy the scenario</span></span>

### <a name="prerequisites"></a><span data-ttu-id="46f38-178">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="46f38-178">Prerequisites</span></span>

- <span data-ttu-id="46f38-179">Debe tener una cuenta de Azure.</span><span class="sxs-lookup"><span data-stu-id="46f38-179">You must have an existing Azure account.</span></span> <span data-ttu-id="46f38-180">Si no tiene una suscripción a Azure, cree una [cuenta gratuita](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) antes de empezar.</span><span class="sxs-lookup"><span data-stu-id="46f38-180">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) before you begin.</span></span>

- <span data-ttu-id="46f38-181">Para implementar un clúster de SQL Server en el conjunto de escalado de back-end, necesita un dominio en Azure Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="46f38-181">To deploy a SQL Server cluster into the back-end scale set, you would need a domain in Azure Active Directory (AD) Domain Services.</span></span>

### <a name="deploy-the-components"></a><span data-ttu-id="46f38-182">Implementación de los componentes</span><span class="sxs-lookup"><span data-stu-id="46f38-182">Deploy the components</span></span>

<span data-ttu-id="46f38-183">Para implementar la infraestructura principal de este escenario con una plantilla de Azure Resource Manager, realice los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="46f38-183">To deploy the core infrastructure for this scenario with an Azure Resource Manager template, perform the following steps.</span></span>

<!-- markdownlint-disable MD033 -->

1. <span data-ttu-id="46f38-184">Seleccione el botón **Implementar en Azure**:</span><span class="sxs-lookup"><span data-stu-id="46f38-184">Select the **Deploy to Azure** button:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fsolution-architectures%2Fmaster%2Finfrastructure%2Fregulated-multitier-app%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="46f38-185">Espere a que la implementación de plantilla se abra en Azure Portal y complete los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="46f38-185">Wait for the template deployment to open in the Azure portal, then complete the following steps:</span></span>
   - <span data-ttu-id="46f38-186">Elija **Crear nuevo** para el grupo de recursos y proporcione un nombre como, por ejemplo, *myWindowsscenario*, en el cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="46f38-186">Choose to **Create new** resource group, then provide a name such as *myWindowsscenario* in the text box.</span></span>
   - <span data-ttu-id="46f38-187">Seleccione una región en el cuadro de lista desplegable **Ubicación**.</span><span class="sxs-lookup"><span data-stu-id="46f38-187">Select a region from the **Location** drop-down box.</span></span>
   - <span data-ttu-id="46f38-188">Indique un nombre de usuario y una contraseña segura para las instancias de conjuntos de escalado de máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="46f38-188">Provide a username and secure password for the virtual machine scale set instances.</span></span>
   - <span data-ttu-id="46f38-189">Revise los términos y condiciones, y seleccione **Acepto los términos y condiciones indicados anteriormente**.</span><span class="sxs-lookup"><span data-stu-id="46f38-189">Review the terms and conditions, then check **I agree to the terms and conditions stated above**.</span></span>
   - <span data-ttu-id="46f38-190">Seleccione el botón **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="46f38-190">Select the **Purchase** button.</span></span>

<!-- markdownlint-enable MD033 -->

<span data-ttu-id="46f38-191">La implementación puede tardar unos 15-20 minutos en completarse.</span><span class="sxs-lookup"><span data-stu-id="46f38-191">It can take 15-20 minutes for the deployment to complete.</span></span>

## <a name="pricing"></a><span data-ttu-id="46f38-192">Precios</span><span class="sxs-lookup"><span data-stu-id="46f38-192">Pricing</span></span>

<span data-ttu-id="46f38-193">Para explorar el costo de ejecutar este escenario, todos los servicios están preconfigurados en la calculadora de costos.</span><span class="sxs-lookup"><span data-stu-id="46f38-193">To explore the cost of running this scenario, all of the services are pre-configured in the cost calculator.</span></span> <span data-ttu-id="46f38-194">Para ver cómo cambiarían los precios en su caso concreto, cambie las variables pertinentes para que coincidan con el tráfico esperado.</span><span class="sxs-lookup"><span data-stu-id="46f38-194">To see how the pricing would change for your particular use case, change the appropriate variables to match your expected traffic.</span></span>

<span data-ttu-id="46f38-195">Hemos incluido tres perfiles de costos de ejemplo basados en el número de instancias de conjuntos de escalado de máquinas virtuales que ejecutan las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="46f38-195">We have provided three sample cost profiles based on the number of scale set VM instances that run your applications.</span></span>

- <span data-ttu-id="46f38-196">[Pequeño][small-pricing]: este ejemplo de plan de tarifa corresponde a dos instancias de máquina virtual de front-end y dos de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-196">[Small][small-pricing]: this pricing example correlates to two front-end and two back-end VM instances.</span></span>
- <span data-ttu-id="46f38-197">[Medio][medium-pricing]: este ejemplo de plan de tarifa corresponde a veinte instancias de máquina virtual de front-end y cinco de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-197">[Medium][medium-pricing]: this pricing example correlates to 20 front-end and 5 back-end VM instances.</span></span>
- <span data-ttu-id="46f38-198">[Grande][large-pricing]: este ejemplo de plan de tarifa corresponde a cien instancias de máquina virtual de front-end y diez de back-end.</span><span class="sxs-lookup"><span data-stu-id="46f38-198">[Large][large-pricing]: this pricing example correlates to 100 front-end and 10 back-end VM instances.</span></span>

## <a name="related-resources"></a><span data-ttu-id="46f38-199">Recursos relacionados</span><span class="sxs-lookup"><span data-stu-id="46f38-199">Related resources</span></span>

<span data-ttu-id="46f38-200">Este escenario usa un conjunto de escalado de máquinas virtuales de back-end que ejecuta un clúster de Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="46f38-200">This scenario used a back-end virtual machine scale set that runs a Microsoft SQL Server cluster.</span></span> <span data-ttu-id="46f38-201">También se puede usar Cosmos DB como un nivel de base de datos escalable y seguro para los datos de aplicación.</span><span class="sxs-lookup"><span data-stu-id="46f38-201">Cosmos DB could also be used as a scalable and secure database tier for the application data.</span></span> <span data-ttu-id="46f38-202">Un [punto de conexión de servicio de red virtual de Azure][vnetendpoint-docs] le permite proteger los recursos de los servicios de Azure fundamentales y los limita solo a sus redes virtuales.</span><span class="sxs-lookup"><span data-stu-id="46f38-202">An [Azure virtual network service endpoint][vnetendpoint-docs] allows you to secure your critical Azure service resources to only your virtual networks.</span></span> <span data-ttu-id="46f38-203">En este escenario, los puntos de conexión de red virtual le permiten proteger el tráfico entre la capa de aplicación de front-end y Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="46f38-203">In this scenario, VNet endpoints allow you to secure traffic between the front-end application tier and Cosmos DB.</span></span> <span data-ttu-id="46f38-204">Para más información, consulte [Introducción a Azure Cosmos DB](/azure/cosmos-db/introduction).</span><span class="sxs-lookup"><span data-stu-id="46f38-204">For more information, see the [Azure Cosmos DB overview](/azure/cosmos-db/introduction).</span></span>

<span data-ttu-id="46f38-205">Para obtener guías de implementación más detalladas, revise la [arquitectura de referencia para aplicaciones de N niveles mediante SQL Server][ntiersql-ra].</span><span class="sxs-lookup"><span data-stu-id="46f38-205">For more detailed implementation guides, review the [reference architecture for N-tier applications using SQL Server][ntiersql-ra].</span></span>

<!-- links -->
[appgateway-docs]: /azure/application-gateway/overview
[architecture]: ./media/architecture-regulated-multitier-app.png
[autoscaling]: /azure/architecture/best-practices/auto-scaling
[availability]: ../../checklist/availability.md
[cloudwitness-docs]: /windows-server/failover-clustering/deploy-cloud-witness
[loadbalancer-docs]: /azure/load-balancer/load-balancer-overview
[nsg-docs]: /azure/virtual-network/security-overview
[ntiersql-ra]: /azure/architecture/reference-architectures/n-tier/n-tier-sql-server
[resiliency]: /azure/architecture/resiliency/
[security]: /azure/security/
[scalability]: /azure/architecture/checklist/scalability
[scaleset-docs]: /azure/virtual-machine-scale-sets/overview
[sqlalwayson-docs]: /sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server
[vmssautoscale-docs]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview
[vnet-docs]: /azure/virtual-network/virtual-networks-overview
[vnetendpoint-docs]: /azure/virtual-network/virtual-network-service-endpoints-overview
[pci-dss]: /azure/security/blueprints/pcidss-iaaswa-overview
[dmz]: /azure/virtual-network/virtual-networks-dmz-nsg
[sql-linux]: /sql/linux/sql-server-linux-overview?view=sql-server-linux-2017
[cloud-witness]: /windows-server/failover-clustering/deploy-cloud-witness
[small-pricing]: https://azure.com/e/711bbfcbbc884ef8aa91cdf0f2caff72
[medium-pricing]: https://azure.com/e/b622d82d79b34b8398c4bce35477856f
[large-pricing]: https://azure.com/e/1d99d8b92f90496787abecffa1473a93
